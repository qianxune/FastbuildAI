import{v as B,l as S,s as M,a5 as b,a3 as y,h as q,x as g,o as u,A as r,d as D,M as e,D as l,E as I,Q as v,S as L}from"#entry";import{_ as j}from"./DdWr1-5r.js";import{c as E,a as N,_ as z,b as A}from"./DYdmwcI2.js";import{_ as G}from"./Djep58hR.js";import{_ as Q}from"./C5NBOd-j.js";import{a as T,b as H,c as J}from"./CkFSApSf.js";import"./CqkleIqs.js";import"./zwMu3NXe.js";import"./DKtAdiWa.js";import"./Cci7V6xo.js";import"./TGMj2fgS.js";import"./DvyFBN4o.js";import"./DNsHFHOw.js";import"./C9ze5RlS.js";const K={key:0,class:"flex items-center justify-center",style:{padding:"100px 0"}},O={class:"space-y-4"},P={class:"mt-6 flex justify-end gap-3"},ce=B({__name:"edit",props:{id:{}},emits:["close"],setup(c,{emit:k}){const i=c,m=k,{t:o}=S(),$=E({name:N().required(o("column.edit.form.name.required"))}),t=M({name:"",description:"",sort:0}),{lockFn:h,isLock:U}=b(async()=>{if(i.id)try{const s=await T(i.id);t.value={name:s.name,description:s.description||"",sort:s.sort||0}}catch(s){console.error("获取详情失败:",s)}}),{lockFn:w,isLock:p}=b(async()=>{try{i.id?await H(i.id,t.value):await J(t.value),y().success(i.id?o("column.edit.messages.updateSuccess"):o("column.edit.messages.createSuccess")),m("close",!0)}catch(s){console.error("提交失败:",s),y().error(i.id?o("column.edit.messages.updateFailed"):o("column.edit.messages.createFailed"))}});return q(()=>{h()}),(s,a)=>{const F=I,f=j,d=A,V=G,_=L,x=z,C=Q;return u(),g(C,{title:c.id?e(o)("column.edit.title.edit"):e(o)("column.edit.title.create"),description:c.id?e(o)("column.edit.description.edit"):e(o)("column.edit.description.create"),ui:{content:"w-md"},onClose:a[4]||(a[4]=n=>m("close"))},{default:r(()=>[e(U)?(u(),D("div",K,[l(F,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):(u(),g(x,{key:1,state:e(t),schema:e($),class:"space-y-2",onSubmit:e(w)},{default:r(()=>[v("div",O,[l(d,{label:e(o)("column.edit.form.name.label"),name:"name",required:""},{default:r(()=>[l(f,{modelValue:e(t).name,"onUpdate:modelValue":a[0]||(a[0]=n=>e(t).name=n),placeholder:e(o)("column.edit.form.name.placeholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(d,{label:e(o)("column.edit.form.description.label"),name:"description"},{default:r(()=>[l(V,{"model-value":e(t).description||"","onUpdate:modelValue":a[1]||(a[1]=n=>e(t).description=n||void 0),placeholder:e(o)("column.edit.form.description.placeholder"),rows:3,ui:{root:"w-full"}},null,8,["model-value","placeholder"])]),_:1},8,["label"]),l(d,{label:e(o)("column.edit.form.sort.label"),name:"sort"},{default:r(()=>[l(f,{modelValue:e(t).sort,"onUpdate:modelValue":a[2]||(a[2]=n=>e(t).sort=n),type:"number",placeholder:e(o)("column.edit.form.sort.placeholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),v("div",P,[l(_,{color:"neutral",variant:"outline",label:e(o)("column.edit.buttons.cancel"),onClick:a[3]||(a[3]=n=>m("close"))},null,8,["label"]),l(_,{type:"submit",color:"primary",loading:e(p),label:e(p)?e(o)("column.edit.buttons.saving"):e(o)("column.edit.buttons.save")},null,8,["loading","label"])])]),_:1},8,["state","schema","onSubmit"]))]),_:1},8,["title","description"])}}});export{ce as default};
