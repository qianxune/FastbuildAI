import{S as R,s as B,_ as L}from"./ComoKIaa.js";import{_ as T}from"./BHvPiaia.js";import{_ as D}from"./DdWr1-5r.js";import{c as N,a as f,d as j,_ as A,b as E}from"./DYdmwcI2.js";import{v as H,a3 as O,l as Q,s as y,g as S,a5 as x,aQ as W,aR as Y,d as G,o as J,D as o,A as a,Q as d,R as r,M as m,aB as K,T as c,S as X,E as Z}from"#entry";import{_ as ee}from"./C3PBHawL.js";import{M as V}from"./CPXIjpTD.js";import"./B5nlWy8g.js";import"./j-r9zBVO.js";/* empty css        */import"./DlAUqK2U.js";import"./Dvwp2zQj.js";import"./DAuIF7bR.js";import"./TGMj2fgS.js";import"./Cci7V6xo.js";import"./z2CrSoMD.js";import"./CZmFWyWl.js";import"./BU4xloRu.js";import"./CqkleIqs.js";const oe={class:"px-8 pt-8"},te={class:"mb-2 text-2xl font-bold"},se={class:"text-muted-foreground mb-4 text-sm"},ae={class:"flex items-center gap-1 text-xs"},ie={class:"flex items-center gap-1 text-xs"},le={class:"flex flex-1 gap-2 py-8"},Pe=H({__name:"forget",emits:["switchComponent"],setup(ne,{emit:C}){const P=C,u=O(),{t}=Q(),_=y([{value:t("console-common.phoneAreaCodes.china"),label:"86"}]),w=y(_.value[0]),k=N({mobile:f().required(t("login.forget.validation.mobileRequired")).matches(/^1[3-9]\d{9}$/,t("login.forget.validation.mobileInvalid")),code:f().required(t("login.forget.validation.codeRequired")),password:f().required(t("login.forget.validation.passwordRequired")).min(6,t("login.forget.validation.passwordMinLength")).max(25,t("login.forget.validation.passwordMaxLength")).matches(/^(?=.*[a-z])(?=.*[0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])/,t("login.forget.validation.passwordFormat")),password_confirm:f().required(t("login.forget.validation.confirmPasswordRequired")).oneOf([j("password")],t("login.forget.validation.passwordMismatch"))}),l=S({mobile:"",code:"",password:"",password_confirm:""}),n=S({isCounting:!1,text:t("login.forget.getCode")}),{lockFn:q,isLock:U}=x(async()=>{if(n.isCounting!==!0){n.text=t("login.forget.sending");try{await W({scene:R.FIND_PASSWORD,mobile:l.mobile}),n.isCounting=!0;let e=60;n.text=`${e}s`;const s=B(()=>{e--,n.text=`${e}s`,e===0&&(clearInterval(s),n.isCounting=!1,n.text=t("login.forget.resend"))},1e3);u.success(t("login.forget.messages.sendSuccess"),{title:t("login.forget.messages.sendSuccessTitle"),duration:3e3})}catch(e){console.error("Send verification code failed:",e),n.isCounting=!1,n.text=t("login.forget.resend"),u.error(t("login.forget.messages.sendFailed"),{title:t("login.forget.messages.sendFailedTitle"),duration:3e3})}}}),{lockFn:F,isLock:z}=x(async()=>{try{await Y(l)}catch(e){console.log("Reset password failed =>",e)}});return(e,s)=>{const M=L,b=T,v=D,p=E,g=X,$=ee,h=Z,I=A;return J(),G("div",oe,[o(m(V),{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"tween",stiffness:300,damping:30,delay:.2},class:"relative"},{default:a(()=>[d("h2",te,r(e.$t("login.forget.title")),1),d("p",se,r(e.$t("login.forget.subtitle")),1)]),_:1}),o(m(V),{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"tween",stiffness:300,damping:30,delay:.4},class:"relative"},{default:a(()=>[o(I,{schema:m(k),state:l,onSubmit:m(F)},{default:a(()=>[o(p,{label:e.$t("login.forget.mobile"),name:"mobile",required:""},{default:a(()=>[o(v,{modelValue:l.mobile,"onUpdate:modelValue":s[2]||(s[2]=i=>l.mobile=i),class:"w-full",size:"lg",placeholder:e.$t("login.forget.mobilePlaceholder"),autocomplete:"off",ui:{base:"!pl-24"}},{leading:a(()=>[d("div",{class:"flex items-center text-sm",onClick:s[1]||(s[1]=K(()=>{},["stop","prevent"]))},[s[7]||(s[7]=d("span",{class:"mr-px pb-px"},"+",-1)),o(M,{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=i=>w.value=i),"trailing-icon":"heroicons:chevron-up-down-20-solid",ui:{base:"!ring-0",content:"z-999 w-34"},class:"w-16",items:_.value},{item:a(({item:i})=>[c(r(i.value)+" +"+r(i.label),1)]),_:1},8,["modelValue","items"])]),o(b,{class:"h-1/2",orientation:"vertical"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(p,{label:e.$t("login.forget.code"),name:"code",class:"mt-2",required:""},{default:a(()=>[o(v,{id:"code",modelValue:l.code,"onUpdate:modelValue":s[3]||(s[3]=i=>l.code=i),size:"lg",placeholder:e.$t("login.forget.codePlaceholder"),autocomplete:"off",ui:{root:"w-full",trailing:"pr-0"}},{trailing:a(()=>[o(b,{class:"h-1/2",orientation:"vertical"}),o(g,{variant:"link",ui:{base:"w-[90px] justify-center"},disabled:m(U),onClick:m(q)},{default:a(()=>[c(r(n.text),1)]),_:1},8,["disabled","onClick"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(p,{label:e.$t("login.forget.newPassword"),name:"password",class:"mt-3",required:""},{help:a(()=>[d("div",ae,[o(h,{name:"tabler:alert-circle",size:"14"}),c(" "+r(e.$t("login.forget.passwordHint")),1)])]),default:a(()=>[o($,{modelValue:l.password,"onUpdate:modelValue":s[4]||(s[4]=i=>l.password=i),class:"w-full",type:"password",size:"lg",placeholder:e.$t("login.forget.newPasswordPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(p,{label:e.$t("login.forget.confirmPassword"),name:"password_confirm",class:"mt-3",required:""},{help:a(()=>[d("div",ie,[o(h,{name:"tabler:alert-circle",size:"14"}),c(" "+r(e.$t("login.forget.passwordHint")),1)])]),default:a(()=>[o($,{modelValue:l.password_confirm,"onUpdate:modelValue":s[5]||(s[5]=i=>l.password_confirm=i),class:"w-full",type:"password",size:"lg",placeholder:e.$t("login.forget.confirmPasswordPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d("div",le,[o(g,{variant:"outline",color:"primary",size:"lg",ui:{base:"flex-1 justify-center"},onClick:s[6]||(s[6]=i=>P("switchComponent","account-login"))},{default:a(()=>[c(r(e.$t("login.forget.backToLogin")),1)]),_:1}),o(g,{color:"primary",type:"submit",size:"lg",ui:{base:"flex-1 justify-center"},loading:m(z)},{default:a(()=>[c(r(e.$t("login.forget.confirmChange")),1)]),_:1},8,["loading"])])]),_:1},8,["schema","state","onSubmit"])]),_:1})])}}});export{Pe as default};
