import{d as H,aM as Q,av as G,i as J,k as O,n as v,aQ as W,p as w,K as X,q as Y,c as Z,o as ee,x as r,z as C,g as o,t as m,w as $,_ as te,h as s,B as ae}from"#entry";import{_ as se}from"./o4ws_w_T.js";import{_ as oe}from"./CBTz8tdX.js";import le from"./cd55qm53.js";import{_ as ne}from"./DBiaUVBh.js";import{_ as ce}from"./DbqqhwXM.js";import{_ as ie}from"./B5gsc-Ax.js";import{_ as re}from"./JxyxsHxp.js";import{_ as de}from"./D4ebF709.js";import{k as ue}from"./gu2_Ts15.js";import{u as me}from"./yxr0PByv.js";import{u as pe}from"./BlyoSzaa.js";import{u as fe}from"./ZDOPDbaX.js";import{u as be}from"./B-cZF5FC.js";import{a as ge,f as he}from"./DUoaAyrs.js";import{u as _e}from"./CxvgZo8z.js";import"./DMoqg0Fd.js";import"./CtosDvS0.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./CuVAPZQ8.js";import"./psimjGaX.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./o0-e7Rye.js";import"./abPSHzII.js";import"./CSy6ZCzT.js";import"./BzLCLO6P.js";const ye={class:"flex h-full w-full flex-col px-6"},ke={class:"flex flex-col justify-center gap-1 pt-4"},xe={class:"text-lg! font-bold"},ve={class:"text-muted-foreground text-sm"},we={class:"flex w-full justify-between gap-4 py-6 backdrop-blur-sm"},Ce={class:"flex items-center gap-2 md:ml-auto"},$e={class:"flex h-full flex-col"},Se={class:"table h-full"},ze={class:"flex items-center justify-end gap-3 py-4"},Ae={class:"flex items-center gap-1.5"},ut=H({__name:"index",setup(De){const f=te,b=se,k=oe,S=ae,z=le,A=ne,{params:D}=Q(),h=G(),{t:a}=J(),{hasAccessByCodes:u}=pe(),_=O("table"),{deleteDocument:I,renameDocument:V,retryDocument:U,toggleDocumentEnabled:P}=me(),g=v(()=>D.id),p=W({keyword:"",fileType:"",datasetId:g.value}),c=v(()=>({select:a("console-common.select"),fileName:a("ai-datasets.backend.documents.table.fileName"),fileSize:a("ai-datasets.backend.documents.table.fileSize"),status:a("console-common.status"),process:a("ai-datasets.backend.documents.table.progress"),enabled:a("console-common.status"),characterCount:a("ai-datasets.backend.documents.table.characterCount"),chunkCount:a("ai-datasets.backend.documents.table.chunkCount"),createdAt:a("ai-datasets.backend.documents.table.createdAt"),actions:a("console-common.operation")})),{paging:i,getLists:d}=fe({fetchFun:ue,params:p}),{start:B,clear:K}=be(async e=>{await d(),i.needPolling||e()},{interval:1e3});w(()=>i.needPolling,e=>{e?B():K()},{immediate:!0});const R={processing:{label:a("console-common.processing"),color:"warning"},completed:{label:a("console-common.completed"),color:"success"},failed:{label:a("console-common.failed"),color:"error"},pending:{label:a("console-common.pending"),color:"neutral"},error:{label:a("ai-datasets.backend.documents.error"),color:"error"}},x={pdf:"i-lucide-file-text",doc:"i-lucide-file-text",docx:"i-lucide-file-text",txt:"i-lucide-file-text",md:"i-lucide-file-text",csv:"i-lucide-file-spreadsheet",xlsx:"i-lucide-file-spreadsheet",xls:"i-lucide-file-spreadsheet",default:"i-lucide-file"},N=[{accessorKey:"fileName",header:()=>s("p",{class:"whitespace-nowrap"},`${c.value.fileName}`),cell:({row:e})=>s("div",{class:"flex items-center gap-3"},[s(S,{name:x[e.original.fileType]||x.default,class:"text-primary size-5"}),s("div",{class:"flex-1 grid"},[s("p",{class:"font-medium text-highlighted truncate"},e.original.fileName)])])},{accessorKey:"fileSize",header:()=>s("p",{class:""},`${c.value.fileSize}`),cell:({row:e})=>{const t=e.getValue("fileSize");return s("span",{class:"text-sm"},ge(t))}},{accessorKey:"enabled",header:()=>s("p",{class:""},`${c.value.enabled}`),cell:({row:e})=>{const l=e.getValue("enabled")?{label:a("console-common.enabled"),color:"success"}:{label:a("console-common.disabled"),color:"error"};return s(b,{color:l.color,variant:"subtle"},()=>l.label)}},{accessorKey:"characterCount",header:()=>s("p",{class:"whitespace-nowrap"},`${c.value.characterCount}`),cell:({row:e})=>{const t=e.original.characterCount||0;return s("span",{class:"text-sm text-primary"},`${he(t)}`)}},{accessorKey:"chunkCount",header:()=>s("p",{class:"whitespace-nowrap"},`${c.value.chunkCount}`),cell:({row:e})=>{const t=e.getValue("chunkCount");return s(b,{color:"primary",variant:"subtle"},()=>t.toString())}},{accessorKey:"status",header:()=>s("p",{class:""},`${c.value.status}`),cell:({row:e})=>{const t=e.getValue("status"),l=R[t];return t==="failed"?s(ce,{text:e.original?.error,delayDuration:0},{default:()=>s(b,{color:l.color,variant:"subtle"},()=>l.label)}):s(b,{color:l.color,variant:"subtle"},()=>l.label)}},{accessorKey:"progress",header:()=>s("p",{class:"whitespace-nowrap"},`${c.value.process}`),cell:({row:e})=>{const t=e.original.progress||0;return s("span",{class:"text-sm text-primary"},`${t}%`)}},{accessorKey:"createdAt",header:({column:e})=>{const t=e.getIsSorted();return s(f,{color:"neutral",variant:"ghost",label:c.value.createdAt,icon:t?t==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const t=e.getValue("createdAt");return s(A,{datetime:t,mode:"datetime"})}},{id:"actions",header:()=>s("p",{class:""},`${c.value.actions}`),size:80,enableSorting:!1,enableHiding:!1,cell:({row:e})=>s(k,{items:T(e)},()=>s(f,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"},()=>""))}];function T(e){const t=e.original,l=t.enabled;return[u(["ai-datasets-segments:list"])?{label:a("ai-datasets.backend.documents.viewSegments"),icon:"i-lucide-list",onClick:()=>{u(["ai-datasets-segments:list"])&&h.push({path:`/console/datasets/${g.value}/documents/segments`,query:{documentId:t.id}})}}:null,u(["ai-datasets-documents:rename"])?{label:a("ai-datasets.backend.documents.renameModal.title"),icon:"i-lucide-pen-line",onClick:()=>L(t)}:null,u(["ai-datasets-documents:set-enabled"])?{label:a(l?"ai-datasets.backend.documents.disable.title":"ai-datasets.backend.documents.enable.title"),icon:l?"i-lucide-eye-off":"i-lucide-eye",color:l?"warning":"primary",onClick:()=>P(t.id,!l,d)}:null,u(["ai-datasets-documents:retry"])?{label:a("ai-datasets.backend.documents.retry.title"),icon:"i-lucide-rotate-ccw",color:"warning",onClick:()=>U(t.id,d)}:null,u(["ai-datasets-documents:delete"])?{label:a("console-common.delete"),icon:"i-lucide-trash",color:"error",onSelect:()=>F(t.id)}:null].filter(Boolean)}w(()=>[p.keyword,p.fileType],()=>{X(()=>{i.page=1,d()},300)()},{deep:!0});const F=async e=>{await I(e,d)},M=()=>{h.push(_e("ai-datasets-documents:create",{id:g.value}))},L=async e=>{await V(e,d)},j=e=>{u(["ai-datasets-segments:list"])&&h.push({path:`/console/datasets/${g.value}/documents/segments`,query:{documentId:e.original.id}})};return Y(()=>d()),(e,t)=>{const l=ie,q=re,E=de;return ee(),Z("div",ye,[r("div",ke,[r("h1",xe,C(o(a)("ai-datasets.backend.documents.title")),1),r("p",ve,C(o(a)("ai-datasets.backend.documents.description")),1)]),r("div",we,[m(o(z),{modelValue:o(p).keyword,"onUpdate:modelValue":t[0]||(t[0]=n=>o(p).keyword=n),placeholder:o(a)("ai-datasets.backend.documents.searchPlaceholder"),class:"w-80",icon:"i-lucide-search"},null,8,["modelValue","placeholder"]),r("div",Ce,[m(o(k),{items:o(_)?.tableApi?.getAllColumns().filter(n=>n.getCanHide()).map(n=>({label:o(c)[n.id]||n.columnDef.header,type:"checkbox",checked:n.getIsVisible(),onUpdateChecked(y){o(_)?.tableApi?.getColumn(n.id)?.toggleVisibility(!!y)},onSelect(y){y?.preventDefault()}})),content:{align:"end"}},{default:$(()=>[m(o(f),{label:o(a)("console-common.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),m(l,{codes:["ai-datasets-documents:create"]},{default:$(()=>[m(o(f),{label:o(a)("ai-datasets.backend.documents.addFile"),"leading-icon":"i-lucide-plus",color:"primary",onClick:M},null,8,["label"])]),_:1})])]),r("div",$e,[r("div",Se,[m(q,{loading:o(i).loading,data:o(i).items,columns:N,class:"h-full shrink-0",ref_key:"table",ref:_,selectable:"",sticky:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default ",tr:"hover:bg-elevated/50"},onSelect:j},null,8,["loading","data"])])]),r("div",ze,[r("div",Ae,[m(E,{page:o(i).page,"onUpdate:page":t[1]||(t[1]=n=>o(i).page=n),size:o(i).pageSize,"onUpdate:size":t[2]||(t[2]=n=>o(i).pageSize=n),total:o(i).total,onChange:o(d)},null,8,["page","size","total","onChange"])])])])}}});export{ut as default};
