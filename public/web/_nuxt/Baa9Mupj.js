const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Dn4Tg13V.js","./Cgyg1gJC.js","./cd55qm53.js","./D_3bTjYR.js","./D9sX2Qi6.js","./CvI6s-qz.js","./CtosDvS0.js","./CAQVAH0V.js","./DNSLGqNg.js","./BFo3vNrE.js","./DeCyaT7k.js","./D4e4FYoF.js","./Z7qkLoXK.js","./BstbYvQo.js","./CuVAPZQ8.js","./BJMEQrfh.js","./DbqqhwXM.js","./psimjGaX.js","./B3rWqoNg.js","./EK7Wbu3-.js","./hsuWSsy6.js","./DMoqg0Fd.js","./kRIii9yh.js","./C6Y-ieo6.js","./BCcN9pii.js","./CMKSl-Ng.js","./C_x_FjTj.js","./Dh3Mo9T6.js","./sTbVUDyT.js","./Deu6qIfg.js","./BdGWwroR.js","./bvMLy1sv.js","./DD8ySyt7.js","./Ghlq83yM.js","./DQMjdCEn.js","./OUYfsp1i.js","./CjE5iPSn.js","./D9UsdH-b.js","./MCK2d4XT.js","./1cdiaPir.js","./FTderXKt.js","./DaWZu8wl.js","./UqhBTNL6.js"])))=>i.map(i=>d[i]);
import{d as N,at as F,i as O,aM as G,av as W,V as X,k as j,s as $,n as _,aN as J,p as Q,q as Y,c as Z,o as ee,x as V,t as d,w as u,A as I,z as D,g as l,_ as oe,h as s,B as te,W as se,X as ae,aL as le}from"#entry";import{_ as ne}from"./Y67jy4iF.js";import{_ as re}from"./CBTz8tdX.js";import{_ as ce}from"./o4ws_w_T.js";import{_ as ie}from"./DBiaUVBh.js";import{_ as de}from"./B3rWqoNg.js";import{_ as me}from"./B5gsc-Ax.js";import{_ as ue}from"./JxyxsHxp.js";import{a as pe,b as ge,c as fe}from"./1cdiaPir.js";import{u as he}from"./BlyoSzaa.js";import{u as be}from"./CSy6ZCzT.js";import"./CjasYwqF.js";import"./CAQVAH0V.js";import"./DBEJUH-Z.js";import"./CuVAPZQ8.js";import"./CMKSl-Ng.js";import"./BCcN9pii.js";import"./CtosDvS0.js";import"./Deu6qIfg.js";import"./D9sX2Qi6.js";import"./DMoqg0Fd.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./psimjGaX.js";import"./EK7Wbu3-.js";const ye={class:"menu-list-container pb-5"},_e={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},ve={class:"flex items-end gap-2 md:ml-auto"},Ye=N({__name:"list",setup(xe){const E=se(()=>ae(()=>import("./Dn4Tg13V.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42]),import.meta.url)),v=ne,c=oe,x=re,w=te,C=ce,P=ie,S=F(),{t}=O(),g=G(),U=W(),{hasAccessByCodes:f}=he(),B=X(),i=j("table"),A=$([]),H=$({}),k=_(()=>i.value?.tableApi&&i.value.tableApi.getSelectedRowModel()?.flatRows?.length||0),K=()=>i.value?.tableApi?i.value.tableApi.getSelectedRowModel()?.flatRows?.map(o=>o.original.id)||[]:[],h=_({get(){return Number(g.query.sourceType)||1},set(e){U.replace({path:g.path,query:{...g.query,sourceType:e}})}}),n=_(()=>({select:t("console-common.select"),name:t("system-perms.menu.name"),path:t("system-perms.menu.path"),icon:t("system-perms.menu.icon"),type:t("system-perms.menu.type"),sort:t("console-common.sort"),permissionCode:t("system-perms.menu.permissionCode"),isHidden:t("system-perms.menu.hidden"),createdAt:t("console-common.createAt"),actions:t("console-common.operation")})),z=[{id:"expander",header:({table:e})=>s(c,{variant:"ghost",color:"neutral",icon:e.getExpandedDepth()?"i-lucide-minus-square":"i-lucide-plus-square",size:"xs",onClick:o=>{o.stopPropagation(),e.toggleAllRowsExpanded(!e.getExpandedDepth())}}),enableHiding:!1,cell:({row:e})=>e.getCanExpand()?s(c,{variant:"ghost",color:"neutral",icon:e.getIsExpanded()?"i-lucide-minus":"i-lucide-plus",size:"xs",onClick:o=>{o.stopPropagation(),e.toggleExpanded()}}):null},{id:"select",header:({table:e})=>s(v,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":o=>{e.toggleAllPageRowsSelected(!!o)},ariaLabel:"Select all"}),cell:({row:e})=>s(v,{modelValue:e.getIsSelected(),"onUpdate:modelValue":o=>{e.toggleSelected(!!o)},ariaLabel:"Select row"})},{accessorKey:"name",header:()=>s("p",{class:""},`${n.value.name}`),cell:({row:e})=>{const o=e.depth,r=[];return o>0&&r.push(s("div",{style:{width:`${o*16}px`},class:"flex-none"}),s(w,{name:"i-lucide-corner-down-right",class:"text-gray-400 flex-none mr-1"})),e.original.icon&&r.push(s(w,{name:`${e.original.icon}`,class:"text-primary size-5 flex-none mr-2"})),r.push(s("span",{class:"truncate"},t(e.original.name))),s("div",{class:"flex items-center"},r)}},{accessorKey:"path",header:()=>s("p",{class:""},`${n.value.path}`),cell:({row:e})=>{const o=e.getValue("path");return s("div",{class:"max-w-xs truncate"},o||"-")}},{accessorKey:"type",header:()=>s("p",{class:""},`${n.value.type}`),cell:({row:e})=>{const o=e.getValue("type"),m={0:{label:t("console-common.menuType.group"),color:"neutral"},1:{label:t("console-common.menuType.catalogue"),color:"warning"},2:{label:t("console-common.menuType.menu"),color:"info"},3:{label:t("console-common.menuType.button"),color:"neutral"}}[o]||{label:"-",color:"neutral"};return s(C,{color:m.color,variant:"subtle",class:"capitalize"},()=>m.label)}},{accessorKey:"isHidden",header:()=>s("p",{class:""},`${n.value.isHidden}`),cell:({row:e})=>{const o=e.getValue("isHidden");return s(C,{color:o?"error":"success",variant:"subtle"},()=>t(o?"system-perms.menu.no":"system-perms.menu.yes"))}},{accessorKey:"permissionCode",header:()=>s("p",{class:""},`${n.value.permissionCode}`),cell:({row:e})=>{const o=e.getValue("permissionCode");return s("div",{class:"max-w-xs truncate"},o||"-")}},{accessorKey:"sort",header:()=>s("p",{class:""},`${n.value.sort}`),cell:({row:e})=>{const o=e.getValue("sort");return s("div",{},o||"0")}},{accessorKey:"createdAt",header:({column:e})=>{const o=e.getIsSorted();return s(c,{color:"neutral",variant:"ghost",label:n.value.createdAt,icon:o?o==="asc"?"i-lucide-arrow-up-narrow-wide":"i-lucide-arrow-down-wide-narrow":"i-lucide-arrow-up-down",class:"-mx-2.5",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc")})},cell:({row:e})=>{const o=e.getValue("createdAt");return s(P,{datetime:o,mode:"datetime"})}},{id:"actions",header:()=>s("p",{class:""},`${n.value.actions}`),size:80,enableSorting:!1,enableHiding:!1,cell:({row:e})=>s(x,{items:L(e)},()=>s(c,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"},()=>""))}];function L(e){return[f(["menu:add"])?{label:t("console-common.add"),icon:"i-lucide-plus-circle",color:"success",onClick:()=>{b(null,e.original.id)}}:null,f(["menu:edit"])?{label:t("console-common.edit"),icon:"i-lucide-pen-line",onClick:()=>{b(e.original.id||"",null)}}:null,f(["menu:delete"])?{label:t("console-common.delete"),icon:"i-lucide-trash",color:"error",onSelect(){R(e.original.id)}}:null].filter(Boolean)}const{lockFn:p,isLock:q}=J(async()=>{try{A.value=await fe(h.value)}catch(e){console.log("get menu-tree api error --->",e)}}),M=()=>{le().loadPermissions()},b=async(e,o)=>{await B.create(E).open({id:e??null,parentId:o??null,sourceType:h.value||1}).result&&(p(),M())},R=async e=>{try{await be({title:t("system-perms.menu.deleteTitle"),description:t("system-perms.menu.deleteMsg"),color:"error",confirmText:t("console-common.delete"),cancelText:t("console-common.cancel")});let o;Array.isArray(e)?o=await pe({ids:e}):o=await ge(e),o.success?(p(),S.success(t("system-perms.menu.success"))):S.error(o.message),M()}catch(o){console.error("删除失败:",o)}};return Q(()=>h.value,()=>{p()}),Y(()=>p()),(e,o)=>{const r=de,m=me,T=ue;return ee(),Z("div",ye,[V("div",_e,[V("div",ve,[d(l(c),{color:"error",variant:"subtle",label:l(t)("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:!k.value,onClick:o[0]||(o[0]=()=>{const a=K();a&&a.length>0&&R(a)})},{trailing:u(()=>[d(r,null,{default:u(()=>[I(D(k.value),1)]),_:1})]),_:1},8,["label","disabled"]),d(l(x),{items:l(i)?.tableApi?.getAllColumns().filter(a=>a.getCanHide()).map(a=>({label:n.value[a?.id]||a.columnDef.header,type:"checkbox",checked:a.getIsVisible(),onUpdateChecked(y){l(i)?.tableApi?.getColumn(a.id)?.toggleVisibility(!!y)},onSelect(y){y?.preventDefault()}})),content:{align:"end"}},{default:u(()=>[d(l(c),{label:l(t)("console-common.showColumns"),color:"neutral",variant:"outline","trailing-icon":"i-lucide-chevron-down"},null,8,["label"])]),_:1},8,["items"]),d(m,{codes:["menu:add"]},{default:u(()=>[d(l(c),{icon:"i-heroicons-plus",color:"primary",onClick:o[1]||(o[1]=()=>b(null,null))},{default:u(()=>[I(D(l(t)("system-perms.menu.add")),1)]),_:1})]),_:1})])]),d(T,{loading:l(q),data:l(A),columns:z,class:"shrink-0",ref_key:"table",ref:i,selectable:"",expanded:l(H),getSubRows:a=>a.children,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default",tr:"[&:has(>td[colspan])]:hidden"}},null,8,["loading","data","expanded","getSubRows"])])}}});export{Ye as default};
