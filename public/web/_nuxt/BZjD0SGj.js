import R from"./cd55qm53.js";import{_ as A}from"./D_3bTjYR.js";import{_ as S}from"./Da83zglB.js";import E from"./4jjeIyfe.js";import{d as G,i as M,n as T,l as H,p as O,aN as J,c as U,o as _,t as o,w as t,x as c,g as e,z as f,_ as K,A as k,F as Q,E as W,f as X,v as Y,B as Z}from"#entry";import{_ as ee}from"./DD8ySyt7.js";import{_ as le}from"./B5gsc-Ax.js";import{c as B,b as g,e as oe}from"./FTderXKt.js";import"./D9sX2Qi6.js";import"./9Q2Y_nd6.js";import"./td2xDKru.js";import"./RPflLnqr.js";import"./TrJvDfxI.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./DaWZu8wl.js";const se={class:"flex-1"},te={class:"text-xs"},ae={class:"space-y-4"},ne={class:"flex items-center justify-between"},ie={class:"text-lg font-semibold"},me={class:"space-y-4"},re={class:"group relative size-full"},ce=["src","alt"],de=["onClick"],pe={class:"bg-background sticky bottom-0 flex gap-3 py-4"},Pe=G({__name:"level-form",props:{id:{},initialData:{}},emits:["submit-success"],setup($,{emit:z}){const{t:s}=M(),w=$,q=z,V=T(()=>!!w.id),x={name:"",level:void 0,icon:"",givePower:void 0,description:"",benefits:[]},l=H({...x});O(()=>w.initialData,i=>{i&&Object.keys(i).length>0&&(l.value={...x,...i})},{immediate:!0,deep:!0});const P=()=>{l.value.benefits||(l.value.benefits=[]),l.value.benefits=[...l.value.benefits,{icon:"",content:""}]},C=i=>{l.value.benefits=l.value.benefits?.filter((a,r)=>r!==i)},F=B({name:g().required(s("membership.console-membership.level.form.nameRequired")),level:oe().required(s("membership.console-membership.level.form.levelRequired")),icon:g().required(s("membership.console-membership.level.form.iconRequired"))}),j=B({content:g().required(s("membership.console-membership.level.form.benefit.contentRequired"))}),b=(i,a,r)=>{if(!l.value.benefits)return;const m=[...l.value.benefits],u=Array.isArray(r)?r[0]||"":r;m[i]={icon:m[i]?.icon||"",content:m[i]?.content||"",[a]:u},l.value.benefits=m},{lockFn:N,isLock:D}=J(async()=>{try{q("submit-success",l.value)}catch(i){console.error("Update level failed:",i)}});return(i,a)=>{const r=R,m=A,u=S,I=E,h=K,v=Z,y=ee,L=le;return _(),U("div",se,[o(y,{state:e(l),schema:e(F),class:"flex h-full flex-col space-y-4 sm:w-sm",onSubmit:e(N)},{default:t(()=>[o(m,{label:e(s)("membership.console-membership.level.form.labelName"),name:"name",required:""},{default:t(()=>[o(r,{class:"w-full",modelValue:e(l).name,"onUpdate:modelValue":a[0]||(a[0]=n=>e(l).name=n),placeholder:e(s)("membership.console-membership.level.form.labelNamePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(m,{label:e(s)("membership.console-membership.level.form.labelLevel"),name:"level",required:""},{hint:t(()=>[c("div",te,f(e(s)("membership.console-membership.level.form.levelHint")),1)]),default:t(()=>[o(r,{class:"w-full",type:"number",min:1,modelValue:e(l).level,"onUpdate:modelValue":a[1]||(a[1]=n=>e(l).level=n),placeholder:e(s)("membership.console-membership.level.form.labelLevelPlaceholder")},{trailing:t(()=>[...a[5]||(a[5]=[c("span",{class:"text-muted-foreground text-sm"}," çº§ ",-1)])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(m,{label:e(s)("membership.console-membership.level.form.labelIcon"),name:"icon",required:""},{default:t(()=>[o(u,{modelValue:e(l).icon,"onUpdate:modelValue":a[2]||(a[2]=n=>e(l).icon=n),class:"h-24 w-24",text:e(s)("membership.console-membership.level.form.uploadIcon"),icon:"i-lucide-upload",accept:".jpg,.png,.ico",maxCount:1,single:!0},null,8,["modelValue","text"])]),_:1},8,["label"]),o(m,{label:e(s)("membership.console-membership.level.form.labelGivePower"),name:"givePower"},{default:t(()=>[o(r,{class:"w-full",type:"number",modelValue:e(l).givePower,"onUpdate:modelValue":a[3]||(a[3]=n=>e(l).givePower=n),placeholder:e(s)("membership.console-membership.level.form.labelGivePowerPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(m,{label:e(s)("membership.console-membership.level.form.labelDescription"),name:"description"},{default:t(()=>[o(I,{class:"w-full",modelValue:e(l).description,"onUpdate:modelValue":a[4]||(a[4]=n=>e(l).description=n),autoresize:"",maxrows:10,placeholder:e(s)("membership.console-membership.level.form.labelDescriptionPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),c("div",ae,[c("div",ne,[c("h3",ie,f(e(s)("membership.console-membership.level.form.labelBenefits")),1),o(h,{icon:"i-lucide-plus",variant:"soft",color:"primary",size:"sm",onClick:P},{default:t(()=>[k(f(e(s)("console-common.add")),1)]),_:1})])]),c("div",me,[(_(!0),U(Q,null,W(e(l).benefits,(n,p)=>(_(),X(y,{key:p,state:n,schema:e(j),attach:"",class:"flex items-start gap-3"},{default:t(()=>[o(m,{name:"icon"},{default:t(()=>[o(u,{"model-value":n.icon,"onUpdate:modelValue":d=>b(p,"icon",d),class:"h-8 w-8",text:e(s)("membership.console-membership.level.form.benefit.icon"),icon:" ",accept:".jpg,.png,.ico",maxCount:1,single:!0,showPreviewButton:!1,showRemoveButton:!1},{trailing:t(()=>[o(v,{name:"i-lucide-upload",class:"size-5 cursor-pointer"})]),"file-item":t(({item:d})=>[c("div",re,[c("img",{src:d.url,alt:d.name,class:"size-full rounded object-cover"},null,8,ce),c("div",{class:"absolute -top-1 -right-1 z-10 flex size-4 cursor-pointer items-center justify-center rounded-full bg-red-500 text-white opacity-0 shadow-sm transition-opacity group-hover:opacity-100 hover:bg-red-600",onClick:Y(ue=>b(p,"icon",""),["stop"])},[o(v,{name:"i-lucide-x",class:"size-3"})],8,de)])]),_:2},1032,["model-value","onUpdate:modelValue","text"])]),_:2},1024),o(m,{name:"content",class:"w-full"},{default:t(()=>[o(r,{"model-value":n.content,"onUpdate:modelValue":d=>b(p,"content",d),placeholder:e(s)("membership.console-membership.level.form.benefit.content"),class:"w-full"},null,8,["model-value","onUpdate:modelValue","placeholder"])]),_:2},1024),o(h,{variant:"soft",color:"error",size:"sm",class:"mt-1",onClick:d=>C(p)},{default:t(()=>[o(v,{name:"i-lucide-trash-2",class:"size-4"})]),_:1},8,["onClick"])]),_:2},1032,["state","schema"]))),128))]),c("div",pe,[o(L,{codes:e(V)?["levels:update"]:["levels:create"]},{default:t(()=>[o(h,{color:"primary",size:"lg",type:"submit",loading:e(D)},{default:t(()=>[k(f(e(V)?e(s)("console-common.save"):e(s)("console-common.create")),1)]),_:1},8,["loading"])]),_:1},8,["codes"])])]),_:1},8,["state","schema","onSubmit"])])}}});export{Pe as default};
