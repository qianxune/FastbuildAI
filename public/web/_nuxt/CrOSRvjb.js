const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CkI909kw.js","./cd55qm53.js","./Cgyg1gJC.js","./o4ws_w_T.js","./Ghlq83yM.js","./DQMjdCEn.js","./OUYfsp1i.js","./BFo3vNrE.js","./CuVAPZQ8.js","./Z7qkLoXK.js","./CjE5iPSn.js","./D9UsdH-b.js","./MCK2d4XT.js","./EK7Wbu3-.js","./BZx839BO.js","./CSy6ZCzT.js","./BI5Rhz_4.js","./DBiaUVBh.js","./cdILXO3J.js","./shdu-Ndv.js","./hsuWSsy6.js","./DMoqg0Fd.js","./CtosDvS0.js","./kRIii9yh.js","./DNSLGqNg.js","./C6Y-ieo6.js","./DeCyaT7k.js","./D4e4FYoF.js","./BCcN9pii.js","./CMKSl-Ng.js","./psimjGaX.js","./CxvgZo8z.js","./DXmBW8QK.js","./bvMLy1sv.js","./D9sX2Qi6.js","./CAQVAH0V.js","./Deu6qIfg.js","./D_3bTjYR.js","./4jjeIyfe.js","./Ckxdm3-q.js","./Da83zglB.js","./9Q2Y_nd6.js","./td2xDKru.js","./RPflLnqr.js","./TrJvDfxI.js","./jsPNKUA0.js","./abPSHzII.js","./Dm8J87dm.js","./UqhBTNL6.js","./CgjhSYRH.js","./DD8ySyt7.js","./FTderXKt.js","./DaWZu8wl.js","./D3xOnsIE.js","./mTXQFtMl.js","./DXt_wpdg.js","./D0phi001.js","./DO9M7gn1.js","./DBEJUH-Z.js","./CRu9at2N.js"])))=>i.map(i=>d[i]);
import{d as H,V as J,s as V,p as W,aW as oe,f as E,o as u,w as S,r as le,t as s,_ as K,c as w,y as M,B as Q,g as a,z as $,x as n,D as q,F as Y,E as Z,A as se,W as C,X as D,at as ne,i as ie,a2 as re,q as ce,v as N}from"#entry";import ee from"./cd55qm53.js";import{_ as de}from"./shdu-Ndv.js";import{_ as ue}from"./hsuWSsy6.js";import{a as me}from"./BZx839BO.js";import{_ as pe}from"./CvI6s-qz.js";import{_ as ge}from"./B8dIIAdq.js";import{_ as fe}from"./Cie-o9Wa.js";import{w as X,x as he,y as ve,z as _e,A as be}from"./Dm8J87dm.js";import{u as ye}from"./CSy6ZCzT.js";import"./DMoqg0Fd.js";import"./CtosDvS0.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./CuVAPZQ8.js";import"./psimjGaX.js";import"./CAQVAH0V.js";import"./BstbYvQo.js";import"./jsPNKUA0.js";import"./abPSHzII.js";const ke={key:0,class:"text-sm"},we={key:1,class:"text-dimmed flex-none text-sm"},$e={class:"flex flex-col gap-2 p-2"},Ve={key:0,class:"flex flex-col gap-1"},Te={key:1,class:"flex h-30 flex-col items-center justify-center gap-2"},xe={class:"text-muted text-sm"},Ae=H({__name:"tag-select",props:{modelValue:{default:()=>[]},type:{default:"app"}},emits:["update:modelValue","change","close"],setup(G,{emit:L}){const P=C(()=>D(()=>import("./CkI909kw.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]),import.meta.url)),T=L,U=G,p=oe(U,"modelValue",T),z=J(),g=V([]),i=V([]),t=V(""),r=V(!1),v=async()=>{const o=await me({type:U.type});g.value=o,R()},x=o=>{i.value.includes(o)?i.value=i.value.filter(m=>m.id!==o.id):i.value.push(o),p.value=i.value.map(m=>m.id),T("change",o)},c=async()=>{await z.create(P).open({type:U.type}).result,await v()},R=()=>{if(!g.value?.length){i.value=[];return}i.value=g.value.filter(o=>p.value?.includes(o.id))},B=()=>{p.value=[],i.value=[],T("change",[])};return W(()=>p.value,()=>{R()},{deep:!1}),W(r,o=>{o?v():T("close")}),(o,m)=>{const A=Q,I=K,O=ee,j=de,F=ue;return u(),E(F,{open:a(r),"onUpdate:open":m[1]||(m[1]=f=>q(r)?r.value=f:null),content:{align:"center",side:"bottom",sideOffset:8}},{content:S(()=>[n("div",$e,[s(O,{modelValue:a(t),"onUpdate:modelValue":m[0]||(m[0]=f=>q(t)?t.value=f:null),placeholder:o.$t("common.search"),clearable:"",icon:"i-lucide-search",variant:"soft",color:"neutral",ui:{root:"w-full",base:"w-full",trailing:"pr-1"}},null,8,["modelValue","placeholder"]),n("div",null,[a(g).length>0?(u(),w("div",Ve,[(u(!0),w(Y,null,Z(a(g),f=>(u(),E(I,{key:f.id,color:"neutral",variant:"ghost",ui:{base:"justify-between"},onClick:e=>x(f)},{default:S(()=>[se($(f.name)+" ",1),a(p).includes(f.id)?(u(),E(A,{key:0,name:"i-lucide-check",class:"size-4"})):M("",!0)]),_:2},1032,["onClick"]))),128))])):M("",!0),a(g).length===0?(u(),w("div",Te,[s(A,{name:"i-lucide-tags",class:"size-5"}),n("span",xe,$(o.$t("common.tag.noTags")),1)])):M("",!0)]),s(j,{type:"dashed"}),n("div",null,[s(I,{label:o.$t("common.tag.manageTags"),color:"neutral",variant:"ghost",icon:"i-lucide-tags",ui:{base:"w-full"},onClick:c},null,8,["label"])])])]),default:S(()=>[le(o.$slots,"trigger",{},()=>[s(I,{color:"neutral",variant:"outline",ui:{base:"gap-2"}},{default:S(()=>[s(A,{name:"i-lucide-tag",class:"size-4"}),a(p).length>0?(u(),w("span",ke,$(a(p).length)+$(o.$t("common.tag.tags")),1)):(u(),w("span",we,$(o.$t("common.tag.allTags")),1)),a(p).length>0?(u(),E(I,{key:2,color:"neutral",variant:"soft",icon:"i-lucide-x",size:"xs",onClick:B})):M("",!0),s(A,{name:"i-lucide-chevron-down",class:"text-dimmed size-4 shrink-0"})]),_:1})])]),_:3},8,["open"])}}}),Ie={class:"flex w-full flex-col items-center justify-center"},Ce={class:"bg-background sticky top-0 z-10 flex w-full flex-wrap justify-between gap-4 pb-2"},De={class:"flex items-center gap-4"},Se={class:"grid grid-cols-1 gap-6 pt-2 pb-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},Ue={class:"group-hover:text-primary text-foreground mb-3 flex items-center gap-3"},Ee={class:"border-default flex size-10 flex-none items-center justify-center rounded-lg border border-dashed"},ze={class:"truncate text-sm font-medium"},Re={class:"text-muted-foreground mb-6 pr-8 text-xs"},Me={class:"line-clamp-2 overflow-hidden"},Le={class:"flex items-center gap-2"},ut=H({__name:"list",setup(G){const L=C(()=>D(()=>import("./BI5Rhz_4.js"),__vite__mapDeps([16,2,3,17,18,1,19,20,21,22,23,24,9,25,7,26,27,28,29,8,30,14,31]),import.meta.url)),P=C(()=>D(()=>import("./DXmBW8QK.js"),__vite__mapDeps([32,33,2,34,35,36,37,1,38,39,4,5,6,7,8,9,10,11,12,13,40,41,42,43,44,45,46,47,48]),import.meta.url)),T=C(()=>D(()=>import("./CgjhSYRH.js"),__vite__mapDeps([49,2,37,34,40,1,41,42,43,44,45,46,38,50,4,5,6,7,8,9,10,11,12,13,47,51,52,31]),import.meta.url)),U=C(()=>D(()=>import("./D3xOnsIE.js"),__vite__mapDeps([53,2,1,3,54,11,6,7,8,9,55,47,46]),import.meta.url)),p=C(()=>D(()=>import("./D0phi001.js"),__vite__mapDeps([56,57,2,22,8,28,29,58,3,40,1,41,42,43,44,45,46,37,34,4,5,6,7,9,10,11,12,13,47,59]),import.meta.url)),z=ne(),{t:g}=ie(),i=J(),t=re({keyword:"",page:1,pageSize:15,tagIds:[],isPublic:void 0,createMode:void 0}),r=V(!1),v=V(!0),x=V([]),c=async()=>{if(!r.value){r.value=!0,t.page=1;try{const e=await X(t);x.value=e.items||[],v.value=e.totalPages>t.page}catch(e){console.error("获取数据失败:",e),v.value=!1}finally{r.value=!1}}},R=async()=>{if(!(r.value||!v.value)){r.value=!0,t.page!==void 0&&t.page++;try{const e=await X(t);e.items&&e.items.length>0?(x.value.push(...e.items),v.value=e.totalPages>(t.page||0)):v.value=!1}catch(e){t.page!==void 0&&t.page--,console.error("加载更多数据失败:",e)}finally{r.value=!1}}},B=async e=>{try{await ye({title:g("console-common.delete"),description:g("ai-agent.backend.desc.delete"),color:"error"}),await he(e.id);const l=t.page;t.page=1,t.pageSize=x.value.length,await c(),t.page=l,t.pageSize=15,z.success(g("common.message.deleteSuccess"))}catch(l){console.error("删除失败:",l)}},o=async(e=null)=>{await i.create(T).open({id:e}).result&&(t.page=1,t.pageSize=15,await c())},m=async()=>{const e=i.create(U);await e.open().result&&(t.page=1,t.pageSize=15,await c()),e.open()},A=e=>{o(e.id)},I=()=>{o(null)},O=async e=>{try{const l=await ve(e.id,"yaml"),_=new Blob([l],{type:"text/yaml;charset=utf-8"}),b=URL.createObjectURL(_),d=document.createElement("a");d.href=b,d.download=`${e.name||"agent"}.yaml`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(b),z.success("DSL 文件导出成功！")}catch(l){console.error("导出 DSL 失败:",l)}},j=async()=>{await i.create(p).open().result&&(t.page=1,t.pageSize=15,await c())},F=async(e,l)=>{const _=e.tags?.map(k=>k.id)??[],b=l,d=b.filter(k=>!_.includes(k)),y=_.filter(k=>!b.includes(k));d.length===0&&y.length===0||(d.length>0&&await _e(e.id,d),y.length>0&&await be(e.id,y),await c())},f=async()=>{i.create(P).open()};return ce(()=>c()),(e,l)=>{const _=ee,b=Ae,d=pe,y=K,k=Q,te=ge,ae=fe;return u(),w("div",Ie,[n("div",Ce,[n("div",De,[s(_,{modelValue:a(t).keyword,"onUpdate:modelValue":l[0]||(l[0]=h=>a(t).keyword=h),placeholder:e.$t("ai-agent.backend.search.placeholder"),class:"w-80",onChange:c},null,8,["modelValue","placeholder"]),s(b,{modelValue:a(t).tagIds,"onUpdate:modelValue":l[1]||(l[1]=h=>a(t).tagIds=h),onChange:c},null,8,["modelValue"]),s(d,{modelValue:a(t).isPublic,"onUpdate:modelValue":l[2]||(l[2]=h=>a(t).isPublic=h),items:[{label:e.$t("ai-agent.backend.search.allStatus"),value:void 0},{label:e.$t("ai-agent.backend.configuration.public"),value:!0},{label:e.$t("ai-agent.backend.configuration.private"),value:!1}],placeholder:e.$t("ai-agent.backend.search.filterByStatus"),"label-key":"label","value-key":"value",class:"w-38",onChange:c},null,8,["modelValue","items","placeholder"]),s(d,{modelValue:a(t).createMode,"onUpdate:modelValue":l[3]||(l[3]=h=>a(t).createMode=h),items:[{label:e.$t("ai-agent.backend.search.allMode"),value:void 0},{label:e.$t("ai-agent.backend.create.modes.direct"),value:"direct"},{label:e.$t("ai-agent.backend.create.modes.coze"),value:"coze"},{label:e.$t("ai-agent.backend.create.modes.dify"),value:"dify"}],placeholder:e.$t("ai-agent.backend.search.filterByMode"),"label-key":"label","value-key":"value",class:"w-38",onChange:c},null,8,["modelValue","items","placeholder"])]),n("div",null,[s(y,{color:"primary",variant:"ghost",icon:"i-lucide-package",label:e.$t("decorate.openDecorateSettings"),onClick:N(f,["stop"])},null,8,["label"])])]),s(ae,{class:"h-[calc(100vh-9rem)] min-h-0 w-full"},{default:S(()=>[s(te,{loading:a(r),"has-more":a(v),threshold:200,"loading-text":e.$t("common.loading"),"no-more-text":a(t).page!==1?e.$t("common.noMoreData"):" ",onLoadMore:R},{default:S(()=>[n("div",Se,[n("div",{class:"group border-default relative cursor-pointer rounded-lg border border-dashed p-4 transition-all duration-200 hover:shadow-lg",onClick:I},[n("div",Ue,[n("div",Ee,[s(k,{name:"i-lucide-plus",class:"h-6 w-6"})]),n("h3",ze,$(e.$t("ai-agent.backend.create.title")),1)]),n("div",Re,[n("p",Me,$(e.$t("ai-agent.backend.create.desc")),1)]),n("div",Le,[s(y,{color:"primary",variant:"ghost",class:"w-full",icon:"i-lucide-package",size:"sm",label:e.$t("ai-agent.backend.create.fromTemplate"),onClick:N(m,["stop"])},null,8,["label"]),s(y,{color:"neutral",variant:"ghost",class:"w-full",icon:"i-lucide-file-up",size:"sm",label:e.$t("ai-agent.backend.dslImport.import"),onClick:N(j,["stop"])},null,8,["label"])])]),(u(!0),w(Y,null,Z(a(x),h=>(u(),E(a(L),{key:h.id,agent:h,onDelete:B,onEdit:A,onExportDsl:O,onUpdateTags:F},null,8,["agent"]))),128))])]),_:1},8,["loading","has-more","loading-text","no-more-text"])]),_:1})])}}});export{ut as default};
