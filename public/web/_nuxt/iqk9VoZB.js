import{_ as ee}from"./Da83zglB.js";import{_ as te}from"./D_3bTjYR.js";import oe from"./cd55qm53.js";import{_ as ae}from"./Co1Njv5N.js";import{_ as re}from"./CvI6s-qz.js";import{_ as ne}from"./bvMLy1sv.js";import{d as ie,i as le,at as se,b4 as de,a2 as ce,aQ as me,s as pe,n as h,h as f,q as ue,f as v,o as V,w as i,g as e,x as n,t as l,z as d,y as fe,_ as be,A as p}from"#entry";import{_ as ge}from"./JxyxsHxp.js";import{_ as ye}from"./DD8ySyt7.js";import he from"./4jjeIyfe.js";import{_ as _e}from"./Ghlq83yM.js";import{a as xe}from"./B6e0YRC4.js";import{c as C,b as _,d as ke,e as ve}from"./FTderXKt.js";import{u as Ve}from"./UqhBTNL6.js";import"./9Q2Y_nd6.js";import"./td2xDKru.js";import"./RPflLnqr.js";import"./TrJvDfxI.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./D9sX2Qi6.js";import"./CtosDvS0.js";import"./CAQVAH0V.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./Deu6qIfg.js";import"./DBEJUH-Z.js";import"./CuVAPZQ8.js";import"./DNSLGqNg.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./Z7qkLoXK.js";import"./BstbYvQo.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./DaWZu8wl.js";const qe={class:"grid grid-cols-2 items-center gap-4"},Ce={class:"flex h-full flex-col justify-around"},je={class:"mt-6"},Ue={class:"flex items-center justify-between pb-2"},$e={class:"text-default block text-sm font-medium"},Ie={class:"mt-6 flex justify-end gap-2"},Se={class:"pb-2"},Te={class:"grid grid-cols-2 gap-4"},we={class:"flex flex-col"},Ke={class:"text-muted mt-0.5 mb-2.5 block text-sm font-medium"},Re={class:"bg-muted border-muted flex-1 overflow-y-auto rounded-lg border p-4 select-none"},Ae={class:"text-muted text-sm whitespace-pre-wrap select-none"},Fe={class:"mt-2 rounded-lg border border-blue-200 bg-blue-50 p-3 dark:border-blue-800 dark:bg-blue-800"},Je={class:"mb-2 text-sm font-medium text-blue-800 dark:text-blue-200"},Ee={class:"space-y-1 text-xs text-blue-700 dark:text-blue-200"},Pe={class:"bottom-0 z-10 flex justify-end gap-2 pt-4"},S=`{
    "name":"APIKeyModel",
    "fieldConfig":[
        {
            "name":"apiKey",
            "type":"text",
            "required":true/false,
            "placeholder":"Please enter APIKey"
        }
    ]
}`,T=`{
    "name":"APIKeyModel",
    "fieldConfig":[
        {
            "name":"apiKey",
            "type":"text",
            "required":true,
            "placeholder":"Please enter APIKey"
        }
    ]
}`,Ut=ie({__name:"type-edit",props:{id:{},isJsonImport:{type:Boolean}},emits:["close","submit","json-submit"],setup(j,{emit:w}){const x=j,u=w,{t}=le(),K=se(),{copy:R}=de(),s=ce({icon:"",name:"",isEnabled:1,fieldConfig:[{name:"",type:"text",required:!0,placeholder:""}],type:""}),y=me({jsonImport:""}),A=pe(!1),F=h(()=>[{accessorKey:"name",header:()=>f("span",[t("ai-secret.backend.type.edit.fieldName"),f("span",{class:"text-error ml-1"},"*")])},{accessorKey:"type",header:()=>f("span",[t("ai-secret.backend.type.edit.fieldType"),f("span",{class:"text-error ml-1"},"*")])},{accessorKey:"example",header:()=>f("span",[t("ai-secret.backend.type.edit.fieldExample"),f("span",{class:"text-error ml-1"},"*")])},{accessorKey:"required",header:t("ai-secret.backend.type.edit.fieldRequired")},{accessorKey:"action",header:()=>f("span",[t("console-common.operation")])}]),J=h(()=>[{label:t("console-common.enabled"),value:1},{label:t("console-common.disabled"),value:0}]),E=h(()=>[{label:t("ai-secret.backend.type.edit.singleLineText"),value:"text"},{label:t("ai-secret.backend.type.edit.number"),value:"number"},{label:t("ai-secret.backend.type.edit.multiLineText"),value:"textarea"}]),P=C({name:_().trim().required("请输入字段名称"),type:_().trim().required("请选择字段类型"),placeholder:_().trim().required("请输入字段占位符")}),N=h(()=>C({name:_().trim().required("请输入类型名称"),isEnabled:ve().required("请选择类型状态"),fieldConfig:ke().transform(r=>{if(!Array.isArray(r)||r.length===0)return r;const o=r[r.length-1];return!o?.name?.trim()&&!o?.placeholder?.trim()&&r.length>1?r.slice(0,-1):r}).of(P)})),O=C({jsonImport:_().required("请输入JSON数据").test("is-valid-json","请输入有效的JSON数据",r=>{if(!r)return!1;try{return JSON.parse(r),!0}catch{return!1}})}),B=h(()=>{try{const r=JSON.parse(S);return JSON.stringify(r,null,2)}catch{return S}}),D=async()=>{const r=await xe(x.id);Ve(s,r)},U=()=>{s.fieldConfig.push({name:"",type:"text",required:!0,placeholder:""})},$=()=>{console.log(s.fieldConfig);const r=s.fieldConfig?s.fieldConfig:[],o=r[r.length-1];if(!!((o?.name??"").trim()||(o?.placeholder??"").trim())){const c=r.some(b=>!(b?.name??"").trim()&&!(b?.placeholder??"").trim());console.log(c),c||U()}},z=r=>{s.fieldConfig.splice(r,1)},k=(r,o)=>A.value?o==="name"?!(r?.name??"").trim():o==="type"?!r.type:o==="placeholder"?!(r?.placeholder??"").trim():!1:!1,M=()=>{u("json-submit",y.jsonImport),u("close")},H=()=>{R(T),y.jsonImport=T,K.success(t("ai-secret.backend.type.edit.fillTemplateSuccess"))},L=()=>{const{type:r,...o}=s;u("submit",o,x.id),u("close")};return ue(async()=>{x.id&&(await D(),U())}),(r,o)=>{const q=ee,c=te,b=oe,G=ae,Q=re,W=ne,g=be,X=ge,I=ye,Y=he,Z=_e;return V(),v(Z,{title:x.id?e(t)("ai-secret.backend.type.edit.title"):e(t)("ai-secret.backend.type.addType"),ui:{content:"max-w-3xl overflow-y-auto h-fit"},onClose:o[6]||(o[6]=a=>u("close"))},{default:i(()=>[j.isJsonImport?(V(),v(I,{key:1,state:e(y),schema:e(O),onSubmit:M},{default:i(()=>[n("div",Se,[n("div",Te,[n("div",null,[l(c,{label:e(t)("ai-mcp.backend.form.jsonImport"),name:"jsonImport",required:""},{hint:i(()=>[l(g,{variant:"link",class:"text-primary cursor-pointer text-xs",onClick:H},{default:i(()=>[p(d(e(t)("ai-secret.backend.type.edit.fillTemplate")),1)]),_:1})]),default:i(()=>[l(Y,{modelValue:e(y).jsonImport,"onUpdate:modelValue":o[4]||(o[4]=a=>e(y).jsonImport=a),placeholder:e(t)("ai-mcp.backend.form.jsonImportPlaceholder"),rows:22,ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),n("div",we,[n("label",Ke,d(e(t)("ai-secret.backend.type.edit.templateExample")),1),n("div",Re,[n("pre",Ae,[n("code",null,d(e(B)),1)])]),n("div",Fe,[n("h4",Je,d(e(t)("ai-secret.backend.type.edit.fieldTypeSupported")),1),n("ul",Ee,[n("li",null,[o[7]||(o[7]=n("code",{class:"rounded bg-blue-100 px-1 dark:bg-blue-900"},"text",-1)),p(" - "+d(e(t)("ai-secret.backend.type.edit.fieldTypes.text")),1)]),n("li",null,[o[8]||(o[8]=n("code",{class:"rounded bg-blue-100 px-1 dark:bg-blue-900"},"textarea",-1)),p(" - "+d(e(t)("ai-secret.backend.type.edit.fieldTypes.textarea")),1)]),n("li",null,[o[9]||(o[9]=n("code",{class:"rounded bg-blue-100 px-1 dark:bg-blue-900"},"number",-1)),p(" - "+d(e(t)("ai-secret.backend.type.edit.fieldTypes.number")),1)])])])])])]),n("div",Pe,[l(g,{color:"neutral",variant:"soft",size:"lg",onClick:o[5]||(o[5]=a=>u("close"))},{default:i(()=>[p(d(e(t)("console-common.cancel")),1)]),_:1}),l(g,{color:"primary",size:"lg",type:"submit"},{default:i(()=>[p(d(e(t)("console-common.save")),1)]),_:1})])]),_:1},8,["state","schema"])):(V(),v(I,{key:0,state:e(s),schema:e(N),class:"space-y-4",onSubmit:L},{default:i(()=>[n("div",qe,[l(c,{label:e(t)("ai-secret.backend.type.edit.icon"),name:"icon"},{default:i(()=>[l(q,{modelValue:e(s).icon,"onUpdate:modelValue":o[0]||(o[0]=a=>e(s).icon=a),class:"h-32 w-32",text:"上传图标",icon:"i-lucide-upload",accept:".jpg,.png,.svg,.ico",maxCount:1,single:!0,multiple:!1},null,8,["modelValue"])]),_:1},8,["label"]),n("div",Ce,[l(c,{label:e(t)("ai-secret.backend.type.edit.name"),name:"name",required:""},{default:i(()=>[l(b,{modelValue:e(s).name,"onUpdate:modelValue":o[1]||(o[1]=a=>e(s).name=a),class:"w-full",placeholder:e(t)("ai-secret.backend.type.edit.nameRequired"),highlight:k(e(s),"name")},null,8,["modelValue","placeholder","highlight"])]),_:1},8,["label"]),l(c,{label:e(t)("ai-secret.backend.type.edit.status"),name:"isActive"},{default:i(()=>[l(G,{modelValue:e(s).isEnabled,"onUpdate:modelValue":o[2]||(o[2]=a=>e(s).isEnabled=a),items:e(J),orientation:"horizontal",color:"primary"},null,8,["modelValue","items"])]),_:1},8,["label"])])]),n("div",je,[n("div",Ue,[n("div",$e,d(e(t)("ai-secret.backend.type.edit.customField")),1)]),l(X,{columns:e(F),data:e(s).fieldConfig,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default px-2",tr:"[&:has(>td[colspan])]:hidden"}},{"name-cell":i(({row:a})=>[l(c,{name:`fieldConfig.${a.index}.name`,required:""},{default:i(()=>[l(b,{modelValue:a.original.name,"onUpdate:modelValue":[m=>a.original.name=m,$],placeholder:e(t)("ai-secret.backend.type.edit.nameRequired"),highlight:k(a.original,"name"),variant:"subtle",ui:{base:"border-0 ring-0 ring-inset outline-none bg-transparent hover:ring-1 hover:ring-primary focus:ring-1 focus:ring-primary dark:hover:ring-primary dark:focus:ring-primary hover:bg-gray-50 dark:hover:bg-gray-800/50 focus:bg-white dark:focus:bg-gray-900 transition-colors duration-200"}},null,8,["modelValue","onUpdate:modelValue","placeholder","highlight"])]),_:2},1032,["name"])]),"type-cell":i(({row:a})=>[l(c,{name:`fieldConfig.${a.index}.type`,required:""},{default:i(()=>[l(Q,{modelValue:a.original.type,"onUpdate:modelValue":m=>a.original.type=m,items:e(E),placeholder:e(t)("ai-secret.backend.type.edit.typeValueRequired"),highlight:k(a.original,"type"),variant:"subtle",ui:{base:"border-0 ring-0 ring-inset outline-none bg-transparent hover:ring-1 hover:ring-primary focus:ring-1 focus:ring-primary dark:hover:ring-primary dark:focus:ring-primary hover:bg-gray-50 dark:hover:bg-gray-800/50 focus:bg-white dark:focus:bg-gray-900 transition-colors duration-200"}},null,8,["modelValue","onUpdate:modelValue","items","placeholder","highlight"])]),_:2},1032,["name"])]),"example-cell":i(({row:a})=>[l(c,{name:`fieldConfig.${a.index}.placeholder`,required:""},{default:i(()=>[l(b,{modelValue:a.original.placeholder,"onUpdate:modelValue":[m=>a.original.placeholder=m,$],placeholder:e(t)("ai-secret.backend.type.edit.exampleRequired"),highlight:k(a.original,"example"),variant:"subtle",ui:{base:"border-0 ring-0 ring-inset outline-none bg-transparent hover:ring-1 hover:ring-primary focus:ring-1 focus:ring-primary dark:hover:ring-primary dark:focus:ring-primary hover:bg-gray-50 dark:hover:bg-gray-800/50 focus:bg-white dark:focus:bg-gray-900 transition-colors duration-200"}},null,8,["modelValue","onUpdate:modelValue","placeholder","highlight"])]),_:2},1032,["name"])]),"required-cell":i(({row:a})=>[l(c,{name:`fieldConfig.${a.index}.required`,class:"px-3",required:""},{default:i(()=>[l(W,{modelValue:a.original.required,"onUpdate:modelValue":m=>a.original.required=m},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["name"])]),"action-cell":i(({row:a})=>[a.index!==e(s).fieldConfig.length-1?(V(),v(g,{key:0,class:"cursor-pointer px-3",icon:"i-tabler-trash",color:"error",variant:"ghost",onClick:m=>z(a.index)},null,8,["onClick"])):fe("",!0)]),_:1},8,["columns","data"])]),n("div",Ie,[l(g,{color:"neutral",variant:"soft",onClick:o[3]||(o[3]=a=>u("close"))},{default:i(()=>[p(d(e(t)("console-common.cancel")),1)]),_:1}),l(g,{color:"primary",type:"submit"},{default:i(()=>[p(d(e(t)("console-common.save")),1)]),_:1})])]),_:1},8,["state","schema"]))]),_:1},8,["title"])}}});export{Ut as default};
