import U from"./cd55qm53.js";import{_ as I}from"./D_3bTjYR.js";import q from"./4jjeIyfe.js";import{_ as z}from"./Da83zglB.js";import{_ as N}from"./bvMLy1sv.js";import{d as F,i as B,at as C,a2 as T,aN as R,q as j,f as A,o as L,w as n,t as s,x as g,g as o,z as p,_ as M,A as f}from"#entry";import{_ as Z}from"./DD8ySyt7.js";import{_ as K}from"./Ghlq83yM.js";import{E as O}from"./C_Nw1JQK.js";import{a as P,b as W}from"./CsRstiIM.js";import{c as G,b as _}from"./FTderXKt.js";import"./D9sX2Qi6.js";import"./9Q2Y_nd6.js";import"./td2xDKru.js";import"./RPflLnqr.js";import"./TrJvDfxI.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./CAQVAH0V.js";import"./Deu6qIfg.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./BFo3vNrE.js";import"./CuVAPZQ8.js";import"./Z7qkLoXK.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./DaWZu8wl.js";const H={class:"text-xs"},J={class:"flex justify-end gap-4 pt-8"},$e=F({__name:"extension-edit",props:{isEdit:{type:Boolean,default:!1},id:{default:null},initialData:{default:()=>({})}},emits:["close"],setup(v,{emit:b}){const d=b,r=v,{t:a}=B(),c=C(),e=T({name:"",icon:"",packName:"",description:"",version:"",type:1,alias:"",aliasDescription:"",aliasIcon:"",aliasShow:!0,supportTerminal:[],author:{avatar:"",name:"",homepage:""},...r.initialData}),w=G({name:_().required(a("extensions.develop.form.nameRequired")),packName:_().required(a("extensions.develop.form.keyRequired")).matches(/^[a-zA-Z][a-zA-Z0-9_-]*$/,a("extensions.develop.form.keyFormat")),description:_().required(a("extensions.develop.form.descriptionRequired"))}),y=()=>{Object.keys(e).forEach(l=>{const t=l;typeof e[t]=="string"&&(e[t]="")}),e.type=1,e.supportTerminal=[O.WEB],c.info(a("extensions.develop.messages.formReset"))},{isLock:h,lockFn:V}=R(async()=>{try{const l={name:e.name,identifier:e.packName,description:e.description,version:e.version,icon:e.icon,author:e.author||{avatar:"",name:"",homepage:""},type:e.type,alias:e.alias,aliasDescription:e.aliasDescription,aliasIcon:e.aliasIcon,aliasShow:e.aliasShow,status:1,supportTerminal:e.supportTerminal.map(t=>Number(t))};return r.isEdit&&r.id?(await P(r.id.toString(),l),c.success(a("extensions.develop.messages.updateSuccess"))):(await W(l),c.success(a("extensions.develop.messages.createSuccess"))),d("close",!0),!0}catch(l){return console.error("Failed to submit form:",l),!1}});return j(()=>{console.log(r.initialData),e.alias||(e.alias=e.name),e.aliasDescription||(e.aliasDescription=e.description),e.aliasIcon||(e.aliasIcon=e.icon)}),(l,t)=>{const x=U,m=I,S=q,D=z,E=N,u=M,$=Z,k=K;return L(),A(k,{title:l.$t("extensions.modal.editExtension"),description:l.$t("extensions.modal.addExtensionDescription"),ui:{content:"max-w-xl"},onClose:t[6]||(t[6]=i=>d("close",!1))},{default:n(()=>[s($,{ref:"formRef",state:o(e),schema:o(w),class:"w-full space-y-2",onSubmit:o(V)},{default:n(()=>[s(m,{label:o(a)("extensions.develop.form.name"),required:"",name:"name"},{default:n(()=>[s(x,{modelValue:o(e).name,"onUpdate:modelValue":t[0]||(t[0]=i=>o(e).name=i),variant:"subtle",disabled:!0,placeholder:o(a)("extensions.develop.form.nameInput"),size:"lg",ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(m,{label:o(a)("decorate.apps.extensionEdit.displayName"),name:"alias"},{default:n(()=>[s(x,{modelValue:o(e).alias,"onUpdate:modelValue":t[1]||(t[1]=i=>o(e).alias=i),placeholder:o(a)("decorate.apps.extensionEdit.displayNamePlaceholder"),size:"lg",ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(m,{label:o(a)("extensions.develop.form.description"),required:"",name:"description"},{default:n(()=>[s(S,{modelValue:o(e).aliasDescription,"onUpdate:modelValue":t[2]||(t[2]=i=>o(e).aliasDescription=i),placeholder:o(a)("extensions.develop.form.descriptionInput"),size:"lg",rows:2,ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),s(m,{label:o(a)("extensions.develop.form.icon"),required:"",name:"icon"},{help:n(()=>[g("span",H,p(o(a)("extensions.develop.form.iconRecommendation")),1)]),default:n(()=>[s(D,{modelValue:o(e).aliasIcon,"onUpdate:modelValue":t[3]||(t[3]=i=>o(e).aliasIcon=i),class:"size-20",text:o(a)("extensions.develop.form.addIcon"),icon:"i-lucide-upload",accept:".jpg,.png,.jpeg,.gif",maxCount:1,single:!0},null,8,["modelValue","text"])]),_:1},8,["label"]),s(m,{label:o(a)("decorate.apps.extensionEdit.aliasShowLabel"),required:"",name:"aliasShow"},{default:n(()=>[s(E,{modelValue:o(e).aliasShow,"onUpdate:modelValue":t[4]||(t[4]=i=>o(e).aliasShow=i),description:o(a)("decorate.apps.extensionEdit.aliasShowDescription")},null,8,["modelValue","description"])]),_:1},8,["label"]),g("div",J,[s(u,{color:"neutral",variant:"outline",size:"lg",onClick:t[5]||(t[5]=i=>d("close",!1))},{default:n(()=>[f(p(o(a)("console-common.cancel")),1)]),_:1}),s(u,{color:"neutral",size:"lg",onClick:y},{default:n(()=>[f(p(o(a)("console-common.reset")),1)]),_:1}),s(u,{color:"primary",size:"lg",loading:o(h),type:"submit"},{default:n(()=>[f(p(r.isEdit?o(a)("console-common.update"):o(a)("console-common.create")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"])]),_:1},8,["title","description"])}}});export{$e as default};
