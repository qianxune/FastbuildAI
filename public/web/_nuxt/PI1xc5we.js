const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./CRmlDHjI.js","./Cgyg1gJC.js","./DbqqhwXM.js","./DNSLGqNg.js","./psimjGaX.js","./CuVAPZQ8.js","./B3rWqoNg.js","./EK7Wbu3-.js","./DBiaUVBh.js","./Ce6s6j9m.js","./CBTz8tdX.js","./DMoqg0Fd.js","./CtosDvS0.js","./kRIii9yh.js","./Z7qkLoXK.js","./C6Y-ieo6.js","./BFo3vNrE.js","./DeCyaT7k.js","./D4e4FYoF.js","./BCcN9pii.js","./CMKSl-Ng.js","./Y67jy4iF.js","./CjasYwqF.js","./CAQVAH0V.js","./DBEJUH-Z.js","./Deu6qIfg.js","./D9sX2Qi6.js","./BlyoSzaa.js","./CICEKNnJ.js","./o4ws_w_T.js","./vMXLMQMq.js","./BMSQkwth.js","./DaWZu8wl.js","./abPSHzII.js","./B8dIIAdq.js","./Cie-o9Wa.js","./jsPNKUA0.js","./Ghlq83yM.js","./DQMjdCEn.js","./OUYfsp1i.js","./CjE5iPSn.js","./D9UsdH-b.js","./MCK2d4XT.js","./C0aZ0x4t.js","./Bni8bPEl.js"])))=>i.map(i=>d[i]);
import{d as oe,at as ae,i as se,k as ne,V as le,a2 as ie,s as re,l as ce,h as k,n as B,q as de,c as f,o as m,x as l,f as h,y as me,t as i,g as t,w as r,z as c,_ as pe,A as x,D as ue,G as _e,B as ge,F as fe,E as he,W as I,X as P}from"#entry";import{_ as be}from"./Y67jy4iF.js";import{_ as ve}from"./DBiaUVBh.js";import ye from"./cd55qm53.js";import{_ as ke}from"./B4OpYolY.js";import{_ as xe}from"./B3rWqoNg.js";import{_ as Ce}from"./B5gsc-Ax.js";import{_ as we}from"./DO9M7gn1.js";import{_ as De}from"./o4ws_w_T.js";import{_ as Se}from"./CBTz8tdX.js";import{_ as Ae}from"./JxyxsHxp.js";import{_ as Ve}from"./Cie-o9Wa.js";import{_ as Ue}from"./D4ebF709.js";import{c as $e,d as ze,e as Be}from"./C0aZ0x4t.js";import{u as Ie}from"./BlyoSzaa.js";import{u as Pe}from"./ZDOPDbaX.js";import{u as Te}from"./CSy6ZCzT.js";import"./CjasYwqF.js";import"./CAQVAH0V.js";import"./DBEJUH-Z.js";import"./CuVAPZQ8.js";import"./CMKSl-Ng.js";import"./BCcN9pii.js";import"./CtosDvS0.js";import"./Deu6qIfg.js";import"./D9sX2Qi6.js";import"./C5Ha_WGa.js";import"./DMoqg0Fd.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./psimjGaX.js";import"./hsuWSsy6.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./o0-e7Rye.js";const Re={class:"conversation-list-container pb-5"},Ke={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-2"},Ee={class:"flex items-center gap-2 md:ml-auto"},Ne={class:"flex items-center gap-2"},Le={class:"text-muted-foreground text-sm"},Fe={class:"flex items-center gap-2"},Me={class:"flex items-center gap-2"},je={class:"text-primary"},Oe={class:"text-success"},Ge={class:"mt-2 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},qe={key:2,class:"flex h-[calc(100vh-13rem)] items-center justify-center"},He={class:"flex items-center gap-3"},We={class:"text-accent-foreground"},Xe={key:3,class:"flex h-[calc(100vh-13rem)] flex-col items-center justify-center"},Je={class:"text-secondary-foreground mb-2 text-lg font-medium"},Qe={class:"text-accent-foreground"},Ye={key:4,class:"bg-background sticky bottom-0 z-10 flex items-center justify-between gap-3 py-4"},Ze={class:"text-muted text-sm"},et={class:"flex items-center gap-1.5"},Ot=oe({__name:"list",setup(tt){const T=I(()=>P(()=>import("./CRmlDHjI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27]),import.meta.url)),R=I(()=>P(()=>import("./CICEKNnJ.js"),__vite__mapDeps([28,1,8,29,30,31,32,33,34,35,36,37,38,39,16,5,14,40,41,42,7,43,44]),import.meta.url)),b=be,K=ve,{hasAccessByCodes:E}=Ie(),C=ae(),{t:n}=se(),w=ne("table"),N=le(),p=ie({keyword:"",modelId:"",startDate:"",endDate:""}),_=re(1),L=[{value:1,icon:"i-lucide-list"},{value:2,icon:"i-tabler-layout-grid"}],d=ce(new Set),{paging:s,getLists:g}=Pe({fetchFun:$e,params:p}),D=(e,o)=>{if(typeof o=="boolean"){const u=e.id;o?d.value.add(u):d.value.delete(u)}},F=[{id:"select",header:({table:e})=>k(b,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":o=>{e.toggleAllPageRowsSelected(!!o),S(o)},"aria-label":"Select all"}),cell:({row:e})=>k(b,{modelValue:e.getIsSelected(),"onUpdate:modelValue":o=>{e.toggleSelected(!!o),D(e.original,o)},"aria-label":"Select row"})},{accessorKey:"title",header:n("ai-chat.backend.list.title")},{accessorKey:"userName",header:n("ai-chat.backend.list.userName")},{accessorKey:"messageCount",header:n("ai-chat.backend.list.messageCount")},{accessorKey:"totalTokens",header:n("ai-chat.backend.list.totalTokens")},{accessorKey:"totalPower",header:n("ai-chat.backend.list.totalPower")},{accessorKey:"updatedAt",header:n("console-common.updateAt"),cell:({row:e})=>{const o=e.getValue("updatedAt");return k(K,{datetime:o,mode:"datetime"})}},{accessorKey:"action",header:n("console-common.operation"),size:40,enableSorting:!1,enableHiding:!1}];function M(e){return[{label:n("order.backend.recharge.list.viewDetails"),icon:"i-lucide-eye",color:"info",onClick:()=>{v(e.original.id)}},E(["ai-conversations:ai_conversation_delete"])?{label:n("console-common.delete"),icon:"i-lucide-trash-2",color:"error",onSelect(){V(e.original)}}:null].filter(Boolean)}const S=e=>{const o=e===!0;w.value?.tableApi.toggleAllPageRowsSelected(!!e),o?s.items.forEach(u=>{d.value.add(u.id)}):d.value.clear()},A=async e=>{try{await Te({title:n("ai-chat.backend.delete.title"),description:n("ai-chat.backend.delete.description"),color:"error",cancelText:n("console-common.cancel"),confirmText:n("console-common.confirm")}),Array.isArray(e)?(await ze(e),C.success(n("common.message.deleteBatchSuccess"))):(await Be(e),C.success(n("common.message.deleteSuccess"))),d.value.clear(),g()}catch(o){console.error("Delete failed:",o)}},V=e=>{A(e.id)},j=()=>{const e=Array.from(d.value);e.length!==0&&A(e)},O=e=>{N.create(R).open({conversationId:e})},v=e=>{O(e)},G=B(()=>s.items.length>0&&s.items.every(e=>d.value.has(e.id))),q=B(()=>{const e=s.items.filter(o=>d.value.has(o.id)).length;return e>0&&e<s.items.length}),H=e=>{v(e.original.id)};return de(()=>g()),(e,o)=>{const u=ye,W=ke,X=xe,U=pe,J=Ce,Q=we,y=ge,$=_e,Y=De,Z=Se,ee=Ae,z=Ve,te=Ue;return m(),f("div",Re,[l("div",Ke,[i(u,{modelValue:t(p).keyword,"onUpdate:modelValue":o[0]||(o[0]=a=>t(p).keyword=a),placeholder:e.$t("ai-chat.backend.search.placeholder"),onChange:t(g)},null,8,["modelValue","placeholder","onChange"]),i(W,{start:t(p).startDate,"onUpdate:start":o[1]||(o[1]=a=>t(p).startDate=a),end:t(p).endDate,"onUpdate:end":o[2]||(o[2]=a=>t(p).endDate=a),ui:{root:"w-auto sm:w-xs"},onChange:t(g)},null,8,["start","end","onChange"]),l("div",Ee,[l("div",Ne,[i(t(b),{"model-value":t(G)?!0:t(q)?"indeterminate":!1,"onUpdate:modelValue":S},{label:r(()=>[l("span",Le,c(t(d).size)+" / "+c(t(s).items.length)+" "+c(t(n)("console-common.selected")),1)]),_:1},8,["model-value"])]),i(J,{codes:["ai_conversation_delete"]},{default:r(()=>[i(U,{color:"error",variant:"subtle",label:e.$t("console-common.batchDelete"),icon:"i-heroicons-trash",disabled:t(d).size===0,onClick:j},{trailing:r(()=>[i(X,null,{default:r(()=>[x(c(t(d).size),1)]),_:1})]),_:1},8,["label","disabled"])]),_:1}),i(Q,{modelValue:t(_),"onUpdate:modelValue":o[3]||(o[3]=a=>ue(_)?_.value=a:null),items:L,size:"xs",ui:{root:"gap-0",indicator:"bg-background dark:bg-primary",leadingIcon:"bg-black dark:bg-white"}},null,8,["modelValue"])])]),!t(s).loading&&t(s).items.length>0&&t(_)===1?(m(),h(z,{key:0,class:"h-[calc(100vh-13rem)] pt-2",shadow:!1},{default:r(()=>[i(ee,{ref_key:"table",ref:w,data:t(s).items,columns:F,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default cursor-pointer",tr:"[&:has(>td[colspan])]:hidden"},onSelect:H},{"title-cell":r(({row:a})=>[l("div",Fe,[i(y,{name:"i-lucide-message-circle",class:"text-primary size-5"}),x(" "+c(a.original.title||"new Chat"),1)])]),"userName-cell":r(({row:a})=>[l("div",Me,[a.original.user?.avatar?(m(),h($,{key:0,src:a.original.user?.avatar},null,8,["src"])):(m(),h($,{key:1,icon:"i-heroicons-user",name:a.original.user?.username},null,8,["name"])),l("span",null,c(a.original.user?.nickname),1)])]),"messageCount-cell":r(({row:a})=>[i(Y,{color:"primary",variant:"subtle"},{default:r(()=>[x(c(a.original.messageCount),1)]),_:2},1024)]),"totalTokens-cell":r(({row:a})=>[l("span",je,c(a.original.totalTokens),1)]),"totalPower-cell":r(({row:a})=>[l("span",Oe,c(a.original.totalPower),1)]),"action-cell":r(({row:a})=>[i(Z,{items:M(a)},{default:r(()=>[i(U,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost","aria-label":"Actions"})]),_:1},8,["items"])]),_:1},8,["data"])]),_:1})):!t(s).loading&&t(s).items.length>0&&t(_)===2?(m(),h(z,{key:1,class:"h-[calc(100vh-13rem)]",shadow:!1},{default:r(()=>[l("div",Ge,[(m(!0),f(fe,null,he(t(s).items,a=>(m(),h(t(T),{key:a.id,conversation:a,selected:t(d).has(a.id),onSelect:D,onDelete:V,onViewDetail:v},null,8,["conversation","selected"]))),128))])]),_:1})):t(s).loading?(m(),f("div",qe,[l("div",He,[i(y,{name:"i-lucide-loader-2",class:"text-primary-500 h-6 w-6 animate-spin"}),l("span",We,c(e.$t("common.loading")),1)])])):(m(),f("div",Xe,[i(y,{name:"i-lucide-message-circle",class:"text-muted mb-4 h-16 w-16"}),l("h3",Je,c(e.$t("ai-chat.backend.empty.title")),1),l("p",Qe,c(e.$t("ai-chat.backend.empty.description")),1)])),t(s).total>0?(m(),f("div",Ye,[l("div",Ze,c(t(d).size)+" "+c(e.$t("console-common.selected")),1),l("div",et,[i(te,{page:t(s).page,"onUpdate:page":o[4]||(o[4]=a=>t(s).page=a),size:t(s).pageSize,"onUpdate:size":o[5]||(o[5]=a=>t(s).pageSize=a),total:t(s).total,onChange:t(g)},null,8,["page","size","total","onChange"])])])):me("",!0)])}}});export{Ot as default};
