import{d as O,i as A,s as k,l as E,n as J,aN as R,q,c,o as d,x as t,t as s,A as f,z as a,w as u,B as G,_ as W,F as z,E as D,aY as Y,g as i,C as H,D as K,aW as P}from"#entry";import{_ as Q}from"./DbqqhwXM.js";import{_ as X}from"./Cie-o9Wa.js";import{_ as Z}from"./Ghlq83yM.js";import{i as ee}from"./gu2_Ts15.js";import"./DNSLGqNg.js";import"./psimjGaX.js";import"./CuVAPZQ8.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./BFo3vNrE.js";import"./Z7qkLoXK.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";const te={class:"bg-muted rounded-lg p-3"},se={class:"flex items-center justify-between"},oe={class:"text-foreground flex items-center gap-1 text-sm font-medium"},ae={class:"text-background text-xs"},ne={class:"space-y-3"},le={class:"flex flex-1 items-center gap-2"},ie={class:"bg-primary-50 border-default flex rounded-lg border p-2"},re={class:"text-foreground flex text-sm font-medium"},ce={class:"flex items-center group-hover:hidden"},de={class:"ml-3 text-xs"},ue={class:"hidden items-center group-hover:flex"},me={key:0,class:"flex h-90 flex-col items-center justify-center"},pe={class:"text-sm"},fe={key:1,class:"h-90"},_e=["onClick"],ve={class:"flex flex-1 items-center gap-2"},ge={class:"bg-muted border-default flex rounded-lg border p-2"},he={class:"text-foreground flex text-sm font-medium"},xe={class:"flex items-center group-hover:hidden"},be={class:"ml-3 text-xs"},ye={key:2,class:"text-muted-foreground flex flex-col items-center justify-center py-12"},ke={class:"text-sm font-medium"},$e={class:"mt-6 flex justify-end gap-2"},Ge=O({__name:"datasets",props:{modelValue:{}},emits:["update:modelValue"],setup(M,{emit:B}){const b=P(M,"modelValue",B),{t:m}=A(),p=k(!1),_=k([]),v=k([]),l=E([]),g={vector:{value:m("ai-datasets.backend.retrieval.vector"),color:"primary"},fullText:{value:m("ai-datasets.backend.retrieval.fullText"),color:"success"},hybrid:{value:m("ai-datasets.backend.retrieval.hybrid"),color:"warning"}},$=J(()=>e=>l.value.findIndex(o=>o.id===e.id)!==-1),L=e=>{if($.value(e)){const o=l.value.findIndex(r=>r.id===e.id);l.value.splice(o,1);return}l.value.push(e)},S=e=>{l.value.splice(e,1),v.value.splice(e,1),b.value=l.value.map(o=>o.id)},V=()=>{b.value=l.value.map(e=>e.id),v.value=l.value.map(e=>e),y()},N=()=>{p.value=!0},y=()=>{p.value=!1},{lockFn:T,isLock:C}=R(async()=>{try{const e=await ee({page:1,pageSize:9999});_.value=e.items||[],l.value=_.value.filter(o=>b.value.includes(o.id)),v.value=JSON.parse(JSON.stringify(l.value))}catch(e){console.error("get dataset list failed:",e)}});return q(()=>T()),(e,o)=>{const r=G,U=Q,h=W,w=Y,j=X,F=Z;return d(),c("div",null,[t("div",te,[t("div",se,[t("div",oe,[f(a(e.$t("ai-agent.backend.configuration.datasets"))+" ",1),s(U,{"delay-duration":0,ui:{content:"w-xs h-auto"}},{content:u(()=>[t("div",ae,[f(a(e.$t("ai-agent.backend.configuration.datasetsDesc"))+" ",1),o[1]||(o[1]=t("br",null,null,-1)),f(" "+a(e.$t("ai-agent.backend.configuration.datasetsDesc2")),1)])]),default:u(()=>[s(r,{name:"i-lucide-circle-help"})]),_:1})]),s(h,{size:"sm",color:"primary",variant:"ghost",class:"flex items-center",onClick:N},{default:u(()=>[s(r,{name:"i-lucide-plus"}),t("span",null,a(e.$t("console-common.add")),1)]),_:1})]),t("div",ne,[(d(!0),c(z,null,D(i(v),(n,x)=>(d(),c("div",{key:x,class:"group bg-background mt-2 flex items-center gap-2 rounded-lg px-3 py-2"},[t("div",le,[t("div",ie,[s(r,{name:"i-lucide-folder",class:"text-primary size-4"})]),t("div",re,a(n.name),1)]),t("div",ce,[s(w,{color:g[n.retrievalMode].color,size:"sm"},null,8,["color"]),t("span",de,a(g[n.retrievalMode].value),1)]),t("div",ue,[s(h,{size:"xs",color:"error",variant:"ghost",icon:"i-lucide-trash",onClick:I=>S(x)},null,8,["onClick"])])]))),128))])]),s(F,{open:i(p),"onUpdate:open":o[0]||(o[0]=n=>K(p)?p.value=n:null),title:i(m)("ai-agent.backend.configuration.datasetsTitle"),description:i(m)("ai-agent.backend.configuration.datasetsDesc"),ui:{content:"max-w-md"},onClose:y},{default:u(()=>[i(C)?(d(),c("div",me,[s(r,{name:"i-lucide-loader-circle",class:"animate-spin"}),t("span",pe,a(e.$t("common.loading")),1)])):i(_).length?(d(),c("div",fe,[s(j,{class:"h-full pr-3",shadow:!1},{default:u(()=>[(d(!0),c(z,null,D(i(_),(n,x)=>(d(),c("div",{key:x,class:H(["bg-background border-default mt-2 mb-2 flex cursor-pointer items-center gap-2 rounded-lg border px-3 py-2",{"bg-primary-50! border-primary!":i($)(n)}]),onClick:I=>L(n)},[t("div",ve,[t("div",ge,[s(r,{name:"i-lucide-folder",class:"text-primary size-5"})]),t("div",he,a(n.name),1)]),t("div",xe,[s(w,{color:g[n.retrievalMode].color,size:"sm"},null,8,["color"]),t("span",be,a(g[n.retrievalMode].value),1)])],10,_e))),128))]),_:1})])):(d(),c("div",ye,[s(r,{name:"i-lucide-database",class:"mb-3 h-8 w-8 opacity-50"}),t("span",ke,a(e.$t("console-common.empty")),1)])),t("div",$e,[s(h,{color:"neutral",variant:"soft",size:"lg",onClick:y},{default:u(()=>[f(a(e.$t("console-common.cancel")),1)]),_:1}),s(h,{color:"primary",size:"lg",type:"submit",disabled:i(C),onClick:V},{default:u(()=>[f(a(e.$t("console-common.save")),1)]),_:1},8,["disabled"])])]),_:1},8,["open","title","description"])])}}});export{Ge as default};
