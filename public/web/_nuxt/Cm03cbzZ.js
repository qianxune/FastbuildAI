import{u as R,d as A,aM as L,n as l,b2 as N,l as _,p as I,J as y,q as C,ai as D,c as U,f as F,g as n,x as m,y as G,t as j,G as M,b3 as V,o as g,aK as P}from"#entry";function T(p){return console.log("apiGetWebExtensionDetailByIdentifier",p),R(`/extension/detail/${p}`)}const q={key:0,class:"relative h-full w-full"},J=["src","title"],K={key:0,class:"absolute inset-0 z-999999 flex items-center justify-center bg-[#f8f9fa] text-inherit dark:bg-[#121212] dark:text-[#ddd]"},S={class:"flex flex-col items-center gap-6"},H={class:"flex size-[240px] items-center justify-center"},O={class:"animate-[pulse_1.5s_ease-in-out_infinite] drop-shadow-[0_0_12px_rgba(81,10,252,0.2)] motion-reduce:animate-none dark:drop-shadow-[0_0_12px_rgba(81,10,252,0.35)]"},X=A({__name:"[...all]",async setup(p){let c,w;const u=L(),r=l(()=>u.path.includes("/console")),t=l(()=>r.value?"":u.fullPath.match(/\/app\/([^/]+)/)?.[1]||""),{data:d}=([c,w]=N(async()=>V(`extension-info-${t.value}`,async()=>{if(!t.value)return null;try{return await T(t.value)}catch(e){return console.error("[extension] Failed to load extension info:",e),null}},{default:()=>null,watch:[t]})),c=await c,w(),c),$=l(()=>d.value?.aliasIcon||d.value?.icon||""),E=l(()=>d.value?.alias||d.value?.name||t.value||"Extension"),x=l(()=>{const e=u.params.all;return Array.isArray(e)&&e.length>1?e.slice(1).join("/"):""}),W=l(()=>{const e=`/extension/${t.value}/`;return x.value?`${e}${x.value}`:e}),s=_(null),h=_(!1),f=_(!1),v=_(!0),b=e=>e?`/app/${t.value}/${e}`:`/app/${t.value}`,k=e=>{u.path!==e&&(f.value=!0,window.history.replaceState({...window.history.state},"",e),y(()=>{f.value=!1}))},z=()=>{if(!(r.value||!s.value?.contentWindow||h.value||f.value))try{const{pathname:e,search:a,hash:i}=s.value.contentWindow.location,o=(e+a+i).match(/^\/extension\/[^/]+\/(.*)$/);k(b(o?.[1]||""))}catch{}},B=()=>{v.value=!1,y(z)};return I(()=>x.value,e=>{if(r.value||!s.value||f.value)return;const a=e?`/extension/${t.value}/${e}`:`/extension/${t.value}/`;s.value.src.endsWith(a)||(h.value=!0,v.value=!0,s.value.src=a,y(()=>{h.value=!1}))}),I(()=>t.value,()=>{r.value||(v.value=!0)}),C(()=>{const e=a=>{const{type:i,path:o}=a.data||{};i!=="extension-navigation"||o.startsWith("console")||k(b(o))};window.addEventListener("message",e),D(()=>window.removeEventListener("message",e))}),(e,a)=>{const i=M,o=P;return n(r)?(g(),F(o,{key:1})):(g(),U("div",q,[m("iframe",{ref_key:"iframeRef",ref:s,src:n(W),class:"h-full w-full border-0",title:`Extension Frontend: ${n(t)}`,loading:"eager",onLoad:B},null,40,J),n(v)?(g(),U("div",K,[m("div",S,[m("div",H,[m("div",O,[j(i,{src:n($)||void 0,alt:n(E),icon:"i-lucide-puzzle",ui:{root:`size-12 rounded-xl ${n($)?"":"bg-primary"}`,icon:"size-6 text-white"}},null,8,["src","alt","ui"])])])])])):G("",!0)]))}}});export{X as default};
