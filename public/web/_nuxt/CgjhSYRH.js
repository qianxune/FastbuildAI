import{d as S,i as q,at as L,av as T,l as E,n as R,bv as G,aN as x,q as O,f as y,o as m,w as l,c as p,g as o,t as r,B as H,x as d,y as w,E as J,C as f,z as g,F as K,A as _,_ as Q,aO as W}from"#entry";import{_ as X}from"./D_3bTjYR.js";import{_ as Y}from"./Da83zglB.js";import Z from"./cd55qm53.js";import ee from"./4jjeIyfe.js";import{_ as ae}from"./DD8ySyt7.js";import{_ as te}from"./Ghlq83yM.js";import{g as oe,a as ie,m as ne}from"./Dm8J87dm.js";import{c as re,b as z}from"./FTderXKt.js";import{u as se}from"./CxvgZo8z.js";import"./D9sX2Qi6.js";import"./9Q2Y_nd6.js";import"./td2xDKru.js";import"./RPflLnqr.js";import"./TrJvDfxI.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./BFo3vNrE.js";import"./CuVAPZQ8.js";import"./Z7qkLoXK.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./DaWZu8wl.js";const ce={key:0,class:"flex items-center justify-center",style:{height:"420px"}},le={class:"flex flex-col gap-5"},de={class:"grid grid-cols-3 gap-5"},me=["onClick"],ue={class:"mb-4 flex items-start justify-between"},pe=["src","alt"],ge={class:"bg-primary flex size-6 items-center justify-center rounded-full text-white shadow-sm"},fe={class:"flex flex-1 flex-col gap-2"},ve={class:"text-xs leading-relaxed font-medium text-gray-500"},be={class:"bg-background sticky bottom-0 z-10 flex justify-end gap-4 py-3"},He=S({__name:"agent-modal",props:{id:{}},emits:["close"],setup(C,{emit:M}){const s=C,v=M,{t:n}=q(),h=L(),V=T(),a=E({name:"",description:"",avatar:"",createMode:"direct",thirdPartyIntegration:{}}),k=R(()=>{const e=[{value:"direct",label:n("ai-agent.backend.create.modes.direct"),description:n("ai-agent.backend.create.modesDesc.direct"),icon:"i-lucide-bot"},{value:"coze",label:n("ai-agent.backend.create.modes.coze"),description:n("ai-agent.backend.create.modesDesc.coze"),icon:"/images/coze.png"},{value:"dify",label:n("ai-agent.backend.create.modes.dify"),description:n("ai-agent.backend.create.modesDesc.dify"),icon:"/images/dify.png"}],i=G("agent:create:modes").value.map(c=>({value:c.meta?.value,label:n(c.meta?.label),description:c.meta?.description||n("ai-agent.backend.create.modesDesc.plugin"),icon:c.meta?.icon}));return[...e,...i]}),U=re({name:z().required(n("ai-agent.backend.create.namePlaceholder")),description:z().required(n("ai-agent.backend.create.descriptionPlaceholder"))}),{lockFn:D,isLock:F}=x(async()=>{try{const{createdAt:e,userCount:i,updatedAt:c,id:u,...b}=await oe(s.id);a.value=b}catch(e){console.error("获取智能体详情失败:",e)}}),{lockFn:P,isLock:j}=x(async()=>{try{if(s.id)a.value.avatar===void 0&&(a.value.avatar=null),await ie(s.id,{name:a.value.name,description:a.value.description,avatar:a.value.avatar}),W(`agent-detail-${s.id}`),h.success(n("common.message.updateSuccess"));else{const e=await ne({name:a.value.name,description:a.value.description,avatar:a.value.avatar,createMode:a.value.createMode,thirdPartyIntegration:a.value.thirdPartyIntegration});V.push(se("ai-agent:detail",{id:e.id})),h.success(n("common.message.createSuccess"))}v("close",!0)}catch(e){console.error(`${s.id?"更新":"创建"}智能体失败:`,e)}});return O(async()=>{s.id&&D()}),(e,i)=>{const c=H,u=X,b=Y,A=Z,B=ee,$=Q,I=ae,N=te;return m(),y(N,{title:s.id?e.$t("ai-agent.backend.create.editTitle"):e.$t("ai-agent.backend.create.title"),description:s.id?e.$t("ai-agent.backend.create.editDesc"):e.$t("ai-agent.backend.create.desc"),ui:{content:"max-w-3xl"},onClose:i[4]||(i[4]=t=>v("close",!1))},{default:l(()=>[o(F)?(m(),p("div",ce,[r(c,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):(m(),y(I,{key:1,schema:o(U),state:o(a),class:"space-y-6 px-1",onSubmit:o(P)},{default:l(()=>[d("div",le,[!s.id&&o(k).length!=1?(m(),y(u,{key:0,label:e.$t("ai-agent.backend.create.mode"),name:"createMode",class:"space-y-2"},{default:l(()=>[d("div",de,[(m(!0),p(K,null,J(o(k),t=>(m(),p("div",{key:t.value,class:f(["group relative flex h-full cursor-pointer flex-col rounded-xl border p-5 transition-all duration-300 ease-out",[o(a).createMode===t.value?"border-primary ring-primary bg-primary/5 -translate-y-1 shadow-md ring-1":"hover:border-primary/30 border-gray-100 bg-white hover:-translate-y-1 hover:shadow-xl"]]),onClick:ye=>o(a).createMode=t.value},[d("div",ue,[t.icon&&typeof t.icon=="string"&&!t.icon.includes(".")?(m(),p("div",{key:0,class:f(["flex size-11 items-center justify-center rounded-lg shadow-sm transition-colors duration-200",[o(a).createMode===t.value?"bg-primary text-white":"group-hover:text-primary group-hover:ring-primary/20 bg-white text-gray-600 ring-1 ring-gray-100"]])},[r(c,{name:t.icon,class:"size-6"},null,8,["name"])],2)):t.icon?(m(),p("img",{key:1,src:t.icon,alt:t.label,class:"size-11 object-contain"},null,8,pe)):w("",!0),d("div",{class:f(["transition-all duration-200",[o(a).createMode===t.value?"scale-100 opacity-100":"scale-75 opacity-0"]])},[d("div",ge,[r(c,{name:"i-lucide-check",class:"size-3.5"})])],2)]),d("div",fe,[d("div",{class:f(["text-base font-bold transition-colors duration-200",[o(a).createMode===t.value?"text-primary":"group-hover:text-primary text-gray-900"]])},g(t.label),3),d("div",ve,g(t.description),1)])],10,me))),128))])]),_:1},8,["label"])):w("",!0),r(u,{label:e.$t("ai-agent.backend.create.avatar"),name:"avatar"},{hint:l(()=>[_(g(e.$t("ai-agent.backend.create.avatarDefault")),1)]),default:l(()=>[r(b,{modelValue:o(a).avatar,"onUpdate:modelValue":i[0]||(i[0]=t=>o(a).avatar=t),class:"h-24 w-24",text:e.$t("ai-agent.backend.create.avatarUpload"),icon:"i-lucide-upload",accept:".jpg,.png,.jpeg,.gif,.webp",maxCount:1,single:!0,multiple:!1},null,8,["modelValue","text"])]),_:1},8,["label"]),r(u,{label:e.$t("ai-agent.backend.create.name"),name:"name",required:""},{default:l(()=>[r(A,{modelValue:o(a).name,"onUpdate:modelValue":i[1]||(i[1]=t=>o(a).name=t),placeholder:e.$t("ai-agent.backend.create.namePlaceholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),r(u,{label:e.$t("ai-agent.backend.create.description"),name:"description",required:""},{default:l(()=>[r(B,{modelValue:o(a).description,"onUpdate:modelValue":i[2]||(i[2]=t=>o(a).description=t),placeholder:e.$t("ai-agent.backend.create.descriptionPlaceholder"),rows:6,ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),d("div",be,[r($,{color:"neutral",variant:"soft",size:"lg",onClick:i[3]||(i[3]=t=>v("close",!1))},{default:l(()=>[_(g(e.$t("console-common.cancel")),1)]),_:1}),r($,{color:"primary",size:"lg",loading:o(j),type:"submit"},{default:l(()=>[_(g(s.id?e.$t("console-common.update"):e.$t("console-common.create")),1)]),_:1},8,["loading"])])]),_:1},8,["schema","state","onSubmit"]))]),_:1},8,["title","description"])}}});export{He as default};
