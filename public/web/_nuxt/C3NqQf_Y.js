import{W as T}from"./BJfIXs0j.js";import{d as V,af as H,l as p,a2 as N,n as P,q as j,J as k,aV as J,p as I,f as U,o as D,w as E,x as $,C as K,a0 as L}from"#entry";import{_ as Q}from"./abPSHzII.js";const X=["width","height"],Y=V({__name:"content",props:{squareSize:{default:4},gridGap:{default:6},flickerChance:{default:.3},color:{default:"rgb(0, 0, 0)"},maxOpacity:{default:.2},class:{default:""},style:{}},setup(A){const g=A,{squareSize:s,gridGap:v,flickerChance:q,color:C,maxOpacity:x}=H(g),f=p(),n=p(),d=p(),z=p(!1),w=N({width:0,height:0});let h=null,m=null,i,R=0;const F=P(()=>{if(!d.value)return"rgba(0, 0, 0,";if(C.value.startsWith("rgb("))return C.value.replace("rgb(","rgba(").replace(")",",");const e=C.value.replace(/^#/,""),t=Number.parseInt(e,16),a=t>>16&255,c=t>>8&255,u=t&255;return`rgba(${a}, ${c}, ${u},`}),o=p();function M(e,t,a){const c=window.devicePixelRatio||1;e.width=t*c,e.height=a*c,e.style.width=`${t}px`,e.style.height=`${a}px`;const u=Math.floor(t/(s.value+v.value)),_=Math.floor(a/(s.value+v.value)),l=new Float32Array(u*_);for(let r=0;r<l.length;r++)l[r]=Math.random()*x.value;return{cols:u,rows:_,squares:l,dpr:c}}function O(e,t){for(let a=0;a<e.length;a++)Math.random()<q.value*t&&(e[a]=Math.random()*x.value)}function B(e,t,a,c,u,_,l){e.clearRect(0,0,t,a),e.fillStyle="transparent",e.fillRect(0,0,t,a);for(let r=0;r<c;r++)for(let y=0;y<u;y++){const G=_[r*u+y];e.fillStyle=`${F.value}${G})`,e.fillRect(r*(s.value+v.value)*l,y*(s.value+v.value)*l,s.value*l,s.value*l)}}function b(){if(!f.value||!n.value)return;const e=f.value.clientWidth,t=f.value.clientHeight;w.width=e,w.height=t,e>0&&t>0&&(o.value=M(n.value,e,t))}function S(e){if(!z.value||!o.value||!d.value||!n.value)return;const t=(e-R)/1e3;R=e,O(o.value.squares,t),B(d.value,n.value.width,n.value.height,o.value.cols,o.value.rows,o.value.squares,o.value.dpr),i=requestAnimationFrame(S)}function W(){i&&cancelAnimationFrame(i),R=performance.now(),i=requestAnimationFrame(S)}return j(()=>{!n.value||!f.value||(d.value=n.value.getContext("2d")||void 0,d.value&&(b(),h=new ResizeObserver(()=>{k(()=>{b()})}),m=new IntersectionObserver(([e])=>{e&&(z.value=e.isIntersecting,e.isIntersecting&&W())},{threshold:0}),h.observe(f.value),m.observe(n.value)))}),J(()=>{i&&(cancelAnimationFrame(i),i=void 0),h&&(h.disconnect(),h=null),m&&(m.disconnect(),m=null)}),I(()=>g.style,()=>{k(()=>{b()})},{deep:!0}),I([s,v,q,x],()=>{k(()=>{b()})}),(e,t)=>(D(),U(T,{style:L(g.style),"override-bg-color":!0,"custom-class":"flickering-grid-content"},{default:E(({style:a})=>[$("div",{ref_key:"containerRef",ref:f,class:K([g.class,"flickering-grid-container"])},[$("canvas",{ref_key:"canvasRef",ref:n,class:"pointer-events-none",width:w.width,height:w.height},null,8,X)],2)]),_:1},8,["style"]))}}),ae=Q(Y,[["__scopeId","data-v-f1e15c21"]]);export{ae as default};
