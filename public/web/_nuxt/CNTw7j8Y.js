const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DgDnhxqP.js","./cd55qm53.js","./Cgyg1gJC.js","./D_3bTjYR.js","./D9sX2Qi6.js","./DQQ3dYHz.js","./Dh3Mo9T6.js","./DNSLGqNg.js","./CuVAPZQ8.js","./BFo3vNrE.js","./sTbVUDyT.js","./CtosDvS0.js","./CAQVAH0V.js","./kRIii9yh.js","./D4e4FYoF.js","./CMKSl-Ng.js","./Deu6qIfg.js","./Z7qkLoXK.js","./hsuWSsy6.js","./DMoqg0Fd.js","./C6Y-ieo6.js","./DeCyaT7k.js","./BCcN9pii.js","./psimjGaX.js","./4jjeIyfe.js","./DD8ySyt7.js","./Ghlq83yM.js","./DQMjdCEn.js","./OUYfsp1i.js","./CjE5iPSn.js","./D9UsdH-b.js","./MCK2d4XT.js","./EK7Wbu3-.js","./DYRztL8i.js","./B6e0YRC4.js","./FTderXKt.js","./DaWZu8wl.js","./CxvgZo8z.js"])))=>i.map(i=>d[i]);
import{d as F,i as O,at as q,k as Q,V as W,aQ as X,s as k,n as G,h as g,q as H,c as J,o as Y,x as m,t as l,bD as Z,g as o,w as u,A as V,z as x,_ as ee,W as te,X as oe}from"#entry";import{_ as ae}from"./Y67jy4iF.js";import{_ as se}from"./DBiaUVBh.js";import le from"./cd55qm53.js";import{_ as ne}from"./CvI6s-qz.js";import{_ as ce}from"./bvMLy1sv.js";import{_ as re}from"./CBTz8tdX.js";import{_ as ie}from"./JxyxsHxp.js";import{_ as me}from"./D4ebF709.js";import{a as de,d as pe,u as ue,b as _e,c as fe,e as ge}from"./DYRztL8i.js";import{b as he}from"./B6e0YRC4.js";import{u as be}from"./ZDOPDbaX.js";import"./CjasYwqF.js";import"./CAQVAH0V.js";import"./DBEJUH-Z.js";import"./CuVAPZQ8.js";import"./CMKSl-Ng.js";import"./BCcN9pii.js";import"./CtosDvS0.js";import"./Deu6qIfg.js";import"./D9sX2Qi6.js";import"./DNSLGqNg.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./Z7qkLoXK.js";import"./BstbYvQo.js";import"./DMoqg0Fd.js";import"./kRIii9yh.js";import"./C6Y-ieo6.js";import"./psimjGaX.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./o0-e7Rye.js";import"./abPSHzII.js";const ye={class:"flex h-full flex-col gap-4"},Se={class:"flex items-center justify-between gap-4"},ve={class:"flex flex-1 items-center gap-2"},ke={class:"flex items-center gap-2"},Ve={class:"flex-1 overflow-y-auto"},xe={class:"bg-background flex items-center justify-end gap-3 py-4"},we={class:"flex items-center gap-1.5"},rt=F({__name:"list",setup(Ue){const w=te(()=>oe(()=>import("./DgDnhxqP.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]),import.meta.url)),{t:a}=O(),_=q(),h=Q("table"),U=W(),b=ae,A=se,d=X({name:"",templateId:"all"}),n=k([]),y=k([]),{paging:r,getLists:c}=be({fetchFun:de,params:d}),C=G(()=>[{id:"select",accessorKey:"select",header:({table:e})=>g(b,{modelValue:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),"onUpdate:modelValue":t=>{e.toggleAllPageRowsSelected(!!t),$(t)},"aria-label":"Select all"}),cell:({row:e})=>g(b,{modelValue:e.getIsSelected(),"onUpdate:modelValue":t=>{e.toggleSelected(!!t),R(e,t)},"aria-label":"Select row"})},{accessorKey:"name",header:a("ai-secret.backend.list.form.name")},{accessorKey:"template",header:a("ai-secret.backend.list.form.keyType"),cell:({row:e})=>e.original.template.name},{accessorKey:"remark",header:a("ai-secret.backend.list.form.remark")},{accessorKey:"status",header:a("console-common.status")},{accessorKey:"createdAt",header:a("console-common.createAt"),cell:({row:e})=>{const t=e.getValue("createdAt");return g(A,{datetime:t,mode:"datetime"})}},{id:"action",accessorKey:"action",header:a("console-common.operation")}]),I=e=>[{label:a("console-common.edit"),icon:"i-lucide-edit",onClick:()=>{S(e.original.id)}},{label:a("console-common.delete"),icon:"i-lucide-trash",color:"error",onSelect(){K(e.original.id)}}],S=e=>{U.create(w).open({id:e,onSubmit:(i,p)=>{B(i,p)}})},D=()=>{S()},K=async e=>{await pe(e),_.success(a("console-common.deleteSuccess")),c()},T=async e=>{if(!e.original.id){console.error("行数据缺少 ID");return}try{await ue(e.original.id,{status:e.original.status}),_.success(e.original.status?a("console-common.enableSuccess"):a("console-common.disableSuccess")),c()}catch(t){console.error("更新状态失败:",t)}},R=(e,t)=>{if(typeof t=="boolean"){const i=e.original.id;t?n.value.push(i):n.value=n.value.filter(p=>p!==i),console.log(n.value)}},$=e=>{typeof e=="boolean"&&(e?n.value=r.items.map(t=>t.id):n.value=[])},P=async()=>{try{await _e(n.value),n.value=[],h.value?.tableApi.toggleAllPageRowsSelected(!1),_.success(a("console-common.batchDeleteSuccess")),c()}catch(e){console.error("批量删除失败:",e)}},B=async(e,t)=>{t?await fe(t,e):await ge(e),_.success(a("ai-secret.backend.list.edit.submitSuccess")),c()},L=async()=>{try{const e=await he();y.value=e}catch(e){console.error("加载模板列表失败:",e)}},z=()=>{c()};return H(()=>{L(),c()}),(e,t)=>{const i=le,p=ne,f=ee,E=ce,M=re,N=ie,j=me;return Y(),J("div",ye,[m("div",Se,[m("div",ve,[l(i,{modelValue:o(d).name,"onUpdate:modelValue":t[0]||(t[0]=s=>o(d).name=s),placeholder:o(a)("ai-secret.backend.list.placeholder"),onKeyup:Z(o(c),["enter"])},null,8,["modelValue","placeholder","onKeyup"]),l(p,{modelValue:o(d).templateId,"onUpdate:modelValue":[t[1]||(t[1]=s=>o(d).templateId=s),z],items:[{label:o(a)("console-common.all"),value:"all"},...o(y).map(s=>({label:s.name,value:s.id}))],"label-key":"label","value-key":"value",placeholder:o(a)("ai-secret.backend.list.form.keyType"),class:"w-48"},null,8,["modelValue","items","placeholder"])]),m("div",ke,[l(f,{icon:"i-tabler-trash",color:"error",variant:"outline",onClick:P},{default:u(()=>[V(x(o(a)("console-common.batchDelete")),1)]),_:1}),l(f,{color:"primary",icon:"i-lucide-plus",onClick:D},{default:u(()=>[V(x(o(a)("ai-secret.backend.list.add")),1)]),_:1})])]),m("div",Ve,[l(N,{ref_key:"table",ref:h,class:"h-full",sticky:"",columns:o(C),data:o(r).items,ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default",tr:"[&:has(>td[colspan])]:hidden"}},{"status-cell":u(({row:s})=>[l(E,{"model-value":!!s.original.status,"onUpdate:modelValue":v=>s.original.status=v?1:0,onChange:v=>T(s)},null,8,["model-value","onUpdate:modelValue","onChange"])]),"action-cell":u(({row:s})=>[l(M,{items:I(s)},{default:u(()=>[l(f,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost"})]),_:1},8,["items"])]),_:1},8,["columns","data"])]),m("div",xe,[m("div",we,[l(j,{page:o(r).page,"onUpdate:page":t[2]||(t[2]=s=>o(r).page=s),size:o(r).pageSize,"onUpdate:size":t[3]||(t[3]=s=>o(r).pageSize=s),total:o(r).total,onChange:o(c)},null,8,["page","size","total","onChange"])])])])}}});export{rt as default};
