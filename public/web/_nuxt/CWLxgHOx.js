import{d as R,i as T,l as U,s as v,a2 as C,k as D,p as N,q as I,f as _,o as r,w as d,c as y,g as t,x as e,t as h,A as w,B as V,z as a,E as j,G as E,y as L,F as q,r as F,D as G}from"#entry";import{_ as O}from"./o4ws_w_T.js";import{_ as P}from"./BPj_g5mx.js";import{_ as H}from"./B8dIIAdq.js";import{_ as J}from"./Cie-o9Wa.js";import{_ as K}from"./Ghlq83yM.js";import{d as Q}from"./B0g9CpkI.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./BFo3vNrE.js";import"./CuVAPZQ8.js";import"./Z7qkLoXK.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";const W={key:0,class:"flex h-48 items-center justify-center"},X={class:"text-muted-foreground flex items-center gap-2 text-sm"},Y={key:1,class:"flex h-48 items-center justify-center"},Z={class:"text-muted-foreground text-center"},ee={class:"mb-3 flex flex-row items-center justify-between text-lg"},te={class:"flex flex-row items-center gap-1.5"},se={class:"font-medium"},oe={class:"text-right"},ae={class:"font-medium"},ne={class:"space-y-1"},re={class:"text-sm"},ie={class:"text-secondary-foreground font-medium"},ce={class:"text-muted"},le={class:"text-sm"},de={class:"text-secondary-foreground font-medium"},me={class:"text-muted"},_e={class:"text-sm"},fe={class:"text-secondary-foreground font-medium"},ue={class:"text-muted"},De=R({__name:"subscription-modal",setup(pe){const{t:i}=T(),f=U(!1),c=v([]),m=v(!1),u=v(!1),p=C({page:1,pageSize:10}),B=D("scrollAreaRef"),g=async(n=!1)=>{n&&(p.page=1,c.value=[]),m.value=!0;try{const o=await Q(p),l=o.items||[];c.value=n?l:[...c.value,...l],u.value=o.total>c.value.length}catch(o){console.error("加载订阅列表失败:",o)}finally{m.value=!1}},S=async()=>{if(!(!u.value||m.value)){p.page++;try{await g(!1)}catch{p.page--,u.value=!0}}},k=(n,o="datetime")=>{if(!n)return"-";const l=new Date(n),x=o==="date"?{year:"numeric",month:"2-digit",day:"2-digit"}:{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"};return l.toLocaleString("zh-CN",x)};return N(()=>f.value,async n=>{n&&await g(!0)}),I(async()=>{await g(!0)}),(n,o)=>{const l=V,x=E,b=O,z=P,A=H,$=J,M=K;return r(),_(M,{open:t(f),"onUpdate:open":o[0]||(o[0]=s=>G(f)?f.value=s:null),title:t(i)("membership.frontend.center.subscriptionManagement"),width:"sm","show-footer":!1,ui:{content:"h-[60vh]"}},{trigger:d(()=>[F(n.$slots,"default")]),default:d(()=>[t(m)&&t(c).length===0?(r(),y("div",W,[e("div",X,[h(l,{name:"i-lucide-loader-2",class:"size-4 animate-spin"}),o[1]||(o[1]=w(" 加载中... ",-1))])])):!t(m)&&t(c).length===0?(r(),y("div",Y,[e("div",Z,[h(l,{name:"i-lucide-inbox",class:"mx-auto mb-2 size-12"}),e("p",null,a(t(i)("membership.frontend.center.noSubscription")),1)])])):(r(),_($,{key:2,class:"w-full",type:"auto",ref_key:"scrollAreaRef",ref:B},{default:d(()=>[h(A,{loading:t(m),"has-more":t(u),threshold:200,"loading-text":"加载中...","no-more-text":"",class:"space-y-3 px-1 py-4",onLoadMore:S},{default:d(()=>[(r(!0),y(q,null,j(t(c),s=>(r(),_(z,{key:s.id,variant:"subtle",class:"rounded-lg"},{default:d(()=>[e("div",ee,[e("div",te,[h(x,{src:s.level?.icon,alt:s.level?.name,size:"lg"},null,8,["src","alt"]),e("span",se,a(s.level?.name||"-"),1)]),e("div",oe,[e("div",ae,a(s.duration||"-"),1),s.isActive?(r(),_(b,{key:0,color:"success",size:"sm"},{default:d(()=>[w(a(t(i)("membership.frontend.center.active")),1)]),_:1})):s.isExpired?(r(),_(b,{key:1,color:"error",size:"sm"},{default:d(()=>[w(a(t(i)("membership.frontend.center.expired")),1)]),_:1})):L("",!0)])]),e("div",ne,[e("div",re,[e("span",ie,a(t(i)("membership.frontend.center.expireTime"))+"： ",1),e("span",ce,a(k(s.endTime,"date")),1)]),e("div",le,[e("span",de,a(t(i)("membership.frontend.center.startTime"))+"： ",1),e("span",me,a(k(s.createdAt)),1)]),e("div",_e,[e("span",fe,a(t(i)("membership.frontend.center.source"))+"： ",1),e("span",ue,a(s.sourceDesc),1)])])]),_:2},1024))),128))]),_:1},8,["loading","has-more"])]),_:1},512))]),_:3},8,["open","title"])}}});export{De as default};
