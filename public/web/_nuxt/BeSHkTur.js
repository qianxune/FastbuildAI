import{_ as B}from"./C_x_FjTj.js";import{_ as L}from"./shdu-Ndv.js";import R from"./cd55qm53.js";import{_ as N}from"./D_3bTjYR.js";import{d as T,at as j,i as A,l as y,a2 as x,aN as S,c as D,o as E,t as o,w as a,x as d,z as r,g as m,A as c,v as H,_ as O,B as W,bV as Y,bW as G}from"#entry";import{_ as J}from"./Iv8N83fp.js";import{_ as K}from"./DD8ySyt7.js";import{S as Q}from"./CHDWwQed.js";import{M as V}from"./u_h4lk84.js";import{c as X,b as f,f as Z}from"./FTderXKt.js";import{s as ee}from"./BzLCLO6P.js";import"./Dh3Mo9T6.js";import"./DNSLGqNg.js";import"./CuVAPZQ8.js";import"./BFo3vNrE.js";import"./sTbVUDyT.js";import"./CtosDvS0.js";import"./CAQVAH0V.js";import"./kRIii9yh.js";import"./D4e4FYoF.js";import"./CMKSl-Ng.js";import"./Deu6qIfg.js";import"./C6Y-ieo6.js";import"./D9sX2Qi6.js";import"./BaSWMwLN.js";import"./DrNYMppE.js";/* empty css        */import"./abPSHzII.js";import"./B-cZF5FC.js";import"./DaWZu8wl.js";const oe={class:"px-8 pt-8"},te={class:"mb-2 text-2xl font-bold"},se={class:"text-muted-foreground mb-4 text-sm"},ae={class:"flex items-center gap-1 text-xs"},ie={class:"flex items-center gap-1 text-xs"},le={class:"flex flex-1 gap-2 py-8"},Ne=T({__name:"forget",emits:["switchComponent"],setup(ne,{emit:C}){const P=C,u=j(),{t}=A(),_=y([{value:t("console-common.phoneAreaCodes.china"),label:"86"}]),w=y(_.value[0]),k=X({mobile:f().required(t("login.forget.validation.mobileRequired")).matches(/^1[3-9]\d{9}$/,t("login.forget.validation.mobileInvalid")),code:f().required(t("login.forget.validation.codeRequired")),password:f().required(t("login.forget.validation.passwordRequired")).min(6,t("login.forget.validation.passwordMinLength")).max(25,t("login.forget.validation.passwordMaxLength")).matches(/^(?=.*[a-z])(?=.*[0-9!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?])/,t("login.forget.validation.passwordFormat")),password_confirm:f().required(t("login.forget.validation.confirmPasswordRequired")).oneOf([Z("password")],t("login.forget.validation.passwordMismatch"))}),l=x({mobile:"",code:"",password:"",password_confirm:""}),n=x({isCounting:!1,text:t("login.forget.getCode")}),{lockFn:q,isLock:U}=S(async()=>{if(n.isCounting!==!0){n.text=t("login.forget.sending");try{await Y({scene:Q.FIND_PASSWORD,mobile:l.mobile}),n.isCounting=!0;let e=60;n.text=`${e}s`;const s=ee(()=>{e--,n.text=`${e}s`,e===0&&(clearInterval(s),n.isCounting=!1,n.text=t("login.forget.resend"))},1e3);u.success(t("login.forget.messages.sendSuccess"),{title:t("login.forget.messages.sendSuccessTitle"),duration:3e3})}catch(e){console.error("Send verification code failed:",e),n.isCounting=!1,n.text=t("login.forget.resend"),u.error(t("login.forget.messages.sendFailed"),{title:t("login.forget.messages.sendFailedTitle"),duration:3e3})}}}),{lockFn:z,isLock:F}=S(async()=>{try{await G(l)}catch(e){console.log("Reset password failed =>",e)}});return(e,s)=>{const I=B,b=L,v=R,p=N,g=O,$=J,h=W,M=K;return E(),D("div",oe,[o(m(V),{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"tween",stiffness:300,damping:30,delay:.2},class:"relative"},{default:a(()=>[d("h2",te,r(e.$t("login.forget.title")),1),d("p",se,r(e.$t("login.forget.subtitle")),1)]),_:1}),o(m(V),{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{type:"tween",stiffness:300,damping:30,delay:.4},class:"relative"},{default:a(()=>[o(M,{schema:m(k),state:l,onSubmit:m(z)},{default:a(()=>[o(p,{label:e.$t("login.forget.mobile"),name:"mobile",required:""},{default:a(()=>[o(v,{modelValue:l.mobile,"onUpdate:modelValue":s[2]||(s[2]=i=>l.mobile=i),class:"w-full",size:"lg",placeholder:e.$t("login.forget.mobilePlaceholder"),autocomplete:"off",ui:{base:"!pl-24"}},{leading:a(()=>[d("div",{class:"flex items-center text-sm",onClick:s[1]||(s[1]=H(()=>{},["stop","prevent"]))},[s[7]||(s[7]=d("span",{class:"mr-px pb-px"},"+",-1)),o(I,{modelValue:w.value,"onUpdate:modelValue":s[0]||(s[0]=i=>w.value=i),"trailing-icon":"heroicons:chevron-up-down-20-solid",ui:{base:"!ring-0",content:"z-999 w-34"},class:"w-16",items:_.value},{item:a(({item:i})=>[c(r(i.value)+" +"+r(i.label),1)]),_:1},8,["modelValue","items"])]),o(b,{class:"h-1/2",orientation:"vertical"})]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(p,{label:e.$t("login.forget.code"),name:"code",class:"mt-2",required:""},{default:a(()=>[o(v,{id:"code",modelValue:l.code,"onUpdate:modelValue":s[3]||(s[3]=i=>l.code=i),size:"lg",placeholder:e.$t("login.forget.codePlaceholder"),autocomplete:"off",ui:{root:"w-full",trailing:"pr-0"}},{trailing:a(()=>[o(b,{class:"h-1/2",orientation:"vertical"}),o(g,{variant:"link",ui:{base:"w-[90px] justify-center"},disabled:m(U),onClick:m(q)},{default:a(()=>[c(r(n.text),1)]),_:1},8,["disabled","onClick"])]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),o(p,{label:e.$t("login.forget.newPassword"),name:"password",class:"mt-3",required:""},{help:a(()=>[d("div",ae,[o(h,{name:"tabler:alert-circle",size:"14"}),c(" "+r(e.$t("login.forget.passwordHint")),1)])]),default:a(()=>[o($,{modelValue:l.password,"onUpdate:modelValue":s[4]||(s[4]=i=>l.password=i),class:"w-full",type:"password",size:"lg",placeholder:e.$t("login.forget.newPasswordPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(p,{label:e.$t("login.forget.confirmPassword"),name:"password_confirm",class:"mt-3",required:""},{help:a(()=>[d("div",ie,[o(h,{name:"tabler:alert-circle",size:"14"}),c(" "+r(e.$t("login.forget.passwordHint")),1)])]),default:a(()=>[o($,{modelValue:l.password_confirm,"onUpdate:modelValue":s[5]||(s[5]=i=>l.password_confirm=i),class:"w-full",type:"password",size:"lg",placeholder:e.$t("login.forget.confirmPasswordPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),d("div",le,[o(g,{variant:"outline",color:"primary",size:"lg",ui:{base:"flex-1 justify-center"},onClick:s[6]||(s[6]=i=>P("switchComponent","account-login"))},{default:a(()=>[c(r(e.$t("login.forget.backToLogin")),1)]),_:1}),o(g,{color:"primary",type:"submit",size:"lg",ui:{base:"flex-1 justify-center"},loading:m(F)},{default:a(()=>[c(r(e.$t("login.forget.confirmChange")),1)]),_:1},8,["loading"])])]),_:1},8,["schema","state","onSubmit"])]),_:1})])}}});export{Ne as default};
