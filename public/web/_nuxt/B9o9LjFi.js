import{u as J,_ as K}from"./CHPFZ4-8.js";import{_ as H}from"./DOOZ3wAl.js";import{_ as W}from"./DhnBxkbb.js";import{d as X,a_ as Y,i as Z,n as C,s as u,b2 as tt,q as et,c as S,x as s,t as I,C as T,g as t,y as d,z as a,w as N,D as j,F as ot,E as st,f as b,G as it,b3 as rt,o as l,_ as nt,v as at,A as F,j as lt,at as ct,aO as pt,ar as mt}from"#entry";import{_ as ut}from"./CiVwig2f.js";import{d as dt,e as ft,f as ht}from"./D7VOTB3C.js";import{u as _t}from"./fhkze2Jn.js";import"./cd55qm53.js";import"./D_3bTjYR.js";import"./D9sX2Qi6.js";import"./CBTz8tdX.js";import"./DMoqg0Fd.js";import"./CtosDvS0.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./CuVAPZQ8.js";import"./psimjGaX.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./CWpJD8K1.js";import"./Cie-o9Wa.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./CzL0xTzV.js";import"./OUYfsp1i.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./QEC2sJuf.js";import"./CSy6ZCzT.js";import"./MCK2d4XT.js";import"./o4ws_w_T.js";import"./DbqqhwXM.js";import"./Cub7JM7Q.js";import"./hsuWSsy6.js";import"./B0g9CpkI.js";import"./DO9M7gn1.js";import"./DBEJUH-Z.js";import"./Dgxt_juz.js";import"./5wIHoxV5.js";import"./RPflLnqr.js";import"./TrJvDfxI.js";import"./4jjeIyfe.js";import"./shdu-Ndv.js";import"./9Q2Y_nd6.js";import"./td2xDKru.js";import"./CRu9at2N.js";const gt={class:"ai-chat dark:bg-muted/50 flex h-full min-h-0 items-center justify-center pl-0"},yt={class:"bg-background flex h-full min-h-0 flex-1 flex-col items-center justify-center rounded-lg"},vt={class:"flex h-full w-full max-w-[800px] flex-col items-center justify-center"},xt={class:"mb-8 text-center"},Ct={class:"mb-2 flex items-center justify-center text-2xl font-bold"},St={class:"text-accent-foreground text-sm"},It={class:"w-full px-4"},bt={key:0,class:"my-4 flex w-full flex-wrap justify-center gap-3"},wt={class:"mr-1"},kt={class:"w-full p-2 text-center text-xs text-gray-400"},Mt={class:"flex flex-col items-center justify-center gap-1"},Vt={class:"flex items-center justify-center gap-2"},Ut=["href"],At={key:0},Nt={class:"space-x-1"},jt=["href"],Le=X({__name:"index",async setup(zt){let f,z;const i=Y(),{t:$}=Z(),w=_t(),D=J(),p=C(()=>w.selectedModel?.id||""),k=u(""),r=u([]),h=u(!1),c=u(),_=u(),g=u([]),{data:y}=([f,z]=tt(()=>rt("chat-config",()=>ft())),f=await f,z(),f),E=C(()=>y.value?.suggestionsEnabled??!0),Q=C(()=>y.value?.suggestions||[]),M=C(()=>y.value?.welcomeInfo||{});function P(e){g.value=e}function V(){try{const e=JSON.parse(localStorage.getItem("mcpIds")||"[]");return Array.isArray(e)?e:[]}catch{return[]}}function L(e){e.length?localStorage.setItem("mcpIds",JSON.stringify(e)):localStorage.removeItem("mcpIds")}const q=async()=>{try{const e=await dt();if(!e)return;c.value=e,_.value=e.id,h.value=V().includes(_.value||"")}catch(e){console.error("Failed to fetch quick menu:",e)}};async function B(e){try{if(!p.value&&lt().isLogin){ct().warning($("ai-chat.frontend.selectModel"));return}const o=await ht({title:""});D.setPendingConversation({id:o.id,modelId:p.value,title:e,files:g.value.length>0?g.value:void 0}),pt("chats"),await mt({path:`/chat/${o.id}`})}catch(o){console.error("Failed to create conversation:",o)}}const G=()=>{if(!_.value)return;Array.isArray(r.value)||(r.value=[]);const e=V(),o=_.value,U=e.includes(o),v=r.value.includes(o);if(!U&&!v)e.push(o),v||r.value.push(o),L(e);else{const A=e.filter(m=>m!==o),x=r.value.filter(m=>m!==o);L(A),r.value=x}h.value=V().includes(o)};return et(()=>{q()}),(e,o)=>{const U=K,v=H,A=W,x=it,m=nt,O=ut;return l(),S("div",gt,[s("div",{class:T(["border-border/50 h-full flex-none border-r pl-0",{"border-none":!t(w).chatSidebarVisible}])},[I(U)],2),s("div",yt,[s("div",vt,[s("div",xt,[s("h1",Ct,a(t(M).title),1),s("p",St,a(t(M).description),1)]),s("div",It,[I(O,{class:"[view-transition-name:chat-prompt]",modelValue:t(k),"onUpdate:modelValue":o[2]||(o[2]=n=>j(k)?k.value=n:null),"file-list":t(g),rows:2,needAuth:!0,attachmentSizeLimit:t(y)?.attachmentSizeLimit,onSubmit:B,"onUpdate:fileList":P},{"panel-left":N(()=>[I(v,{modelValue:t(p),"onUpdate:modelValue":o[0]||(o[0]=n=>j(p)?p.value=n:null),modelId:t(p)||"",supportedModelTypes:["llm"],"show-billingRule":!0,"open-local-storage":!0,placeholder:"选择AI模型开始对话",onChange:t(w).setSelectedModel},null,8,["modelValue","modelId","onChange"]),I(A,{modelValue:t(r),"onUpdate:modelValue":o[1]||(o[1]=n=>j(r)?r.value=n:null),mcpIds:t(r)||[],placeholder:"选择MCP..."},null,8,["modelValue","mcpIds"]),t(c)?(l(),b(m,{key:0,color:t(h)?"primary":"neutral",variant:"ghost",icon:t(c)?.icon?"":"tabler:tool",ui:{leadingIcon:"size-4"},class:T({"bg-primary/10":t(h)}),onClick:at(G,["stop"])},{default:N(()=>[t(c)?.icon?(l(),b(x,{key:0,src:t(c)?.icon,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),F(" "+a(t(c)?.alias||t(c)?.name),1)]),_:1},8,["color","icon","class"])):d("",!0)]),_:1},8,["modelValue","file-list","attachmentSizeLimit"])]),t(E)?(l(),S("div",bt,[(l(!0),S(ot,null,st(t(Q),(n,R)=>(l(),b(m,{key:R,variant:"outline",color:"neutral",size:"md",onClick:Lt=>B(n.text)},{default:N(()=>[s("span",wt,a(n.icon),1),F(" "+a(n.text),1)]),_:2},1032,["onClick"]))),128))])):d("",!0)]),s("div",kt,[s("div",Mt,[s("span",null,a(t(M).footer),1),s("div",Vt,[s("a",{href:t(i).siteConfig?.copyright.url,target:"_blank",rel:"noopener noreferrer",class:"hover:text-primary flex items-center justify-center gap-1 transition-colors"},[t(i).siteConfig?.copyright.iconUrl?(l(),b(x,{key:0,src:t(i).siteConfig?.copyright.iconUrl,ui:{root:"size-4 rounded-md"}},null,8,["src"])):d("",!0),s("span",null,a(t(i).siteConfig?.copyright.displayName),1)],8,Ut),(t(i).siteConfig?.copyright.displayName||t(i).siteConfig?.copyright.iconUrl)&&(t(i).siteConfig?.copyright.copyrightText||t(i).siteConfig?.copyright.copyrightBrand)?(l(),S("span",At,"|")):d("",!0),s("span",Nt,[s("span",null,a(t(i).siteConfig?.copyright.copyrightText),1),s("a",{class:"text-primary font-bold",href:t(i).siteConfig?.copyright.copyrightUrl,target:"_blank"},a(t(i).siteConfig?.copyright.copyrightBrand),9,jt)])])])])])])}}});export{Le as default};
