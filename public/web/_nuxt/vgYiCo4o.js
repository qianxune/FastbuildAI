import{d as W,i as Z,s as $,l as G,c as y,o as u,x as r,t as o,A as b,z as m,w as i,B as H,_ as K,F as Q,E as X,y as h,aZ as Y,f as U,g as n,aW as ee,D as oe,at as ae}from"#entry";import{_ as te}from"./DbqqhwXM.js";import{_ as ne}from"./o4ws_w_T.js";import{_ as le}from"./Da83zglB.js";import{_ as ie}from"./D_3bTjYR.js";import re from"./cd55qm53.js";import me from"./4jjeIyfe.js";import{_ as se}from"./Y67jy4iF.js";import{_ as ce}from"./BFbGFa2O.js";import{_ as de}from"./DD8ySyt7.js";import{_ as ue}from"./Ghlq83yM.js";import{c as pe,b as C}from"./FTderXKt.js";import"./DNSLGqNg.js";import"./psimjGaX.js";import"./CuVAPZQ8.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./9Q2Y_nd6.js";import"./td2xDKru.js";import"./RPflLnqr.js";import"./TrJvDfxI.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./D9sX2Qi6.js";import"./CjasYwqF.js";import"./CAQVAH0V.js";import"./DBEJUH-Z.js";import"./CMKSl-Ng.js";import"./BCcN9pii.js";import"./CtosDvS0.js";import"./Deu6qIfg.js";import"./CBTz8tdX.js";import"./DMoqg0Fd.js";import"./kRIii9yh.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BjKIBNOf.js";import"./BMSQkwth.js";import"./DaWZu8wl.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";const fe={class:"bg-muted rounded-lg p-3"},ge={class:"flex items-center justify-between"},_e={class:"text-foreground flex items-center gap-1 text-sm font-medium"},ve={class:"text-background text-xs"},ye={class:"space-y-3"},be={class:"flex flex-1 items-center gap-2"},ke={key:0,class:"bg-primary-50 border-default flex rounded-lg border border-dashed"},$e={class:"text-muted-foreground font-mono text-xs"},he={class:"block group-hover:hidden"},Ce={class:"hidden items-center group-hover:flex"},Ve={class:"flex items-center gap-2"},Te={class:"mt-6 flex justify-end gap-2"},ho=W({__name:"command",props:{modelValue:{}},emits:["update:modelValue"],setup(w,{emit:N}){const s=ee(w,"modelValue",N),{t:p}=Z(),c=$(!1),f=$(!1),d=$(-1),B=pe({name:C().required(p("ai-agent.backend.configuration.commandNameEmpty")),content:C().required(p("ai-agent.backend.configuration.commandContentEmpty")),replyType:C().required(p("ai-agent.backend.configuration.commandReplyTypeEmpty"))}),V={avatar:"",name:"",content:"",replyType:"model",replyContent:""},a=G({...V}),E=async()=>{try{if(s.value.find((t,v)=>t.name===a.value.name&&v!==d.value)){ae().error(p("ai-agent.backend.configuration.formVariableNameExists"));return}f.value&&d.value>=0?s.value[d.value]=a.value:s.value.push(a.value),k()}catch(e){console.error("操作失败:",e)}},F=()=>{f.value=!1,d.value=-1,c.value=!0},R=e=>{f.value=!0,d.value=e;const t=s.value[e];t&&(a.value=JSON.parse(JSON.stringify(t)),c.value=!0)},z=()=>{a.value=V},k=()=>{c.value=!1,f.value=!1,d.value=-1,z()},q=e=>{s.value.splice(e,1)};return(e,t)=>{const v=H,M=te,g=K,S=Y,I=ne,j=le,_=ie,D=re,O=me,T=se,A=ce,J=de,P=ue;return u(),y("div",null,[r("div",fe,[r("div",ge,[r("div",_e,[b(m(e.$t("ai-agent.backend.configuration.command"))+" ",1),o(M,{"delay-duration":0,ui:{content:"w-xs h-auto"}},{content:i(()=>[r("div",ve,m(e.$t("ai-agent.backend.configuration.commandDesc")),1)]),default:i(()=>[o(v,{name:"i-lucide-circle-help"})]),_:1})]),o(g,{size:"sm",color:"primary",variant:"ghost",class:"flex items-center",onClick:F},{default:i(()=>[o(v,{name:"i-lucide-plus"}),r("span",null,m(e.$t("console-common.add")),1)]),_:1})]),r("div",ye,[(u(!0),y(Q,null,X(n(s),(l,x)=>(u(),y("div",{key:l.name,class:"group bg-background mt-2 flex items-center gap-2 rounded-lg px-3 py-2"},[r("div",be,[l.avatar?(u(),y("div",ke,[o(S,{src:l?.avatar,alt:"avatar",class:"size-8 rounded-lg object-contain"},null,8,["src"])])):h("",!0),r("span",$e,m(l.name),1)]),r("div",he,[l.replyType?(u(),U(I,{key:0,color:"neutral",variant:"outline",size:"sm"},{default:i(()=>[b(m(l.replyType==="custom"?e.$t("ai-agent.backend.configuration.commandReplyTypeCustom"):e.$t("ai-agent.backend.configuration.commandReplyTypeModel")),1)]),_:2},1024)):h("",!0)]),r("div",Ce,[o(g,{size:"xs",color:"primary",variant:"ghost",icon:"i-lucide-edit",onClick:L=>R(x)},null,8,["onClick"]),o(g,{size:"xs",color:"error",variant:"ghost",icon:"i-lucide-trash",onClick:L=>q(x)},null,8,["onClick"])])]))),128))])]),o(P,{open:n(c),"onUpdate:open":t[6]||(t[6]=l=>oe(c)?c.value=l:null),title:n(f)?e.$t("ai-agent.backend.configuration.commandEditTitle"):e.$t("ai-agent.backend.configuration.commandAddTitle"),description:n(p)("ai-agent.backend.configuration.commandDesc"),ui:{content:"max-w-md"},onClose:k},{default:i(()=>[o(J,{state:n(a),schema:n(B),class:"space-y-4",onSubmit:E},{default:i(()=>[o(_,{label:e.$t("ai-agent.backend.configuration.commandUploadIcon"),name:"avatar"},{default:i(()=>[o(j,{modelValue:n(a).avatar,"onUpdate:modelValue":t[0]||(t[0]=l=>n(a).avatar=l),class:"h-16 w-16",text:" ",icon:"i-lucide-upload",accept:".jpg,.png,.jpeg,.gif,.webp",maxCount:1,single:!0,multiple:!1},null,8,["modelValue"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandName"),name:"name",required:""},{default:i(()=>[o(D,{modelValue:n(a).name,"onUpdate:modelValue":t[1]||(t[1]=l=>n(a).name=l),placeholder:e.$t("ai-agent.backend.configuration.commandNamePlaceholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandContent"),name:"content",required:""},{default:i(()=>[o(O,{modelValue:n(a).content,"onUpdate:modelValue":t[2]||(t[2]=l=>n(a).content=l),placeholder:e.$t("ai-agent.backend.configuration.commandContentPlaceholder"),ui:{root:"w-full"},rows:3},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),o(_,{label:e.$t("ai-agent.backend.configuration.commandReplyType"),name:"type",required:""},{default:i(()=>[r("div",Ve,[o(T,{"model-value":n(a).replyType==="custom",indicator:"end",variant:"card","default-value":"",label:e.$t("ai-agent.backend.configuration.commandReplyTypeCustom"),"onUpdate:modelValue":t[3]||(t[3]=l=>n(a).replyType="custom")},null,8,["model-value","label"]),o(T,{"model-value":n(a).replyType==="model",indicator:"end",variant:"card","default-value":"",label:e.$t("ai-agent.backend.configuration.commandReplyTypeModel"),"onUpdate:modelValue":t[4]||(t[4]=l=>n(a).replyType="model")},null,8,["model-value","label"])])]),_:1},8,["label"]),n(a).replyType==="custom"?(u(),U(_,{key:0,label:e.$t("ai-agent.backend.configuration.commandReplyContent"),name:"replyContent",required:""},{default:i(()=>[o(A,{modelValue:n(a).replyContent,"onUpdate:modelValue":t[5]||(t[5]=l=>n(a).replyContent=l),outputFormat:"markdown","custom-class":"!h-auto min-h-50"},null,8,["modelValue"])]),_:1},8,["label"])):h("",!0),r("div",Te,[o(g,{color:"neutral",variant:"soft",size:"lg",onClick:k},{default:i(()=>[b(m(e.$t("console-common.cancel")),1)]),_:1}),o(g,{color:"primary",size:"lg",type:"submit"},{default:i(()=>[b(m(e.$t("console-common.save")),1)]),_:1})])]),_:1},8,["state","schema"])]),_:1},8,["open","title","description"])])}}});export{ho as default};
