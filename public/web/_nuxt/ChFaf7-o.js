import{_ as H}from"./B4OpYolY.js";import{d as R,aM as V,n as g,i as G,b7 as E,b6 as W,s as U,a2 as q,q as F,c as k,o as _,x as e,t as s,z as a,g as t,B as J,w as m,f as y,y as w,A as K,_ as Q}from"#entry";import{_ as X}from"./DBiaUVBh.js";import{_ as Y}from"./shdu-Ndv.js";import{_ as Z}from"./BPj_g5mx.js";import{_ as ee}from"./DBaba_Ev.js";import{_ as te}from"./Cie-o9Wa.js";import{f as D}from"./DUoaAyrs.js";import{h as se}from"./Dm8J87dm.js";import{g as j}from"./CVgfx1_c.js";import"./cd55qm53.js";import"./C5Ha_WGa.js";import"./DMoqg0Fd.js";import"./CtosDvS0.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./CuVAPZQ8.js";import"./psimjGaX.js";import"./hsuWSsy6.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./jsPNKUA0.js";import"./TrJvDfxI.js";import"./abPSHzII.js";const ae={class:"flex h-full w-full flex-col"},oe={class:"flex flex-col gap-4 p-4 lg:flex-row lg:items-center lg:justify-between"},ne={class:"text-foreground text-2xl font-bold"},ie={class:"text-muted-foreground mt-1"},de={key:0,class:"flex h-full flex-col items-center justify-center"},le={class:"text-muted-foreground ml-2"},re={key:1,class:"m-px flex h-full flex-col space-y-6 overflow-y-auto"},ce={class:"p-px pb-4"},me={class:"mb-4 grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"},ue={class:"mb-1 flex items-center font-medium"},fe={class:"text-muted-foreground mb-1 flex items-center gap-1"},_e={class:"flex items-center justify-between"},xe={class:"flex items-center gap-4"},pe={class:"text-2xl font-bold"},he={class:"text-muted-foreground ml-1 text-xs"},ge={class:"text-muted-foreground text-xs"},be={class:"text-2xl font-bold"},ve={class:"text-muted-foreground ml-1 text-xs"},ke={class:"text-muted-foreground text-xs"},ye={class:"text-muted-foreground flex flex-col items-center justify-center"},we={class:"text-xs"},De={class:"mb-1 flex items-center font-medium"},Ce={class:"text-muted-foreground mb-1 flex items-center gap-1"},Se={class:"flex items-center justify-between"},ze={class:"flex items-center gap-4"},Ae={class:"text-2xl font-bold"},Ne={class:"text-muted-foreground ml-1 text-xs"},je={class:"text-muted-foreground text-xs"},Ue={class:"text-2xl font-bold"},Be={class:"text-muted-foreground ml-1 text-xs"},Ie={class:"text-muted-foreground text-xs"},Oe={class:"text-muted-foreground flex flex-col items-center justify-center"},Pe={class:"text-xs"},Me={class:"mb-1 flex items-center font-medium"},$e={class:"text-muted-foreground mb-1 flex items-center gap-1"},Le={class:"flex items-center justify-between"},Te={class:"flex items-center gap-4"},He={class:"text-2xl font-bold"},Re={class:"text-muted-foreground ml-1 text-xs"},Ve={class:"text-muted-foreground text-xs"},Ge={class:"text-2xl font-bold"},Ee={class:"text-muted-foreground ml-1 text-xs"},We={class:"text-muted-foreground text-xs"},qe={class:"text-muted-foreground flex flex-col items-center justify-center"},Fe={class:"text-xs"},Je={class:"grid grid-cols-1 gap-4 lg:grid-cols-2"},Ke={class:"flex items-center justify-between"},Qe={class:"text-lg font-medium"},Xe={class:"text-muted-foreground mb-1 flex items-center gap-1"},Ye={class:"h-80"},Ze={class:"flex items-center justify-between"},et={class:"text-lg font-medium"},tt={class:"text-muted-foreground mb-1 flex items-center gap-1"},st={class:"h-80"},at={class:"flex items-center justify-between"},ot={class:"text-lg font-medium"},nt={class:"text-muted-foreground mb-1 flex items-center gap-1"},it={class:"h-80"},dt={class:"flex items-center justify-between"},lt={class:"text-lg font-medium"},rt={class:"text-muted-foreground mb-1 flex items-center gap-1"},ct={class:"h-80"},mt={key:2,class:"py-12 text-center"},ut={class:"text-muted-foreground"},Wt=R({__name:"dashboard",setup(ft){const B=V(),I=g(()=>B.params.id),{t:o}=G(),C=E(),p=W(),d=U(null),S=U(!0),n=q({startDate:"",endDate:""}),z=g(()=>j(C.ui.colors.primary,500)),O=g(()=>j(C.ui.colors.success,500)),P=g(()=>j(C.ui.colors.warning,500)),A=async()=>{try{S.value=!0,d.value=await se(I.value,n)}catch(i){console.error("获取统计数据失败:",i),d.value=null}finally{S.value=!1}},M=()=>{if(n.startDate){const i=new Date(n.startDate);i.setHours(0,0,0,0),n.startDate=i.toISOString()}if(n.endDate){const i=new Date(n.endDate);i.setHours(23,59,59,999),n.endDate=i.toISOString()}A()},$=()=>({tooltip:{trigger:"axis",backgroundColor:p.value==="dark"?"#1f2937":"#ffffff",borderColor:p.value==="dark"?"#374151":"#e5e7eb",textStyle:{color:p.value==="dark"?"#f9fafb":"#111827"}},grid:{top:30,left:20,right:20,bottom:20,containLabel:!0},xAxis:{type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:p.value==="dark"?"#374151":"#d1d5db"}},axisLabel:{color:p.value==="dark"?"#9ca3af":"#6b7280",fontSize:12},splitLine:{show:!1}},yAxis:{type:"value",splitLine:{lineStyle:{color:p.value==="dark"?"#374151":"#f3f4f6",type:"dashed"}},axisLine:{show:!1},axisLabel:{show:!1}}}),b=(i,l,u,r="line")=>{const c=$(),h=l.map(f=>{const x=new Date(f.date);return`${x.getMonth()+1}/${x.getDate()}`});return{...c,xAxis:{...c.xAxis,data:h,boundaryGap:r==="bar"},yAxis:r==="bar"?{...c.yAxis,name:"用户数"}:c.yAxis,series:[{name:i,type:r,data:l.map(f=>f.count),...r==="line"?{smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{width:4,color:u},itemStyle:{color:u,borderWidth:2,borderColor:"#fff"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:u},{offset:1,color:u}]},opacity:.1},emphasis:{itemStyle:{color:u},lineStyle:{color:u},areaStyle:{color:u}}}:{barWidth:"50%",showBackground:!0,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderRadius:[4,4,0,0]},itemStyle:{borderRadius:[4,4,0,0],color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:u},{offset:1,color:u}]}},emphasis:{itemStyle:{color:z.value}}}}]}},v=g(()=>d.value?.trends?{consumedPower:b(o("ai-agent.backend.dashboard.consumedPower"),d.value.trends.consumedPower,z.value),messages:b(o("ai-agent.backend.dashboard.messages"),d.value.trends.messages,O.value),tokens:b(o("ai-agent.backend.dashboard.tokens"),d.value.trends.tokens,P.value),activeUsers:b(o("ai-agent.backend.dashboard.activeUsers"),d.value.trends.activeUsers,z.value,"bar")}:{});return F(()=>{const i=new Date,l=new Date(i.getTime()-8640*60*1e3);l.setHours(0,0,0,0);const u=new Date(i);u.setHours(23,59,59,999),n.startDate=l.toISOString(),n.endDate=u.toISOString(),A()}),(i,l)=>{const u=H,r=J,c=X,h=Y,f=Z,x=ee,L=te,T=Q;return _(),k("div",ae,[e("div",oe,[e("div",null,[e("h1",ne,a(t(o)("ai-agent.backend.dashboard.title")),1),e("p",ie,a(t(o)("ai-agent.backend.dashboard.desc")),1)]),s(u,{start:t(n).startDate,"onUpdate:start":l[0]||(l[0]=N=>t(n).startDate=N),end:t(n).endDate,"onUpdate:end":l[1]||(l[1]=N=>t(n).endDate=N),"show-time":!1,ui:{root:"w-auto sm:w-xs"},onChange:M},null,8,["start","end"])]),t(S)?(_(),k("div",de,[s(r,{name:"i-lucide-loader-2",class:"text-primary h-6 w-6 animate-spin"}),e("span",le,a(t(o)("ai-agent.backend.dashboard.loading")),1)])):t(d)?(_(),k("div",re,[s(L,{class:"table h-full px-4",shadow:!1},{default:m(()=>[e("div",ce,[e("div",me,[s(f,null,{header:m(()=>[e("div",ue,a(t(o)("ai-agent.backend.dashboard.conversationStatistics")),1),e("div",fe,[s(r,{name:"i-lucide-info",class:"size-3"}),s(c,{datetime:new Date().toISOString(),mode:"datetime",class:"text-xs"},null,8,["datetime"])])]),default:m(()=>[e("div",_e,[e("div",xe,[e("div",null,[e("div",null,[e("span",pe,a(("formatCompactNumber"in i?i.formatCompactNumber:t(D))(t(d).overview.totalConversations)),1),e("span",he,a(t(o)("ai-agent.backend.dashboard.times")),1)]),e("div",ge,a(t(o)("ai-agent.backend.dashboard.totalConversations")),1)]),s(h,{orientation:"vertical",class:"h-6"}),e("div",null,[e("div",null,[e("span",be,a(("formatCompactNumber"in i?i.formatCompactNumber:t(D))(t(d).overview.totalMessages)),1),e("span",ve,a(t(o)("ai-agent.backend.dashboard.messages")),1)]),e("div",ke,a(t(o)("ai-agent.backend.dashboard.totalMessages")),1)])]),e("div",ye,[s(r,{name:"i-lucide-message-circle",class:"text-primary size-7"}),e("span",we,a(t(o)("ai-agent.backend.dashboard.conversationData")),1)])])]),_:1}),s(f,null,{header:m(()=>[e("div",De,a(t(o)("ai-agent.backend.dashboard.tokenConsumption")),1),e("div",Ce,[s(r,{name:"i-lucide-info",class:"size-3"}),s(c,{datetime:new Date().toISOString(),mode:"datetime",class:"text-xs"},null,8,["datetime"])])]),default:m(()=>[e("div",Se,[e("div",ze,[e("div",null,[e("div",null,[e("span",Ae,a(("formatCompactNumber"in i?i.formatCompactNumber:t(D))(t(d).overview.totalConsumedPower)),1),e("span",Ne,a(t(o)("ai-agent.backend.dashboard.power")),1)]),e("div",je,a(t(o)("ai-agent.backend.dashboard.totalConsumedPower")),1)]),s(h,{orientation:"vertical",class:"h-6"}),e("div",null,[e("div",null,[e("span",Ue,a(("formatCompactNumber"in i?i.formatCompactNumber:t(D))(t(d).overview.totalTokens)),1),e("span",Be,a(t(o)("ai-agent.backend.dashboard.tokens")),1)]),e("div",Ie,a(t(o)("ai-agent.backend.dashboard.totalTokenConsumption")),1)])]),e("div",Oe,[s(r,{name:"i-lucide-zap",class:"text-primary size-7"}),e("span",Pe,a(t(o)("ai-agent.backend.dashboard.consumptionStatistics")),1)])])]),_:1}),s(f,null,{header:m(()=>[e("div",Me,a(t(o)("ai-agent.backend.dashboard.annotationManagement")),1),e("div",$e,[s(r,{name:"i-lucide-info",class:"size-3"}),s(c,{datetime:new Date().toISOString(),mode:"datetime",class:"text-xs"},null,8,["datetime"])])]),default:m(()=>[e("div",Le,[e("div",Te,[e("div",null,[e("div",null,[e("span",He,a(t(d).overview.totalAnnotations),1),e("span",Re,a(t(o)("ai-agent.backend.dashboard.annotations")),1)]),e("div",Ve,a(t(o)("ai-agent.backend.dashboard.totalAnnotations")),1)]),s(h,{orientation:"vertical",class:"h-6"}),e("div",null,[e("div",null,[e("span",Ge,a(t(d).overview.annotationHitCount),1),e("span",Ee,a(t(o)("ai-agent.backend.dashboard.annotations")),1)]),e("div",We,a(t(o)("ai-agent.backend.dashboard.annotationHits")),1)])]),e("div",qe,[s(r,{name:"i-lucide-bookmark",class:"text-primary size-7"}),e("span",Fe,a(t(o)("ai-agent.backend.dashboard.annotationData")),1)])])]),_:1})]),e("div",Je,[s(f,null,{header:m(()=>[e("div",Ke,[e("h3",Qe,a(t(o)("ai-agent.backend.dashboard.consumedPowerTrend")),1)]),e("div",Xe,[s(r,{name:"i-lucide-info",class:"size-3"}),s(c,{datetime:t(n).startDate,mode:"datetime",class:"text-xs"},null,8,["datetime"]),l[2]||(l[2]=e("span",null,"~",-1)),s(c,{datetime:t(n).endDate,mode:"datetime",class:"text-xs"},null,8,["datetime"])])]),default:m(()=>[e("div",Ye,[t(d)?.trends?.consumedPower?(_(),y(x,{key:0,options:t(v).consumedPower,height:"100%"},null,8,["options"])):w("",!0)])]),_:1}),s(f,null,{header:m(()=>[e("div",Ze,[e("h3",et,a(t(o)("ai-agent.backend.dashboard.messageTrend")),1)]),e("div",tt,[s(r,{name:"i-lucide-info",class:"size-3"}),s(c,{datetime:t(n).startDate,mode:"datetime",class:"text-xs"},null,8,["datetime"]),l[3]||(l[3]=e("span",null,"~",-1)),s(c,{datetime:t(n).endDate,mode:"datetime",class:"text-xs"},null,8,["datetime"])])]),default:m(()=>[e("div",st,[t(d)?.trends?.messages?(_(),y(x,{key:0,options:t(v).messages,height:"100%"},null,8,["options"])):w("",!0)])]),_:1}),s(f,null,{header:m(()=>[e("div",at,[e("h3",ot,a(t(o)("ai-agent.backend.dashboard.tokenOutputCount")),1)]),e("div",nt,[s(r,{name:"i-lucide-info",class:"size-3"}),s(c,{datetime:t(n).startDate,mode:"datetime",class:"text-xs"},null,8,["datetime"]),l[4]||(l[4]=e("span",null,"~",-1)),s(c,{datetime:t(n).endDate,mode:"datetime",class:"text-xs"},null,8,["datetime"])])]),default:m(()=>[e("div",it,[t(d)?.trends?.tokens?(_(),y(x,{key:0,options:t(v).tokens,height:"100%"},null,8,["options"])):w("",!0)])]),_:1}),s(f,null,{header:m(()=>[e("div",dt,[e("h3",lt,a(t(o)("ai-agent.backend.dashboard.activeUsers")),1)]),e("div",rt,[s(r,{name:"i-lucide-info",class:"size-3"}),s(c,{datetime:t(n).startDate,mode:"datetime",class:"text-xs"},null,8,["datetime"]),l[5]||(l[5]=e("span",null,"~",-1)),s(c,{datetime:t(n).endDate,mode:"datetime",class:"text-xs"},null,8,["datetime"])])]),default:m(()=>[e("div",ct,[t(d)?.trends?.activeUsers?(_(),y(x,{key:0,options:t(v).activeUsers,height:"100%"},null,8,["options"])):w("",!0)])]),_:1})])])]),_:1})])):(_(),k("div",mt,[s(r,{name:"i-lucide-alert-circle",class:"text-error mx-auto mb-4 h-12 w-12"}),e("p",ut,a(t(o)("ai-agent.backend.dashboard.loadStatisticsFailed")),1),s(T,{onClick:A,class:"mt-4",variant:"outline"},{default:m(()=>[K(a(t(o)("ai-agent.backend.dashboard.reload")),1)]),_:1})]))])}}});export{Wt as default};
