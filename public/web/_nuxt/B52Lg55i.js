import A from"./cd55qm53.js";import{_ as P}from"./Y67jy4iF.js";import{d as U,av as I,at as L,i as j,a2 as F,s as u,q as E,c as h,o as f,x as o,t as d,g as r,w as g,B as N,z as v,F as q,E as G,f as H}from"#entry";import{_ as J}from"./B5gsc-Ax.js";import{_ as K}from"./B8dIIAdq.js";import{_ as O}from"./Cie-o9Wa.js";import{i as y,w as Q,x as T}from"./gu2_Ts15.js";import{_ as W}from"./ChnQtxj7.js";import{u as b}from"./CSy6ZCzT.js";import{u as w}from"./CxvgZo8z.js";import"./CjasYwqF.js";import"./CAQVAH0V.js";import"./DBEJUH-Z.js";import"./CuVAPZQ8.js";import"./CMKSl-Ng.js";import"./BCcN9pii.js";import"./CtosDvS0.js";import"./Deu6qIfg.js";import"./D9sX2Qi6.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./CBTz8tdX.js";import"./DMoqg0Fd.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./psimjGaX.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./DbqqhwXM.js";import"./DUoaAyrs.js";import"./BlyoSzaa.js";const X={class:"flex w-full flex-col items-center justify-center"},Y={class:"bg-background sticky top-0 z-10 flex w-full flex-wrap justify-between gap-4 pb-2"},Z={class:"grid grid-cols-1 gap-6 pt-2 pb-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"},ee={class:"group-hover:text-primary text-foreground mb-3 flex items-center gap-3"},te={class:"border-default flex size-10 flex-none items-center justify-center rounded-lg border border-dashed"},ae={class:"truncate text-sm font-medium"},se={class:"text-muted-foreground mb-6 pr-8 text-xs"},oe={class:"line-clamp-2 overflow-hidden"},qe=U({__name:"list",setup(re){const _=I(),c=L(),{t:s}=j(),t=F({keyword:"",showAll:!1,page:1,pageSize:15}),i=u(!1),l=u(!0),m=u([]),p=async()=>{if(!i.value){i.value=!0,t.page=1;try{const e=await y(t);m.value=e.items||[],l.value=e.totalPages>t.page}catch(e){console.error("获取数据失败:",e),l.value=!1}finally{i.value=!1}}},k=async()=>{if(!(i.value||!l.value)){i.value=!0,t.page&&t.page++;try{const e=await y(t);e.items&&e.items.length>0?(m.value.push(...e.items),t.page&&(t.page=t.page+1,l.value=e.totalPages>t.page)):l.value=!1}catch(e){t.page&&t.page--,console.error("加载更多数据失败:",e)}finally{i.value=!1}}},x=async e=>{try{await b({title:s("ai-datasets.backend.list.delete.title"),description:s("ai-datasets.backend.list.delete.desc"),color:"error"}),await Q(e.id);const a=t.page;t.page=1,t.pageSize=m.value.length,await p(),t.page=a,t.pageSize=15,c.success(s("common.message.deleteSuccess"))}catch(a){console.error("删除失败:",a)}},D=e=>{_.push(w("ai-datasets:update",{id:e.id}))},$=()=>{_.push(w("ai-datasets:create"))},S=async e=>{try{await b({title:s("ai-datasets.backend.dataset.retry.title"),description:s("ai-datasets.backend.dataset.retry.desc"),color:"warning"});const{success:a}=await T(e.id);a?c.success(s("ai-datasets.backend.dataset.retry.success")):c.error(s("ai-datasets.backend.dataset.retry.failed"))}catch{c.error(s("ai-datasets.backend.dataset.retry.failed"))}};return E(()=>p()),(e,a)=>{const C=A,V=P,B=N,M=J,z=K,R=O;return f(),h("div",X,[o("div",Y,[d(C,{modelValue:r(t).keyword,"onUpdate:modelValue":a[0]||(a[0]=n=>r(t).keyword=n),placeholder:e.$t("ai-datasets.backend.dataset.searchPlaceholder"),class:"w-80",onChange:p},null,8,["modelValue","placeholder"]),d(V,{modelValue:r(t).showAll,"onUpdate:modelValue":a[1]||(a[1]=n=>r(t).showAll=n),label:e.$t("ai-datasets.backend.dataset.allDatasets"),onChange:p},null,8,["modelValue","label"])]),d(R,{class:"h-[calc(100vh-9rem)] min-h-0 w-full"},{default:g(()=>[d(z,{loading:r(i),"has-more":r(l),threshold:200,"loading-text":e.$t("common.loading"),"no-more-text":r(t).page!==1?e.$t("common.noMoreData"):" ",onLoadMore:k},{default:g(()=>[o("div",Z,[d(M,{codes:["ai-datasets:create"]},{default:g(()=>[o("div",{class:"group border-default relative cursor-pointer rounded-lg border border-dashed p-4 transition-all duration-200 hover:shadow-lg",onClick:$},[o("div",ee,[o("div",te,[d(B,{name:"i-lucide-plus",class:"h-6 w-6"})]),o("h3",ae,v(e.$t("ai-datasets.backend.dataset.create.title")),1)]),o("div",se,[o("p",oe,v(e.$t("ai-datasets.backend.dataset.create.desc")),1)])])]),_:1}),(f(!0),h(q,null,G(r(m),n=>(f(),H(W,{key:n.id,dataset:n,onDelete:x,onSettings:D,onRetry:S},null,8,["dataset"]))),128))])]),_:1},8,["loading","has-more","loading-text","no-more-text"])]),_:1})])}}});export{qe as default};
