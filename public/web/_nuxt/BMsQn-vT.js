import{d as L,at as D,a2 as G,i as M,s as g,aN as C,f as k,o as d,az as R,w as o,g as e,x as i,t as n,A as _,z as r,_ as E,c as p,y as f,aZ as P,B as Q,G as T}from"#entry";import Z from"./cd55qm53.js";import{_ as H}from"./D_3bTjYR.js";import{_ as J}from"./DD8ySyt7.js";import{_ as K}from"./Ghlq83yM.js";import{j as O,k as W}from"./CsRstiIM.js";import{c as X,b as Y}from"./FTderXKt.js";import"./D9sX2Qi6.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./BFo3vNrE.js";import"./CuVAPZQ8.js";import"./Z7qkLoXK.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./DaWZu8wl.js";const ee={class:"flex items-center gap-2"},te={key:0},ae={class:"flex justify-end gap-2 pt-4"},oe={key:1,class:"space-y-4"},ne={key:0,class:"border-default bg-muted relative mb-4 flex w-full items-center justify-center overflow-hidden rounded-lg border",style:{"aspect-ratio":"800 / 450"}},ie={class:"flex items-center gap-4"},se={class:"text-foreground text-lg font-semibold"},le={class:"space-y-2"},ce={key:0},re={class:"text-muted-foreground text-sm leading-relaxed"},de={class:"flex justify-end gap-2"},Fe=L({__name:"install-activation-modal",emits:["close"],setup(me,{emit:b}){const x=b,h=D(),m=G({activationCode:""}),{t}=M(),w=X({activationCode:Y().required(t("extensions.manage.installActivation.activationCodeRequired"))}),l=g("input"),a=g(null),s=g(!1),{isLock:A,lockFn:z}=C(async()=>{try{const c=await O(m.activationCode);if(!c){h.error(t("extensions.manage.installActivation.activationCodeInvalid"));return}a.value=c,l.value="preview"}catch(c){console.error(t("extensions.manage.installActivation.queryFailed"),c)}}),B=()=>{l.value="input",a.value=null},v=()=>{x("close",!1)},{lockFn:I}=C(async()=>{if(a.value)try{s.value=!0,await W(m.activationCode,a.value.key),h.success(t("extensions.manage.installActivation.installSuccess")),x("close",!0)}catch(c){console.error(t("extensions.manage.installActivation.installFailed"),c)}finally{s.value=!1}});return(c,y)=>{const u=E,$=Z,F=H,U=J,V=P,N=Q,S=T,j=K;return d(),k(j,{title:e(t)("extensions.manage.installActivation.title"),ui:{content:e(l)==="preview"?"max-w-xl":"max-w-md"},"disabled-close":e(s),"close-on-esc":!e(s),onClose:v},R({title:o(()=>[i("div",ee,[e(l)==="preview"?(d(),k(u,{key:0,color:"neutral",variant:"ghost",icon:"i-lucide-arrow-left",size:"sm",disabled:e(s),onClick:B},null,8,["disabled"])):f("",!0),i("span",null,r(e(t)("extensions.manage.installActivation.title")),1)])]),default:o(()=>[e(l)==="input"?(d(),p("div",te,[n(U,{state:e(m),schema:e(w),class:"w-full space-y-4",onSubmit:e(z)},{default:o(()=>[n(F,{label:e(t)("extensions.manage.installActivation.activationCodeLabel"),name:"activationCode",required:""},{default:o(()=>[n($,{modelValue:e(m).activationCode,"onUpdate:modelValue":y[0]||(y[0]=q=>e(m).activationCode=q),placeholder:e(t)("extensions.manage.installActivation.activationCodePlaceholder"),size:"lg",ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),i("div",ae,[n(u,{color:"neutral",variant:"outline",size:"lg",onClick:v},{default:o(()=>[_(r(e(t)("extensions.manage.installActivation.cancel")),1)]),_:1}),n(u,{color:"primary",size:"lg",loading:e(A),type:"submit"},{default:o(()=>[_(r(e(t)("extensions.manage.installActivation.query")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"])])):e(l)==="preview"&&e(a)?(d(),p("div",oe,[e(a).cover?(d(),p("div",ne,[n(V,{src:e(a).cover,alt:e(a).name,class:"h-full w-full rounded-lg object-contain"},null,8,["src","alt"])])):f("",!0),i("div",ie,[n(S,{src:e(a).icon,alt:e(a).name,size:"3xl",ui:{root:"rounded-lg flex-shrink-0"}},{fallback:o(()=>[n(N,{name:"i-lucide-puzzle",class:"text-muted-foreground h-12 w-12"})]),_:1},8,["src","alt"]),i("div",null,[i("h3",se,r(e(a).name),1)])]),i("div",le,[e(a).describe?(d(),p("div",ce,[i("p",re,r(e(a).describe),1)])):f("",!0)])])):f("",!0)]),_:2},[e(l)==="preview"?{name:"footer",fn:o(()=>[i("div",de,[n(u,{color:"neutral",variant:"outline",size:"lg",disabled:e(s),onClick:v},{default:o(()=>[_(r(e(t)("extensions.manage.installActivation.cancel")),1)]),_:1},8,["disabled"]),n(u,{color:"primary",size:"lg",loading:e(s),onClick:e(I)},{default:o(()=>[_(r(e(s)?e(t)("extensions.manage.installActivation.installing"):e(t)("extensions.manage.installActivation.confirmInstall")),1)]),_:1},8,["loading","onClick"])])]),key:"0"}:void 0]),1032,["title","ui","disabled-close","close-on-esc"])}}});export{Fe as default};
