import{d as R,i as W,s as L,l as Z,n as G,c as U,o as x,x as r,t,A as u,z as d,w as s,B as H,_ as Q,f as X,y as C,g as e,D as w,aW as Y,at as ee}from"#entry";import{_ as ae}from"./DbqqhwXM.js";import{_ as oe}from"./o4ws_w_T.js";import{_ as te}from"./Y67jy4iF.js";import{_ as le}from"./D_3bTjYR.js";import ne from"./cd55qm53.js";import{_ as ie}from"./DD8ySyt7.js";import{_ as re}from"./Ghlq83yM.js";import{D as T}from"./3nrh3-Gq.js";import{c as se,b as k,a as de}from"./FTderXKt.js";import"./DNSLGqNg.js";import"./psimjGaX.js";import"./CuVAPZQ8.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./CjasYwqF.js";import"./CAQVAH0V.js";import"./DBEJUH-Z.js";import"./CMKSl-Ng.js";import"./BCcN9pii.js";import"./CtosDvS0.js";import"./Deu6qIfg.js";import"./D9sX2Qi6.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./BFo3vNrE.js";import"./Z7qkLoXK.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";import"./DaWZu8wl.js";const me={class:"bg-muted rounded-lg p-3"},ue={class:"flex items-center justify-between"},ce={class:"text-foreground flex items-center gap-1 text-sm font-medium"},pe={class:"text-background text-xs"},fe={class:"space-y-3"},ge={class:"group bg-background mt-2 flex items-center gap-2 rounded-lg px-3 py-2"},be={class:"flex flex-1 items-center gap-2"},ve={class:"text-foreground text-sm font-medium"},_e={class:"text-muted-foreground font-mono text-xs"},Ve={class:"block group-hover:hidden"},he={class:"hidden items-center group-hover:flex"},xe={class:"flex items-center gap-2"},ke={key:0,class:"space-y-3"},ye={class:"flex items-center justify-between"},$e={class:"text-sm font-medium"},Le={key:0,class:"space-y-2"},Ue={class:"mt-2 flex items-center gap-2"},Ce={class:"mt-6 flex justify-end gap-2"},ra=R({__name:"variable",props:{modelValue:{}},emits:["update:modelValue"],setup(z,{emit:O}){const m=Y(z,"modelValue",O),{t:i}=W(),p=L(!1),b=L(!1),f=L(-1),N={name:"",label:"",type:"text",required:!1,maxLength:void 0,options:[]},o=Z({...N,maxLength:void 0}),S=se({name:k().required(i("ai-agent.backend.configuration.formVariableNameEmpty")).matches(/^[a-zA-Z0-9_]+$/,i("ai-agent.backend.configuration.formVariableNameInvalid")),label:k().required(i("ai-agent.backend.configuration.formVariableLabelEmpty")),type:k().required(i("ai-agent.backend.configuration.formVariableTypeEmpty")).oneOf(["text","textarea","select"]),required:de().optional(),maxLength:k().optional().test("is-positive-number",i("ai-agent.backend.configuration.formVariableMaxLengthInvalid"),n=>{if(!n)return!0;const a=Number(n);return!isNaN(a)&&a>0})}),B=G(()=>o.value.type==="select"),D=async()=>{try{if(m.value.find((g,$)=>g.name===o.value.name&&$!==f.value)){ee().error(i("ai-agent.backend.configuration.formVariableNameExists"));return}const a={...o.value,maxLength:o.value.maxLength?Number(o.value.maxLength):void 0};b.value&&f.value>=0?m.value[f.value]=a:m.value.push(a),y()}catch(n){console.error("operation failed:",n)}},E=()=>{o.value.options||(o.value.options=[]),o.value.options.push("")},M=n=>{o.value.options?.splice(n,1)},I=()=>{b.value=!1,f.value=-1,p.value=!0},F=n=>{b.value=!0,f.value=n;const a=m.value[n];a&&(o.value={...JSON.parse(JSON.stringify(a)),maxLength:a.maxLength?String(a.maxLength):void 0},p.value=!0)},A=()=>{o.value={...N,maxLength:void 0}},y=()=>{p.value=!1,b.value=!1,A(),f.value=-1},j=n=>{m.value.splice(n,1)};return(n,a)=>{const g=H,$=ae,c=Q,q=oe,V=te,v=le,h=ne,P=ie,J=re;return x(),U("div",null,[r("div",me,[r("div",ue,[r("div",ce,[u(d(n.$t("ai-agent.backend.configuration.formVariable"))+" ",1),t($,{"delay-duration":0,ui:{content:"w-xs h-auto"}},{content:s(()=>[r("div",pe,[u(d(n.$t("ai-agent.backend.configuration.formVariableDesc"))+" ",1),a[10]||(a[10]=r("br",null,null,-1)),u(" "+d(n.$t("ai-agent.backend.configuration.formVariableDesc2")),1)])]),default:s(()=>[t(g,{name:"i-lucide-circle-help"})]),_:1})]),t(c,{size:"sm",color:"primary",variant:"ghost",class:"flex items-center",onClick:I},{default:s(()=>[t(g,{name:"i-lucide-plus"}),r("span",null,d(n.$t("console-common.add")),1)]),_:1})]),r("div",fe,[t(e(T),{modelValue:e(m),"onUpdate:modelValue":a[0]||(a[0]=l=>w(m)?m.value=l:null),class:"draggable",animation:"300",handle:".drag-handle",itemKey:"name"},{item:s(({element:l,index:_})=>[r("div",ge,[t(g,{name:"i-lucide-grip-vertical",class:"drag-handle text-muted-foreground cursor-move"}),r("div",be,[r("span",ve,d(l.label),1),r("span",_e,d(l.name),1)]),r("div",Ve,[l.required?(x(),X(q,{key:0,color:"error",variant:"outline",size:"sm"},{default:s(()=>[u(d(n.$t("ai-agent.backend.configuration.required")),1)]),_:1})):C("",!0),t(q,{color:"neutral",variant:"outline",size:"sm",class:"ml-1"},{default:s(()=>[u(d(l.type),1)]),_:2},1024)]),r("div",he,[t(c,{size:"xs",color:"primary",variant:"ghost",icon:"i-lucide-edit",onClick:K=>F(_)},null,8,["onClick"]),t(c,{size:"xs",color:"error",variant:"ghost",icon:"i-lucide-trash",onClick:K=>j(_)},null,8,["onClick"])])])]),_:1},8,["modelValue"])])]),t(J,{open:e(p),"onUpdate:open":a[9]||(a[9]=l=>w(p)?p.value=l:null),title:e(b)?n.$t("ai-agent.backend.configuration.formVariableEditTitle"):n.$t("ai-agent.backend.configuration.formVariableAddTitle"),description:e(i)("ai-agent.backend.configuration.formVariableTitleDesc"),ui:{content:"max-w-md"},onClose:y},{default:s(()=>[t(P,{state:e(o),schema:e(S),class:"space-y-4",onSubmit:D},{default:s(()=>[t(v,{label:e(i)("ai-agent.backend.configuration.formVariableType"),name:"type",required:""},{default:s(()=>[r("div",xe,[t(V,{"model-value":e(o).type==="text",indicator:"end",variant:"card","default-value":"",label:e(i)("ai-agent.backend.configuration.formVariableTypeText"),ui:{root:"w-full"},"onUpdate:modelValue":a[1]||(a[1]=l=>e(o).type="text")},null,8,["model-value","label"]),t(V,{"model-value":e(o).type==="textarea",indicator:"end",variant:"card","default-value":"",label:e(i)("ai-agent.backend.configuration.formVariableTypeTextarea"),ui:{root:"w-full"},"onUpdate:modelValue":a[2]||(a[2]=l=>e(o).type="textarea")},null,8,["model-value","label"]),t(V,{"model-value":e(o).type==="select",indicator:"end",variant:"card","default-value":"",label:e(i)("ai-agent.backend.configuration.formVariableTypeSelect"),ui:{root:"w-full"},"onUpdate:modelValue":a[3]||(a[3]=l=>e(o).type="select")},null,8,["model-value","label"])])]),_:1},8,["label"]),t(v,{label:e(i)("ai-agent.backend.configuration.formVariableName"),name:"name",required:""},{default:s(()=>[t(h,{modelValue:e(o).name,"onUpdate:modelValue":a[4]||(a[4]=l=>e(o).name=l),placeholder:e(i)("ai-agent.backend.configuration.formVariableNamePlaceholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(v,{label:e(i)("ai-agent.backend.configuration.formVariableLabel"),name:"label",required:""},{default:s(()=>[t(h,{modelValue:e(o).label,"onUpdate:modelValue":a[5]||(a[5]=l=>e(o).label=l),placeholder:e(i)("ai-agent.backend.configuration.formVariableLabelPlaceholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(v,{label:e(i)("ai-agent.backend.configuration.formVariableMaxLength"),name:"maxLength"},{default:s(()=>[t(h,{modelValue:e(o).maxLength,"onUpdate:modelValue":a[6]||(a[6]=l=>e(o).maxLength=l),type:"number",placeholder:e(i)("ai-agent.backend.configuration.formVariableMaxLengthPlaceholder"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),e(B)?(x(),U("div",ke,[r("div",ye,[r("label",$e,d(n.$t("ai-agent.backend.configuration.formVariableOptions")),1),t(c,{size:"xs",color:"primary",variant:"ghost",onClick:E},{default:s(()=>[t(g,{name:"i-lucide-plus"}),u(" "+d(n.$t("ai-agent.backend.configuration.formVariableOptionsAdd")),1)]),_:1})]),e(o).options?.length?(x(),U("div",Le,[t(e(T),{class:"draggable cursor-move",modelValue:e(o).options,"onUpdate:modelValue":a[7]||(a[7]=l=>e(o).options=l),animation:"300",handle:".drag-move",itemKey:"id"},{item:s(({index:l})=>[r("div",Ue,[t(h,{icon:"i-lucide-grip-vertical",modelValue:e(o).options[l],"onUpdate:modelValue":_=>e(o).options[l]=_,placeholder:e(i)("ai-agent.backend.configuration.formVariableOptionsLabel"),ui:{root:"flex-1",leadingIcon:"drag-move"}},null,8,["modelValue","onUpdate:modelValue","placeholder"]),t(c,{size:"xs",color:"error",variant:"ghost",icon:"i-lucide-trash",onClick:_=>M(l)},null,8,["onClick"])])]),_:1},8,["modelValue"])])):C("",!0)])):C("",!0),t(v,{label:" ",name:"required"},{default:s(()=>[t(V,{modelValue:e(o).required,"onUpdate:modelValue":a[8]||(a[8]=l=>e(o).required=l),label:e(i)("ai-agent.backend.configuration.required")},null,8,["modelValue","label"])]),_:1}),r("div",Ce,[t(c,{color:"neutral",variant:"soft",size:"lg",onClick:y},{default:s(()=>[u(d(n.$t("console-common.cancel")),1)]),_:1}),t(c,{color:"primary",size:"lg",type:"submit"},{default:s(()=>[u(d(n.$t("console-common.save")),1)]),_:1})])]),_:1},8,["state","schema"])]),_:1},8,["open","title","description"])])}}});export{ra as default};
