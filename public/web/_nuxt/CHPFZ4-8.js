import ee from"./cd55qm53.js";import{_ as te}from"./D_3bTjYR.js";import{d as se,i as le,bu as oe,s as q,p as ae,b2 as ne,b3 as ie,aM as ce,n as A,f as _,o as s,w as d,x as o,t as c,c as r,y as g,T as re,g as e,_ as de,A as ue,B as me,z as f,F as x,E as v,v as B,C as M,l as pe,aX as fe,h as N,aO as $,ar as E,bb as he,O as _e}from"#entry";import{_ as xe}from"./CBTz8tdX.js";import{_ as ve}from"./CWpJD8K1.js";import{_ as ye}from"./Cie-o9Wa.js";import{_ as be}from"./CzL0xTzV.js";import{g as ge,h as Ce,i as ke,j as we}from"./D7VOTB3C.js";import{g as Se}from"./QEC2sJuf.js";import{u as ze}from"./fhkze2Jn.js";import{u as I}from"./CSy6ZCzT.js";import{d as $e}from"./MCK2d4XT.js";import{_ as De}from"./abPSHzII.js";const Pe={class:"relative h-full flex-1"},Ue={key:0,class:"flex h-full min-h-0 w-[240px] flex-col"},Ve={class:"border-border/50 flex gap-2 border-b px-1 py-3"},Te={class:"h-full flex-1 overflow-hidden"},Ae={key:0,class:"text-muted-foreground flex h-full flex-col items-center justify-center text-center text-sm"},Be={class:"mb-2"},Me={class:"text-xs"},Ne={class:"flex flex-col gap-4 space-y-1 py-4 pr-4 pl-2"},Ee={key:0,class:"text-muted-foreground px-2 py-1 text-xs font-medium"},Le={class:"flex flex-col gap-1"},je={class:"block flex-1 truncate text-left"},Fe={key:0,class:"flex flex-col gap-4 py-4"},Ke={class:"px-2 py-1"},Oe={class:"flex flex-col gap-1"},Re={key:0,class:"absolute top-2 left-2 z-50 flex items-center gap-2"},Ie={class:"group relative hidden sm:block"},qe={class:"block flex-1 truncate text-left text-sm"},Ge={class:"block flex-1 truncate text-left text-sm"},Qe={key:0,class:"text-muted-foreground flex h-full flex-col items-center justify-center text-center text-sm"},Xe={class:"mb-2"},He={class:"text-xs"},Je={class:"flex flex-col gap-4 space-y-1 py-4 pr-4 pl-2"},We={class:"text-muted-foreground px-2 py-1 text-xs font-medium"},Ye={class:"flex flex-col gap-1"},Ze={class:"block flex-1 truncate text-left"},et={key:0,class:"flex flex-col gap-4 py-4"},tt={class:"px-2 py-1"},st={class:"flex flex-col gap-1"},lt=se({inheritAttrs:!1,__name:"chats-chats",async setup(C){let k,D;const{t}=le(),h=ze(),L=oe("(max-width: 768px)"),y=q(!1);ae(L,l=>{l?h.chatSidebarVisible=!1:(y.value=!1,h.chatSidebarVisible=!0)},{immediate:!1});const{data:w,pending:S}=([k,D]=ne(()=>ie("chats",()=>ge({page:1,pageSize:50}),{lazy:!1})),k=await k,D(),k),j=ce(),m=A(()=>j.name==="chat-id"?j.params.id:""),G=ee,Q=te,b=A(()=>w.value?.items?.length?Se(w.value.items,"updatedAt",t):[]),P=A(()=>!w.value?.items||!m.value?null:w.value.items.find(l=>l.id===m.value)||null);async function X(l){const a=pe(l.title);try{const u=fe({setup(){return()=>N("div",{class:"py-2"},[N(Q,{label:t("common.chat.chatTitleLabel"),size:"lg",required:!0,error:a.value.trim()?"":t("common.chat.chatTitleRequired")},{default:()=>N(G,{modelValue:a.value,"onUpdate:modelValue":p=>{a.value=p},placeholder:t("common.chat.chatTitlePlaceholder"),maxlength:50,class:"w-full",onKeyup:p=>{p.key==="Enter"&&a.value.trim()}})})])}});await I({title:t("common.chat.editChatTitle"),content:u,confirmText:t("common.save"),cancelText:t("common.cancel"),color:"primary",ui:{content:"!w-sm"}}),a.value.trim()&&a.value!==l.title&&(await Ce(l.id,{title:a.value}),$("chats"),$(`chat-detail-${l.id}`))}catch(u){console.log("User cancelled edit operation:",u)}}async function F(l){try{await I({color:"error",title:t("common.chat.confirmDelete"),content:t("common.chat.confirmDeleteMessage"),confirmText:t("common.chat.confirmDeleteAction"),cancelText:t("common.cancel"),ui:{content:"!w-sm"}})&&(await ke(l.id),await $("chats")),E("/")}catch(a){console.log("User cancelled delete operation or delete failed:",a)}}async function H(l){await we(l.id,!l.isPinned),await $("chats")}function U(l){E(`/chat/${l.id}`)}function K(){E("/")}const J=()=>{L.value?(y.value=!0,h.chatSidebarVisible=!1):(y.value=!1,h.chatSidebarVisible=!0)};function W(l,a){(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),U(a))}const O=l=>[{label:l.isPinned?t("common.chat.unpin"):t("common.chat.pin"),color:"primary",icon:l.isPinned?"i-lucide-pin-off":"i-lucide-pin",onSelect:()=>H(l)},{label:t("common.edit"),color:"primary",icon:"i-lucide-pencil",onSelect:()=>X(l)},{label:t("common.delete"),color:"error",icon:"i-lucide-trash",onSelect:()=>F(l)}];return $e({o:()=>y.value=!y.value}),(l,a)=>{const u=me,p=de,V=xe,z=ve,R=ye,Y=be,Z=he;return s(),_(Z,null,{default:d(()=>[o("div",Pe,[c(re,{name:"sidebar"},{default:d(()=>[e(h).chatSidebarVisible?(s(),r("div",Ue,[o("div",Ve,[c(p,{ui:{base:"w-full"},color:"primary",variant:"soft",onClick:K},{default:d(()=>[c(u,{name:"i-lucide-sparkles",class:"mr-2 size-4"}),ue(" "+f(e(t)("common.chat.newChat")),1)]),_:1}),c(p,{color:"neutral",variant:"ghost",class:"p-2",onClick:a[0]||(a[0]=i=>e(h).chatSidebarVisible=!1)},{default:d(()=>[c(u,{name:"i-lucide-history",class:"size-5"})]),_:1})]),o("div",Te,[!e(b).length&&!e(S)?(s(),r("div",Ae,[o("div",Be,[c(u,{name:"i-lucide-message-circle",size:"lg",class:"text-muted-foreground"})]),o("p",null,f(e(t)("common.chat.noChats")),1),o("p",Me,f(e(t)("common.chat.noChatsSubtitle")),1)])):(s(),_(R,{key:1,class:"grid h-full"},{default:d(()=>[o("div",Ne,[(s(!0),r(x,null,v(e(b),i=>(s(),r("div",{key:i.key,class:"flex flex-col gap-2"},[i.label?(s(),r("div",Ee,f(i.label),1)):g("",!0),o("div",Le,[(s(!0),r(x,null,v(i.items,n=>(s(),r("div",{key:n.id,class:"group relative"},[c(p,{label:n.title,ui:{base:"flex justify-between w-full gap-2 cursor-pointer pr-10 relative w-full"},variant:n.id===e(m)?"soft":"ghost",color:n.id===e(m)?"primary":"neutral",onClick:T=>U(n),onKeydown:T=>W(T,n)},{default:d(()=>[o("span",je,f(n.title||e(t)("common.chat.newChat")),1)]),_:2},1032,["label","variant","color","onClick","onKeydown"]),n.isPinned?(s(),_(u,{key:0,name:"i-lucide-pin",size:16,class:M(["bg-primary/50 absolute top-1/2 right-3 z-10 -translate-y-1/2 cursor-pointer px-2.5 py-1.5 transition-opacity group-hover:opacity-0",{"opacity-0":n.id===e(m),"opacity-100":n.id!==e(m)}]),onClick:a[1]||(a[1]=B(()=>{},["stop"]))},null,8,["class"])):g("",!0),c(V,{items:[O(n)],ui:{content:"w-3",group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"right",align:"start"}},{default:d(()=>[c(u,{name:"i-lucide-ellipsis",size:14,class:M(["absolute top-1/2 right-3 z-10 h-8 -translate-y-1/2 cursor-pointer px-2.5 py-1.5 opacity-0 transition-opacity group-hover:opacity-100",{"opacity-100":n.id===e(m)}]),onClick:a[2]||(a[2]=B(()=>{},["stop"]))},null,8,["class"])]),_:2},1032,["items"])]))),128))])]))),128)),!e(b).length&&e(S)?(s(),r("div",Fe,[(s(),r(x,null,v(3,i=>o("div",{key:`group-${i}`,class:"flex flex-col gap-2"},[o("div",Ke,[c(z,{class:"h-4 w-16"})]),o("div",Oe,[(s(!0),r(x,null,v(i===1?3:i===2?2:1,n=>(s(),_(z,{key:`item-${i}-${n}`,class:"h-10 w-full rounded-md"}))),128))])])),64))])):g("",!0)])]),_:1}))])])):g("",!0)]),_:1}),e(h).chatSidebarVisible?g("",!0):(s(),r("div",Re,[c(p,{color:"neutral",variant:"ghost",size:"lg",class:"p-2",onClick:J},{default:d(()=>[c(u,{name:"i-lucide-history",class:"size-5"})]),_:1}),a[5]||(a[5]=o("div",{class:"text-muted-foreground mx-1 hidden sm:block"},"/",-1)),o("div",Ie,[e(m)?(s(),_(V,{key:1,items:[{label:e(t)("common.delete"),color:"error",icon:"i-lucide-trash",onSelect:()=>{const i=e(P);i&&F(i)}},{label:e(t)("common.chat.newChat"),color:"primary",icon:"i-lucide-sparkles",onSelect:()=>K()}],ui:{group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"bottom",align:"center"}},{default:d(()=>[c(p,{label:e(P)?.title||e(t)("common.chat.currentChat"),variant:"ghost",color:"neutral",size:"sm",class:"px-3 py-2"},{default:d(()=>[o("span",Ge,f(e(P)?.title||e(t)("common.chat.currentChat")),1),c(u,{name:"i-lucide-chevron-down",class:"size-5"})]),_:1},8,["label"])]),_:1},8,["items"])):(s(),_(p,{key:0,variant:"ghost",color:"neutral",size:"sm",class:"px-3 py-2"},{default:d(()=>[o("span",qe,f(e(t)("common.chat.newChat")),1)]),_:1}))])])),c(Y,{open:y.value,"onUpdate:open":a[4]||(a[4]=i=>y.value=i),side:"left",ui:{content:"!w-fit flex-0 max-w-fit"}},{content:d(()=>[!e(b).length&&!e(S)?(s(),r("div",Qe,[o("div",Xe,[c(u,{name:"i-lucide-message-circle",size:"lg",class:"text-gray-400"})]),o("p",null,f(e(t)("common.chat.noChats")),1),o("p",He,f(e(t)("common.chat.noChatsSubtitle")),1)])):(s(),_(R,{key:1,class:"h-full"},{default:d(()=>[o("div",Je,[(s(!0),r(x,null,v(e(b),i=>(s(),r("div",{key:i.key,class:"flex flex-col gap-2"},[o("div",We,f(i.label),1),o("div",Ye,[(s(!0),r(x,null,v(i.items,n=>(s(),r("div",{key:n.id,class:"group relative"},[c(p,{label:n.title,ui:{base:"flex justify-between w-full gap-2 cursor-pointer pr-10 relative w-full"},variant:n.id===e(m)?"soft":"ghost",color:n.id===e(m)?"primary":"neutral",onClick:T=>U(n)},{default:d(()=>[o("span",Ze,f(n.title||e(t)("common.chat.newChat")),1)]),_:2},1032,["label","variant","color","onClick"]),c(V,{items:[O(n)],ui:{content:"w-3",group:"flex flex-col gap-1 p-2",itemLeadingIcon:"size-4"},content:{side:"right",align:"start"}},{default:d(()=>[c(u,{name:"i-lucide-ellipsis",size:14,class:M(["absolute top-1/2 right-3 z-10 h-8 -translate-y-1/2 cursor-pointer px-2.5 py-1.5 opacity-0 transition-opacity group-hover:opacity-100",{"opacity-100":n.id===e(m)}]),onClick:a[3]||(a[3]=B(()=>{},["stop"]))},null,8,["class"])]),_:2},1032,["items"])]))),128))])]))),128)),!e(b).length&&e(S)?(s(),r("div",et,[(s(),r(x,null,v(3,i=>o("div",{key:`group-${i}`,class:"flex flex-col gap-2"},[o("div",tt,[c(z,{class:"h-4 w-16"})]),o("div",st,[(s(!0),r(x,null,v(i===1?3:i===2?2:1,n=>(s(),_(z,{key:`item-${i}-${n}`,class:"h-10 w-full rounded-md"}))),128))])])),64))])):g("",!0)])]),_:1}))]),_:1},8,["open"])])]),_:1})}}}),xt=De(lt,[["__scopeId","data-v-055f106f"]]),vt=_e("chat",()=>{const C=q(null);return{pendingConversation:C,setPendingConversation:h=>{C.value=h},clearPendingConversation:()=>{C.value=null},getPendingConversation:()=>C.value}});export{xt as _,vt as u};
