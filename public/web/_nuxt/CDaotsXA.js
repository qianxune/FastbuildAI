const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./W8JXYiCL.js","./Cgyg1gJC.js","./Da83zglB.js","./cd55qm53.js","./9Q2Y_nd6.js","./td2xDKru.js","./RPflLnqr.js","./TrJvDfxI.js","./jsPNKUA0.js","./abPSHzII.js","./bvMLy1sv.js","./D9sX2Qi6.js","./CAQVAH0V.js","./Deu6qIfg.js","./D_3bTjYR.js","./DQQ3dYHz.js","./Dh3Mo9T6.js","./DNSLGqNg.js","./CuVAPZQ8.js","./BFo3vNrE.js","./sTbVUDyT.js","./CtosDvS0.js","./kRIii9yh.js","./D4e4FYoF.js","./CMKSl-Ng.js","./Z7qkLoXK.js","./shdu-Ndv.js","./Iv8N83fp.js","./CvI6s-qz.js","./DeCyaT7k.js","./BstbYvQo.js","./C5Ha_WGa.js","./DMoqg0Fd.js","./C6Y-ieo6.js","./BCcN9pii.js","./psimjGaX.js","./hsuWSsy6.js","./Cie-o9Wa.js","./MCK2d4XT.js","./EK7Wbu3-.js","./DD8ySyt7.js","./B9ZIqvFb.js","./C_EXknkZ.js","./FTderXKt.js","./DaWZu8wl.js"])))=>i.map(i=>d[i]);
import{d as U,i as w,aM as x,av as C,at as D,n as R,l as B,aN as I,q as F,c as b,o as u,x as m,f as L,t as _,w as S,B as $,z as k,g as t,_ as z,W as E,X as M,bQ as N,bR as T}from"#entry";import{g as V}from"./C_EXknkZ.js";const j={class:"user-edit-container"},q={class:"bg-background sticky top-0 z-10 mb-4 flex w-full items-center justify-baseline pb-2"},G={class:"text-base font-medium"},P={class:"ml-4 text-xl font-bold"},O={key:0,class:"flex justify-center py-12"},H=U({__name:"edit",setup(Q){const g=E(()=>M(()=>import("./W8JXYiCL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]),import.meta.url)),{t:n}=w(),h=x(),a=C(),r=D(),i=R(()=>h.query.id),p=B({}),{lockFn:f,isLock:y}=I(async()=>{if(!i.value){r.error(n("user.backend.messages.missingUserId")),a.back();return}try{const{id:e,createdAt:s,updatedAt:c,lastLoginAt:d,role:l,...o}=await N(i.value);o.phone||(o.phoneAreaCode=V()),p.value={...o,roleId:l?.id||void 0}}catch(e){console.error("Get user detail failed:",e),r.error(n("user.backend.messages.getUserDetailFailed")),a.back()}}),v=async e=>{try{const{username:s,password:c,isRoot:d,totalRechargeAmount:l,...o}=e;await T(i.value,o),r.success(n("user.backend.messages.updateSuccess")),setTimeout(()=>a.back(),1e3)}catch(s){console.error("Update user failed:",s),r.error(n("user.backend.messages.updateFailed"))}},A=()=>{a.back()};return F(()=>f()),(e,s)=>{const c=$,d=z;return u(),b("div",j,[m("div",q,[_(d,{color:"neutral",variant:"soft",onClick:s[0]||(s[0]=l=>t(a).back())},{default:S(()=>[_(c,{name:"i-lucide-arrow-left",class:"size-5 cursor-pointer"}),m("span",G,k(e.$t("console-common.back")),1)]),_:1}),m("h1",P,k(e.$t("user.backend.editTitle")),1)]),t(y)?(u(),b("div",O,[_(c,{name:"i-lucide-loader-2",class:"text-primary-500 h-8 w-8 animate-spin"})])):(u(),L(t(g),{key:1,"is-edit":!0,id:t(i),"initial-data":t(p),onRefresh:t(f),onSubmitSuccess:v,onCancel:A},null,8,["id","initial-data","onRefresh"]))])}}});export{H as default};
