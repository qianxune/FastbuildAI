import{d as z,i as L,at as T,a2 as q,aN as y,n as k,q as E,f as x,o as u,w as i,c as I,g as e,x as l,t as n,B as S,z as f,A as h,_ as j}from"#entry";import A from"./cd55qm53.js";import{_ as G}from"./D_3bTjYR.js";import{_ as H}from"./DD8ySyt7.js";import{_ as K}from"./Ghlq83yM.js";import{e as O,f as P,g as R}from"./C0KOn7yN.js";import{c as J,b as Q}from"./FTderXKt.js";import"./D9sX2Qi6.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./BFo3vNrE.js";import"./CuVAPZQ8.js";import"./Z7qkLoXK.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./DaWZu8wl.js";const W={key:0,class:"flex items-center justify-center py-12"},X={class:"flex flex-col items-center gap-3"},Y={class:"text-muted-foreground text-sm"},Z={class:"space-y-4"},ee={class:"flex justify-end gap-3 pt-6"},xe=z({__name:"edit",props:{id:{}},emits:["close"],setup(b,{emit:v}){const{t:o}=L(),_=T(),a=b,d=v,s=q({terminal:"web",name:"",configs:{backgroundColor:"#ffffff",backgroundDarkColor:"",backgroundImage:"",backgroundType:"solid",pageHeight:1080},content:[]}),w=J({name:Q().required(o("decorate.micropage.edit.pageNameRequired")).max(32,o("decorate.micropage.edit.pageNameMaxLength"))}),{lockFn:$,isLock:C}=y(async()=>{try{const c=await O(a.id);Object.keys(s).forEach(t=>{const r=t,m=c[r];m!==void 0&&(s[r]=m)})}catch(c){console.error("获取微页面详情失败:",c)}}),{lockFn:D,isLock:N}=y(async()=>{try{a.id?(await P(a.id,s),_.success(o("console-common.messages.success"))):(await R(s),_.success(o("console-common.messages.success"))),d("close",!0)}catch(c){console.error("提交失败:",c)}}),B=k(()=>a.id?o("decorate.micropage.edit.modalTitleEdit"):o("decorate.micropage.edit.modalTitleCreate")),F=k(()=>a.id?o("decorate.micropage.edit.modalDescriptionEdit"):o("decorate.micropage.edit.modalDescriptionCreate"));return E(async()=>a.id&&await $()),(c,t)=>{const r=S,m=A,M=G,g=j,U=H,V=K;return u(),x(V,{title:e(B),description:e(F),ui:{content:"max-w-md"},onClose:t[2]||(t[2]=p=>d("close",!1))},{default:i(()=>[e(C)?(u(),I("div",W,[l("div",X,[n(r,{name:"i-lucide-loader-2",class:"text-primary size-8 animate-spin"}),l("p",Y,f(e(o)("common.loading")),1)])])):(u(),x(U,{key:1,state:e(s),schema:e(w),class:"space-y-6",onSubmit:e(D)},{default:i(()=>[l("div",Z,[n(M,{label:e(o)("decorate.micropage.edit.pageName"),name:"name",required:""},{default:i(()=>[n(m,{modelValue:e(s).name,"onUpdate:modelValue":t[0]||(t[0]=p=>e(s).name=p),placeholder:e(o)("decorate.micropage.edit.pageNamePlaceholder"),maxlength:"32","show-count":"",size:"lg",ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),l("div",ee,[n(g,{type:"button",variant:"outline",size:"lg",onClick:t[1]||(t[1]=p=>d("close",!1))},{default:i(()=>[h(f(e(o)("console-common.cancel")),1)]),_:1}),n(g,{type:"submit",loading:e(N),size:"lg",icon:"i-lucide-save"},{default:i(()=>[h(f(a.id?e(o)("console-common.update"):e(o)("console-common.create")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"]))]),_:1},8,["title","description"])}}});export{xe as default};
