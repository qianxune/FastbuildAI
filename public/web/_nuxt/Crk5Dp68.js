import{d as C,at as F,i as S,s as N,aN as I,q as P,f,o as p,w as i,c as z,g as a,t as l,B as L,x as m,y as H,A as u,z as r,_ as M}from"#entry";import j from"./4jjeIyfe.js";import{_ as E}from"./D_3bTjYR.js";import{_ as G}from"./BFbGFa2O.js";import{_ as R}from"./bvMLy1sv.js";import{_ as J}from"./DD8ySyt7.js";import{_ as K}from"./Ghlq83yM.js";import{n as O,o as Q,p as W}from"./Dm8J87dm.js";import{d as X,e as Y,f as Z}from"./D2M85Dwf.js";import{c as ee,a as ae,b as h}from"./FTderXKt.js";import"./D9sX2Qi6.js";import"./CBTz8tdX.js";import"./DMoqg0Fd.js";import"./CtosDvS0.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./CuVAPZQ8.js";import"./psimjGaX.js";import"./B3rWqoNg.js";import"./EK7Wbu3-.js";import"./BjKIBNOf.js";import"./9Q2Y_nd6.js";import"./td2xDKru.js";import"./BMSQkwth.js";import"./DaWZu8wl.js";import"./CAQVAH0V.js";import"./Deu6qIfg.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";const te={key:0,class:"flex items-center justify-center",style:{height:"576px"}},oe={class:"flex flex-col gap-4"},ne={class:"h-full min-h-70 w-full"},se={class:"flex items-center gap-3"},ie={class:"text-muted-foreground text-sm"},le={class:"mt-6 flex justify-end gap-2"},Ke=C({__name:"annotation-modal",props:{agentId:{},annotationId:{},hiddenStatus:{type:Boolean},messageId:{},isPublic:{type:Boolean},publishToken:{},accessToken:{},initialData:{}},emits:["close","result"],setup(_,{emit:w}){const e=_,d=w,b=F(),{t}=S(),o=N({question:"",answer:"",enabled:!0}),y=ee({question:h().required("请输入标注问题"),answer:h().required("请输入标注答案"),enabled:ae()}),{lockFn:v,isLock:q}=I(async()=>{try{let n;e.isPublic&&e.publishToken&&e.accessToken?n=await X(e.publishToken,e.accessToken,e.annotationId):n=await O(e.annotationId),o.value={question:n.question,answer:n.answer,enabled:n.enabled}}catch(n){console.error("获取标注详情失败:",n)}}),{lockFn:x,isLock:T}=I(async()=>{try{if(e.annotationId)e.isPublic&&e.publishToken&&e.accessToken?await Y(e.publishToken,e.accessToken,e.annotationId,{...o.value,messageId:e.messageId||void 0}):await Q(e.annotationId,{...o.value,messageId:e.messageId||void 0}),b.success(t("ai-agent.backend.logs.success"));else{let n;e.isPublic&&e.publishToken&&e.accessToken?n=await Z(e.publishToken,e.accessToken,{...o.value,agentId:e.agentId,messageId:e.messageId||void 0}):n=await W(e.agentId,{...o.value,agentId:e.agentId,messageId:e.messageId||void 0}),b.success(t("ai-agent.backend.logs.createAnnotationSuccess")),d("result",n),d("close",!0);return}d("close",!0)}catch(n){console.error(`${e.annotationId?"更新":"创建"}标注失败:`,n)}});return P(async()=>{e.annotationId?v():e.initialData&&(o.value={question:e.initialData.question,answer:e.initialData.answer,enabled:e.initialData.enabled})}),(n,s)=>{const A=L,$=j,g=E,V=G,D=R,k=M,U=J,B=K;return p(),f(B,{title:e.annotationId?a(t)("ai-agent.backend.logs.updateAnnotation"):a(t)("ai-agent.backend.logs.addAnnotation"),description:e.annotationId?a(t)("ai-agent.backend.logs.updateAnnotationDesc"):a(t)("ai-agent.backend.logs.addAnnotationDesc"),ui:{content:"max-w-xl"},onClose:s[4]||(s[4]=c=>d("close"))},{default:i(()=>[a(q)?(p(),z("div",te,[l(A,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):(p(),f(U,{key:1,schema:a(y),state:a(o),class:"space-y-4",onSubmit:a(x)},{default:i(()=>[m("div",oe,[l(g,{label:a(t)("ai-agent.backend.logs.question"),name:"question",required:""},{hint:i(()=>[u(r(a(t)("ai-agent.backend.logs.questionHint")),1)]),default:i(()=>[l($,{modelValue:a(o).question,"onUpdate:modelValue":s[0]||(s[0]=c=>a(o).question=c),placeholder:a(t)("ai-agent.backend.logs.questionPlaceholder"),rows:5,ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(g,{label:a(t)("ai-agent.backend.logs.answer"),name:"answer",required:""},{hint:i(()=>[u(r(a(t)("ai-agent.backend.logs.answerHint")),1)]),default:i(()=>[m("div",ne,[l(V,{modelValue:a(o).answer,"onUpdate:modelValue":s[1]||(s[1]=c=>a(o).answer=c),"custom-class":"!min-h-70 "},null,8,["modelValue"])])]),_:1},8,["label"]),_.hiddenStatus?(p(),f(g,{key:0,label:a(t)("ai-agent.backend.logs.enabled"),name:"enabled"},{hint:i(()=>[u(r(a(t)("ai-agent.backend.logs.enabledHint")),1)]),default:i(()=>[m("div",se,[l(D,{modelValue:a(o).enabled,"onUpdate:modelValue":s[2]||(s[2]=c=>a(o).enabled=c),color:"primary"},null,8,["modelValue"]),m("span",ie,r(a(o).enabled?a(t)("console-common.enabled"):a(t)("console-common.disabled")),1)])]),_:1},8,["label"])):H("",!0)]),m("div",le,[l(k,{color:"neutral",variant:"soft",size:"lg",onClick:s[3]||(s[3]=c=>d("close"))},{default:i(()=>[u(r(a(t)("console-common.cancel")),1)]),_:1}),l(k,{color:"primary",size:"lg",loading:a(T),type:"submit"},{default:i(()=>[u(r(e.annotationId?a(t)("console-common.update"):a(t)("console-common.create")),1)]),_:1},8,["loading"])])]),_:1},8,["schema","state","onSubmit"]))]),_:1},8,["title","description"])}}});export{Ke as default};
