import{d as A,i as K,at as R,av as L,k as M,a2 as T,n as F,q as I,c as D,o as N,x as p,t as c,g as e,w as f,_ as q,A as G,z as d,h as t,B as j,G as E}from"#entry";import{_ as H}from"./bvMLy1sv.js";import{_ as J}from"./hsuWSsy6.js";import O from"./cd55qm53.js";import{_ as Q}from"./CvI6s-qz.js";import{_ as W}from"./B5gsc-Ax.js";import{_ as X}from"./JxyxsHxp.js";import{_ as Y}from"./D4ebF709.js";import{u as _}from"./CxvgZo8z.js";import{a as Z,e as ee,f as se}from"./B9ZIqvFb.js";import{u as oe}from"./BlyoSzaa.js";import{u as te}from"./ZDOPDbaX.js";import{u as le}from"./CSy6ZCzT.js";import"./D9sX2Qi6.js";import"./CAQVAH0V.js";import"./Deu6qIfg.js";import"./DMoqg0Fd.js";import"./CtosDvS0.js";import"./kRIii9yh.js";import"./DNSLGqNg.js";import"./Z7qkLoXK.js";import"./C6Y-ieo6.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./CuVAPZQ8.js";import"./psimjGaX.js";import"./BstbYvQo.js";import"./o0-e7Rye.js";import"./abPSHzII.js";const ae={class:"role-list-container pb-5"},re={class:"bg-background sticky top-0 z-10 flex flex-wrap gap-4 pb-4"},ie={class:"flex items-end gap-2 md:ml-auto"},ne={class:"mt-auto flex items-center justify-between gap-3 pt-4"},ce={class:"text-muted text-sm"},me={class:"flex items-center gap-1.5"},je=A({__name:"list",setup(pe){const u=q,y=H,x=E,C=J,w=j,{t:o}=K(),$=R(),v=L(),{hasAccessByCodes:g}=oe(),h=M("table"),m=T({name:"",status:void 0}),{paging:r,getLists:n}=te({fetchFun:Z,params:m}),a=F(()=>({level:o("membership.console-membership.level.table.level"),icon:o("membership.console-membership.level.table.icon"),name:o("membership.console-membership.level.table.name"),description:o("membership.console-membership.level.table.description"),givePower:o("membership.console-membership.level.table.givePower"),accountCount:o("membership.console-membership.level.table.accountCount"),status:o("membership.console-membership.level.table.status"),actions:o("membership.console-membership.level.table.actions")})),U=[{accessorKey:"level",header:()=>t("div",{class:"flex items-center gap-1"},[t("span",`${a.value.level}`),t(C,{mode:"hover"},{default:()=>t(w,{name:"i-lucide-circle-help",class:"size-4 cursor-pointer text-muted-foreground"}),content:()=>t("p",{class:"text-sm py-2 px-4 w-64"},o("membership.console-membership.level.table.levelTip"))})]),cell:({row:s})=>t("p",{class:""},s.original.level+"级")},{accessorKey:"icon",header:()=>t("p",{class:""},`${a.value.icon}`),cell:({row:s})=>t(x,{src:s.original.icon,alt:s.original.name,ui:{root:"rounded-sm"}})},{accessorKey:"name",header:()=>t("p",{class:""},`${a.value.name}`),cell:({row:s})=>t("p",{class:""},s.original.name)},{accessorKey:"description",header:()=>t("p",{class:""},`${a.value.description}`),cell:({row:s})=>t("p",{class:""},s.original.description)},{accessorKey:"givePower",header:()=>t("p",{class:""},`${a.value.givePower}`),cell:({row:s})=>t("p",{class:""},s.original.givePower)},{accessorKey:"accountCount",header:()=>t("p",{class:""},`${a.value.accountCount}`)},{accessorKey:"status",header:()=>t("p",{class:""},`${a.value.status}`),cell:({row:s})=>t(y,{modelValue:s.original.status,size:"sm","onUpdate:modelValue":l=>{P(s.original.id,l)}})},{id:"actions",header:()=>t("p",{class:""},`${a.value.actions}`),size:40,enableSorting:!1,enableHiding:!1,cell:({row:s})=>t("div",{class:"flex items-center gap-1"},[g(["level:update"])?t(u,{icon:"i-lucide-pen-line",color:"primary",variant:"ghost",size:"xs",label:o("console-common.edit"),onClick:()=>{v.push({path:_("levels:update"),query:{id:s.original.id}})}}):null,g(["level:delete"])?t(u,{icon:"i-lucide-trash",color:"error",variant:"ghost",size:"xs",label:o("console-common.delete"),onClick:()=>{z(s.original.id)}}):null].filter(Boolean))}],z=async s=>{try{await le({title:o("membership.console-membership.level.deleteTitle"),description:o("membership.console-membership.level.deleteMsg"),color:"error"}),await ee(s),n()}catch(l){console.error("删除失败:",l)}},P=async(s,l)=>{try{await se(s,{status:l}),n(),$.success(o("membership.console-membership.level.updateStatusSuccess"))}catch(b){console.error("更新状态失败:",b)}};return I(()=>n()),(s,l)=>{const b=O,S=Q,V=W,k=X,B=Y;return N(),D("div",ae,[p("div",re,[c(b,{modelValue:e(m).name,"onUpdate:modelValue":l[0]||(l[0]=i=>e(m).name=i),placeholder:e(o)("membership.console-membership.level.nameInput"),class:"w-48",onChange:e(n)},null,8,["modelValue","placeholder","onChange"]),c(S,{modelValue:e(m).status,"onUpdate:modelValue":l[1]||(l[1]=i=>e(m).status=i),placeholder:e(o)("membership.console-membership.level.status"),items:[{label:e(o)("membership.console-membership.level.select.all"),value:void 0},{label:e(o)("membership.console-membership.level.select.active"),value:!0},{label:e(o)("membership.console-membership.level.select.inactive"),value:!1}],class:"w-48",onChange:e(n)},null,8,["modelValue","placeholder","items","onChange"]),p("div",ie,[c(V,{codes:["level:create"]},{default:f(()=>[c(e(u),{icon:"i-heroicons-plus",color:"primary",onClick:l[2]||(l[2]=()=>{e(v).push({path:("useRoutePath"in s?s.useRoutePath:e(_))("levels:create")})})},{default:f(()=>[G(d(e(o)("membership.console-membership.level.add")),1)]),_:1})]),_:1})])]),c(k,{loading:e(r).loading,data:e(r).items,columns:U,class:"h-[calc(100vh-13rem)] shrink-0",ref_key:"table",ref:h,selectable:"",ui:{base:"table-fixed border-separate border-spacing-0",thead:"[&>tr]:bg-elevated/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-2 first:rounded-l-lg last:rounded-r-lg border-y border-default first:border-l last:border-r",td:"border-b border-default"}},null,8,["loading","data"]),p("div",ne,[p("div",ce,d(e(h)?.tableApi?.getFilteredSelectedRowModel().rows.length||0)+" / "+d(e(h)?.tableApi?.getFilteredRowModel().rows.length||0)+" "+d(e(o)("console-common.selected"))+". ",1),p("div",me,[c(B,{page:e(r).page,"onUpdate:page":l[3]||(l[3]=i=>e(r).page=i),size:e(r).pageSize,"onUpdate:size":l[4]||(l[4]=i=>e(r).pageSize=i),total:e(r).total,onChange:e(n)},null,8,["page","size","total","onChange"])])])])}}});export{je as default};
