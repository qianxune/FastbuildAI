const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./DQmZhS0g.js","./Cgyg1gJC.js","./cd55qm53.js","./CnxT3uvZ.js","./DbqqhwXM.js","./DNSLGqNg.js","./psimjGaX.js","./CuVAPZQ8.js","./B3rWqoNg.js","./EK7Wbu3-.js","./TrJvDfxI.js","./jsPNKUA0.js","./o4ws_w_T.js","./C21eG_hD.js","./Cie-o9Wa.js","./abPSHzII.js","./CSEmak9l.js","./bvMLy1sv.js","./D9sX2Qi6.js","./CAQVAH0V.js","./Deu6qIfg.js","./CAzYbiPj.js","./D_3bTjYR.js"])))=>i.map(i=>d[i]);
import{d as S,aM as F,n as A,at as G,i as X,s as m,aX as b,W as y,bv as D,a2 as q,q as H,c,o as i,x as t,z as l,f as I,g as s,w as E,t as o,A as v,B as Q,F as $,_ as W,E as J,C as Y,y as Z,au as ee,X as k}from"#entry";import{g as ae}from"./Dm8J87dm.js";import{a as te,b as se,c as ne}from"./D2M85Dwf.js";const ie={class:"flex h-full flex-1 flex-col px-4 pt-4"},le={class:"mb-2"},oe={class:"flex items-center justify-between"},ue={class:"text-2xl font-bold"},ce={class:"text-muted-foreground mt-1 text-sm"},re={class:"flex gap-2"},de={key:0,class:"flex h-64 items-center justify-center"},pe={class:"text-muted-foreground flex items-center gap-2"},me={key:1,class:"flex h-full min-h-0 flex-1 flex-col"},be={class:"flex border-b"},ve=["onClick"],fe={class:"flex-1 overflow-auto p-4"},xe=S({__name:"publish",setup(he){const K=y(()=>k(()=>import("./DQmZhS0g.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]),import.meta.url)),V=y(()=>k(()=>import("./C21eG_hD.js"),__vite__mapDeps([13,1,3,4,5,6,7,8,9,10,11,14,15]),import.meta.url)),z=y(()=>k(()=>import("./CSEmak9l.js"),__vite__mapDeps([16,1,2,17,18,19,20]),import.meta.url)),B=y(()=>k(()=>import("./CAzYbiPj.js"),__vite__mapDeps([21,1,12,2,3,4,5,6,7,8,9,10,11,22,18]),import.meta.url)),{params:L}=F(),n=A(()=>L.id),x=G(),{t:r}=X(),C=m(!1),u=m(!1),a=m(),f=m("status"),h=m([{value:"status",label:r("ai-agent.backend.publish.status"),icon:"i-lucide-globe",component:b(B)},{value:"settings",label:r("ai-agent.backend.publish.settings"),icon:"i-lucide-settings",component:b(z)},{value:"embed",label:r("ai-agent.backend.publish.embed"),icon:"i-lucide-code",component:b(V)},{value:"api",label:r("ai-agent.backend.publish.api"),icon:"i-lucide-terminal",component:b(K)}]),R=D("ai-agent:publish:tabs").value.map(e=>({value:e.meta?.value,label:r(e.meta?.label),icon:e.meta?.icon,component:b(e.component)}));console.log(R,D("ai-agent:publish:tabs")),h.value=[...h.value,...R];const T=A(()=>h.value.find(e=>e.value===f.value)?.component),g=q({allowOrigins:[],rateLimitPerMinute:60,showBranding:!0,allowDownloadHistory:!1}),_=async()=>{if(n.value)try{C.value=!0;const e=await ae(n.value);a.value=e,e.publishConfig&&Object.assign(g,e.publishConfig)}catch(e){console.error("加载智能体信息失败:",e)}finally{C.value=!1}},O=async()=>{if(n.value)try{u.value=!0;const e={publishConfig:{...g}},w=await ne(n.value,e);a.value&&(a.value.isPublished=!0,a.value.publishToken=w.publishToken,a.value.apiKey=w.apiKey,a.value.publishConfig=g),await _(),x.success("智能体发布成功！"),f.value="status"}catch(e){console.error("发布智能体失败:",e)}finally{u.value=!1}},U=async()=>{if(n.value)try{u.value=!0,await te(n.value),a.value&&(a.value.isPublished=!1,a.value.publishToken=void 0,a.value.apiKey=void 0,a.value.publishConfig=void 0),await _(),x.success("已取消发布")}catch(e){console.error("取消发布智能体失败:",e)}finally{u.value=!1}},j=async()=>{if(n.value)try{const e=await se(n.value);a.value&&(a.value.apiKey=e.apiKey),await _(),x.success("API密钥重新生成成功")}catch(e){console.error("重新生成API密钥失败:",e)}},M=e=>{Object.assign(g,e)},N=A(()=>a.value?.isPublished||!1);return H(()=>_()),(e,w)=>{const d=Q,P=W;return i(),c("div",ie,[t("div",le,[t("div",oe,[t("div",null,[t("h1",ue,l(e.$t("ai-agent.backend.publish.title")),1),t("p",ce,l(e.$t("ai-agent.backend.publish.desc")),1)]),t("div",re,[s(N)?(i(),c($,{key:1},[o(P,{variant:"outline",onClick:j},{default:E(()=>[o(d,{name:"i-lucide-refresh-cw",class:"mr-2 size-4"}),v(" "+l(e.$t("ai-agent.backend.publish.regenerateApiKey")),1)]),_:1}),o(P,{color:"error",variant:"outline",loading:s(u),onClick:U},{default:E(()=>[o(d,{name:"i-lucide-globe-lock",class:"mr-2 size-4"}),v(" "+l(e.$t("ai-agent.backend.publish.unpublish")),1)]),_:1},8,["loading"])],64)):(i(),I(P,{key:0,loading:s(u),onClick:O},{default:E(()=>[o(d,{name:"i-lucide-globe",class:"mr-2 size-4"}),v(" "+l(e.$t("ai-agent.backend.publish.publish")),1)]),_:1},8,["loading"]))])])]),s(C)?(i(),c("div",de,[t("div",pe,[o(d,{name:"i-lucide-loader-2",class:"size-4 animate-spin"}),v(" "+l(e.$t("ai-agent.backend.publish.loading")),1)])])):(i(),c("div",me,[t("div",be,[(i(!0),c($,null,J(s(h),p=>(i(),c("button",{key:p.value,class:Y(["flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors",s(f)===p.value?"border-primary text-primary border-b-2":"text-muted-foreground hover:text-foreground"]),onClick:ge=>f.value=p.value},[o(d,{name:p.icon,class:"size-4"},null,8,["name"]),v(" "+l(p.label),1)],10,ve))),128))]),t("div",fe,[s(T)?(i(),I(ee(s(T)),{key:0,agent:s(a),onUpdate:M},null,40,["agent"])):Z("",!0)])]))])}}});export{xe as default};
