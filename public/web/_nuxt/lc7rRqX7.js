const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./BNPcOkaj.js","./Cgyg1gJC.js","./DLRgSyms.js","./cd55qm53.js","./D_3bTjYR.js","./D9sX2Qi6.js","./4jjeIyfe.js","./DOOZ3wAl.js","./o4ws_w_T.js","./DbqqhwXM.js","./DNSLGqNg.js","./psimjGaX.js","./CuVAPZQ8.js","./B3rWqoNg.js","./EK7Wbu3-.js","./Cub7JM7Q.js","./hsuWSsy6.js","./DMoqg0Fd.js","./CtosDvS0.js","./kRIii9yh.js","./Z7qkLoXK.js","./C6Y-ieo6.js","./BFo3vNrE.js","./DeCyaT7k.js","./D4e4FYoF.js","./BCcN9pii.js","./CMKSl-Ng.js","./Cie-o9Wa.js","./jsPNKUA0.js","./abPSHzII.js","./D7VOTB3C.js","./B0g9CpkI.js","./shdu-Ndv.js","./CUSM-UXi.js","./gu2_Ts15.js","./DlFmb4IA.js","./ZDOPDbaX.js","./B-cZF5FC.js","./BzLCLO6P.js"])))=>i.map(i=>d[i]);
import{i as M,l as y,d as T,at as A,av as U,a2 as L,aN as V,q as B,c as _,o as S,x as u,t as p,g as e,_ as N,W as g,H as D,y as W,I as E,X as f,aO as $}from"#entry";import{u as C}from"./CxvgZo8z.js";import{y as z,z as F,A as K}from"./gu2_Ts15.js";function j(h=1){const{t:r}=M(),l=[{id:1,title:r("ai-datasets.backend.create.step.one")},{id:2,title:r("ai-datasets.backend.create.step.two")},{id:3,title:r("ai-datasets.backend.create.step.three")}],o=y(h);return{step:o,STEPS:l,nextStep:()=>{o.value<l.length&&(o.value+=1)},changeStep:c=>{const d=o.value+c;d>=1&&d<=l.length&&(o.value=d)}}}const q={class:"create-dataset-container flex h-full flex-col"},H={class:"bg-background sticky top-0 z-10 flex"},X={class:"container mx-auto h-full pb-6"},G={class:"flex h-full min-h-0 w-full"},J={class:"flex h-full min-h-0 w-full"},Q={key:0,class:"flex h-full min-h-0 w-full"},te=T({__name:"index",props:{id:{},datasetsDetail:{}},setup(h){const r=g(()=>f(()=>import("./BNPcOkaj.js"),__vite__mapDeps([0,1]),import.meta.url)),l=g(()=>f(()=>import("./DLRgSyms.js"),__vite__mapDeps([2,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32]),import.meta.url)),o=g(()=>f(()=>import("./CUSM-UXi.js"),__vite__mapDeps([33,1,27,28,29,34]),import.meta.url)),v=g(()=>f(()=>import("./DlFmb4IA.js"),__vite__mapDeps([35,1,32,34,36,37,38]),import.meta.url)),i=h,c=A(),d=U(),{t:I}=M(),{step:m,STEPS:k,nextStep:b,changeStep:w}=j(),t=L({indexingConfig:{documentMode:"normal",parentContextMode:"paragraph",segmentation:{segmentIdentifier:"\\n\\n",maxSegmentLength:1024,segmentOverlap:50},subSegmentation:{segmentIdentifier:"\\n",maxSegmentLength:512},preprocessingRules:{replaceConsecutiveWhitespace:!1,removeUrlsAndEmails:!1},fileIds:[]},name:"",description:"",embeddingModelId:"",retrievalConfig:{retrievalMode:"hybrid",strategy:"weighted_score",topK:3,scoreThreshold:.5,scoreThresholdEnabled:!1,weightConfig:{semanticWeight:.7,keywordWeight:.3},rerankConfig:{enabled:!1,modelId:""}}}),x=y(i.id??""),{lockFn:O}=V(async()=>{try{if(i.id){const{indexingConfig:a}=t,n={indexingConfig:a,datasetId:i.id,embeddingModelId:t.embeddingModelId};await F(n),$(`dataset-detail-${i.id}`)}else{const a=await K(t);x.value=a.id}b()}catch(a){console.log("创建错误 => ",a)}}),P=async()=>{if(!t.name||!t.name.trim()){c.error(I("ai-datasets.backend.settings.nameInput"));return}if(!t.description||!t.description.trim()){c.error(I("ai-datasets.backend.settings.descriptionInput"));return}if(!t.embeddingModelId){c.error(I("ai-datasets.backend.settings.embeddingModelInput"));return}try{const a=await z({name:t.name,description:t.description,embeddingModelId:t.embeddingModelId});d.replace(C("ai-datasets-documents:list",{id:a.id}))}catch(a){console.error("创建空知识库失败",a)}};return B(()=>{if(!i.id&&!i.datasetsDetail?.id)return!1;const a=i.datasetsDetail;Reflect.ownKeys(t).forEach(n=>{a&&Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a?.[n]??t[n])}),t.indexingConfig.fileIds=[]}),(a,n)=>{const R=N;return S(),_("div",q,[u("div",H,[p(R,{class:"absolute top-1/2 -translate-y-[50%]",variant:"link",color:"neutral",label:a.$t("ai-datasets.backend.dataset.title"),"leading-icon":"i-lucide-chevron-left",onClick:n[0]||(n[0]=s=>e(d).replace(i.id?("useRoutePath"in a?a.useRoutePath:e(C))("ai-datasets-documents:list",{id:i.id}):("useRoutePath"in a?a.useRoutePath:e(C))("ai-datasets:list")))},null,8,["label"]),p(e(r),{steps:e(k),activeIndex:e(m)},null,8,["steps","activeIndex"])]),u("div",X,[D(u("div",G,[p(e(l),{fileIds:e(t).indexingConfig.fileIds,"onUpdate:fileIds":n[1]||(n[1]=s=>e(t).indexingConfig.fileIds=s),name:e(t).name,"onUpdate:name":n[2]||(n[2]=s=>e(t).name=s),description:e(t).description,"onUpdate:description":n[3]||(n[3]=s=>e(t).description=s),embeddingModelId:e(t).embeddingModelId,"onUpdate:embeddingModelId":n[4]||(n[4]=s=>e(t).embeddingModelId=s),disabled:!!i.id,onOnStepChange:e(b),onCreateEmpty:P},null,8,["fileIds","name","description","embeddingModelId","disabled","onOnStepChange"])],512),[[E,e(m)===1]]),D(u("div",J,[p(e(o),{indexingConfig:e(t).indexingConfig,"onUpdate:indexingConfig":n[5]||(n[5]=s=>e(t).indexingConfig=s),retrievalConfig:e(t).retrievalConfig,"onUpdate:retrievalConfig":n[6]||(n[6]=s=>e(t).retrievalConfig=s),disabled:!!i.datasetsDetail?.documentCount,onOnStepChange:e(w),onOnCreate:e(O)},null,8,["indexingConfig","retrievalConfig","disabled","onOnStepChange","onOnCreate"])],512),[[E,e(m)===2]]),e(m)===3?(S(),_("div",Q,[p(e(v),{datasetsId:e(x),createData:e(t),isAddDocument:!!i.id,fileIds:e(t).indexingConfig.fileIds},null,8,["datasetsId","createData","isAddDocument","fileIds"])])):W("",!0)])])}}});export{te as default};
