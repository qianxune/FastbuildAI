import{d as P,at as F,i as E,av as B,aM as A,aQ as M,n as q,aN as I,q as N,c as j,f as L,g as e,o as w,t,B as z,w as r,x as l,G,z as d,D as W,A as k,_ as O}from"#entry";import{_ as Q}from"./bvMLy1sv.js";import Y from"./cd55qm53.js";import{_ as J}from"./D_3bTjYR.js";import{_ as X}from"./Co1Njv5N.js";import Z from"./4jjeIyfe.js";import{_ as ee}from"./DD8ySyt7.js";import{a as oe,M as ae,P as U}from"./CClQHGwT.js";import{P as ne,a as te,b as ie}from"./DqafFsSA.js";import{c as T,e as le,b as m}from"./FTderXKt.js";import"./D9sX2Qi6.js";import"./CAQVAH0V.js";import"./Deu6qIfg.js";import"./CtosDvS0.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./DBEJUH-Z.js";import"./CuVAPZQ8.js";import"./DaWZu8wl.js";const se={key:0,class:"flex justify-center py-12"},re={class:"grid grid-cols-1 gap-8 p-1 lg:grid-cols-3"},ce={class:"shadow-default h-fit rounded-lg lg:col-span-1"},me={class:"flex flex-col items-center space-y-4",style:{padding:"80px 24px 40px"}},de={class:"flex items-start gap-4"},pe={class:"mt-6 px-12 text-center text-xs"},fe={class:"text-muted-foreground"},ue={class:"mt-6 flex w-full items-center justify-between"},ye={class:"text-secondary-foreground text-sm font-medium"},ge={class:"text-muted-foreground mt-2 text-xs"},_e={class:"mt-6 flex w-full items-center justify-between"},he={class:"text-secondary-foreground text-sm font-medium"},be={class:"text-muted-foreground mt-2 text-xs"},Ve={class:"shadow-default space-y-6 rounded-lg p-6 lg:col-span-2"},ve={class:"grid grid-cols-1 gap-6 md:grid-cols-2"},xe={class:"flex justify-end gap-4"},je=P({__name:"wechat-pay",setup(qe){const f=F(),{t:o}=E(),u=B(),K=A(),a=M({id:"",name:"",logo:"",isEnable:0,isDefault:0,sort:0,payType:U.WECHAT,config:{appId:"",mchId:"",apiKey:"",paySignKey:"",cert:"",payAuthDir:"",merchantType:ae.ORDINARY,payVersion:oe.V3}}),y=q(()=>{const s=a.payType;return ne[s]??"未知支付方式"}),_=q(()=>K.query.id),{lockFn:D,isLock:g}=I(async()=>{if(!_.value){f.error(o("payment-config.form.getPayconfigDetailFailedHelp")),u.back();return}try{const s=await te(_.value,U.WECHAT);a.id=s.id,a.name=s.name,a.logo=s.logo,a.isEnable=s.isEnable,a.isDefault=s.isDefault,a.sort=s.sort,s.config&&(a.config=s.config)}catch{f.error(o("payment-config.form.getPayconfigDetailFailed")),u.back()}});N(()=>{D()});const{lockFn:R,isLock:h}=I(async()=>{try{await ie(a),f.success(o("payment-config.form.updateSuccess")),u.back()}catch(s){f.error(o("payment-config.form.updateFailed")),console.log(s)}}),S=T({name:m().required(o("payment-config.validation.nameRequired")),sort:le().required(o("payment-config.validation.sortRequired")),config:T({payVersion:m().required(o("payment-config.validation.payVersionRequired")),merchantType:m().required(o("payment-config.validation.merchantTypeRequired")),mchId:m().required(o("payment-config.validation.mchIdRequired")),apiKey:m().required(o("payment-config.validation.apiKeyRequired")),paySignKey:m().required(o("payment-config.validation.paySignKeyRequired")),cert:m().required(o("payment-config.validation.certRequired")),appId:m().required(o("payment-config.validation.appIdRequired"))}).required()});return(s,n)=>{const H=z,$=G,b=Q,p=Y,c=J,V=X,v=Z,x=O,C=ee;return e(g)?(w(),j("div",se,[t(H,{name:"i-lucide-loader-2",class:"text-primary-500 h-8 w-8 animate-spin"})])):(w(),L(C,{key:1,state:e(a),schema:e(S),class:"space-y-8",onSubmit:e(R)},{default:r(()=>[l("div",re,[l("div",ce,[l("div",me,[l("div",de,[t($,{src:e(a).logo,alt:"WeChat pay",class:"h-32 w-32",ui:{root:"rounded-lg"}},null,8,["src"])]),l("div",pe,[l("p",fe,d(e(o)("payment-config.form.avatarFormats")),1)]),l("div",ue,[l("div",null,[l("h4",ye,d(e(o)("payment-config.form.enable")),1),l("p",ge,d(e(o)("payment-config.form.enableHelp")),1)]),t(b,{"model-value":!!e(a).isEnable,"unchecked-icon":"i-lucide-x","checked-icon":"i-lucide-check",onChange:n[0]||(n[0]=i=>{e(a).isEnable=e(a).isEnable?0:1})},null,8,["model-value"])]),l("div",_e,[l("div",null,[l("h4",he,d(e(o)("payment-config.form.isDefault")),1),l("p",be,d(e(o)("payment-config.form.isDefaultHelp")),1)]),t(b,{"model-value":!!e(a).isDefault,"unchecked-icon":"i-lucide-x","checked-icon":"i-lucide-check",onChange:n[1]||(n[1]=i=>{e(a).isDefault=e(a).isDefault?0:1})},null,8,["model-value"])])])]),l("div",Ve,[l("div",ve,[t(c,{label:e(o)("payment-config.form.payway"),name:"payway"},{default:r(()=>[t(p,{modelValue:e(y),"onUpdate:modelValue":n[2]||(n[2]=i=>W(y)?y.value=i:null),placeholder:e(o)("payment-config.form.payway"),disabled:!0,variant:"subtle",class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(c,{label:e(o)("payment-config.form.name"),name:"name",required:""},{default:r(()=>[t(p,{modelValue:e(a).name,"onUpdate:modelValue":n[3]||(n[3]=i=>e(a).name=i),placeholder:e(o)("payment-config.form.nameInput"),class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(c,{label:e(o)("payment-config.form.payVersion"),description:e(o)("payment-config.form.payVersionHelp"),name:"config.payVersion",required:""},{default:r(()=>[t(V,{modelValue:e(a).config.payVersion,"onUpdate:modelValue":n[4]||(n[4]=i=>e(a).config.payVersion=i),items:["V3"]},null,8,["modelValue"])]),_:1},8,["label","description"]),t(c,{label:e(o)("payment-config.form.merchantType"),description:e(o)("payment-config.form.merchantTypeHelp"),name:"config.merchantType",required:""},{default:r(()=>[t(V,{modelValue:e(a).config.merchantType,"onUpdate:modelValue":n[5]||(n[5]=i=>e(a).config.merchantType=i),items:[{label:e(o)("payment-config.form.merchantTypeOptions.ordinary"),value:"ordinary"}]},null,8,["modelValue","items"])]),_:1},8,["label","description"]),t(c,{label:e(o)("payment-config.form.mchId"),name:"config.mchId",required:"",description:e(o)("payment-config.form.mchIdHelp")},{default:r(()=>[t(p,{modelValue:e(a).config.mchId,"onUpdate:modelValue":n[6]||(n[6]=i=>e(a).config.mchId=i),placeholder:e(o)("payment-config.form.mchIdInput"),class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label","description"]),t(c,{label:e(o)("payment-config.form.apiKey"),name:"config.apiKey",required:"",description:e(o)("payment-config.form.apiKeyHelp")},{default:r(()=>[t(p,{modelValue:e(a).config.apiKey,"onUpdate:modelValue":n[7]||(n[7]=i=>e(a).config.apiKey=i),placeholder:e(o)("payment-config.form.apiKeyInput"),class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label","description"]),t(c,{label:e(o)("payment-config.form.cert"),name:"config.cert",required:"",description:e(o)("payment-config.form.certHelp")},{default:r(()=>[t(v,{modelValue:e(a).config.cert,"onUpdate:modelValue":n[8]||(n[8]=i=>e(a).config.cert=i),placeholder:e(o)("payment-config.form.certInput"),class:"w-full",autoresize:"",maxrows:3},null,8,["modelValue","placeholder"])]),_:1},8,["label","description"]),t(c,{label:e(o)("payment-config.form.paySignKey"),name:"config.paySignKey",required:"",description:e(o)("payment-config.form.paySignKeyHelp")},{default:r(()=>[t(v,{modelValue:e(a).config.paySignKey,"onUpdate:modelValue":n[9]||(n[9]=i=>e(a).config.paySignKey=i),placeholder:e(o)("payment-config.form.paySignKeyInput"),class:"w-full",autoresize:"",maxrows:3},null,8,["modelValue","placeholder"])]),_:1},8,["label","description"]),t(c,{label:e(o)("payment-config.form.appId"),name:"config.appId",required:"",description:e(o)("payment-config.form.appIdHelp")},{default:r(()=>[t(p,{modelValue:e(a).config.appId,"onUpdate:modelValue":n[10]||(n[10]=i=>e(a).config.appId=i),placeholder:e(o)("payment-config.form.appIdInput"),class:"w-full"},null,8,["modelValue","placeholder"])]),_:1},8,["label","description"]),t(c,{label:e(o)("payment-config.form.sort"),name:"sort",required:"",description:e(o)("payment-config.form.sortHelp")},{default:r(()=>[t(p,{modelValue:e(a).sort,"onUpdate:modelValue":n[11]||(n[11]=i=>e(a).sort=i),class:"w-full"},null,8,["modelValue"])]),_:1},8,["label","description"])]),l("div",xe,[t(x,{color:"neutral",variant:"outline",onClick:n[12]||(n[12]=i=>e(u).back()),class:"px-8",loading:e(g)||e(h)},{default:r(()=>[k(d(e(o)("console-common.cancel")),1)]),_:1},8,["loading"]),t(x,{color:"primary",loading:e(g)||e(h),type:"submit",class:"px-8"},{default:r(()=>[k(d(e(o)("console-common.update")),1)]),_:1},8,["loading"])])])])]),_:1},8,["state","schema","onSubmit"]))}}});export{je as default};
