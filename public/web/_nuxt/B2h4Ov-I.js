import{d as B,i as C,s as A,aN as f,q as D,f as N,o as y,w as r,c as R,y as z,t as a,g as e,B as S,x as q,_ as L,A as $,z as b,at as p}from"#entry";import M from"./cd55qm53.js";import{_ as j}from"./D_3bTjYR.js";import T from"./4jjeIyfe.js";import{_ as E}from"./DD8ySyt7.js";import{_ as G}from"./Ghlq83yM.js";import{a as H,c as J,d as K}from"./DPO6KOvV.js";import{c as O,b as P}from"./FTderXKt.js";import"./D9sX2Qi6.js";import"./DQMjdCEn.js";import"./OUYfsp1i.js";import"./BFo3vNrE.js";import"./CuVAPZQ8.js";import"./Z7qkLoXK.js";import"./CjE5iPSn.js";import"./D9UsdH-b.js";import"./MCK2d4XT.js";import"./EK7Wbu3-.js";import"./DaWZu8wl.js";const Q={key:0,class:"flex items-center justify-center py-10"},W={class:"mt-10 flex justify-end gap-2"},ye=B({__name:"edit",props:{id:{}},emits:["close"],setup(g,{emit:k}){const i=k,l=g,{t:o}=C(),t=A({id:l.id,name:"",description:""}),V=O({name:P().required(o("system-perms.role.nameInput"))}),{lockFn:v,isLock:w}=f(async()=>{try{const{createdAt:n,updatedAt:s,permissions:d,...c}=await H(l.id);t.value=c}catch(n){console.error("获取详情失败:",n),p().error(o("system-perms.role.getRoleFailed"))}}),{lockFn:x,isLock:U}=f(async()=>{try{l.id?await J({...t.value,id:t.value.id}):await K(t.value),p().success(o("system-perms.role.success")),i("close",!0)}catch(n){console.error("提交失败:",n),p().error(o("system-perms.role.error"))}});return D(()=>l.id&&v()),(n,s)=>{const d=S,c=M,u=j,F=T,_=L,I=E,h=G;return y(),N(h,{title:e(o)("system-perms.role.roleInfo"),description:e(o)("system-perms.role.roleInfoDesc"),ui:{content:"max-w-md"},onClose:s[3]||(s[3]=m=>i("close",!1))},{default:r(()=>[e(w)?(y(),R("div",Q,[a(d,{name:"i-lucide-loader-2",class:"size-8 animate-spin"})])):z("",!0),a(I,{state:e(t),schema:e(V),class:"space-y-4",onSubmit:e(x)},{default:r(()=>[a(u,{label:e(o)("system-perms.role.name"),name:"name",required:""},{default:r(()=>[a(c,{modelValue:e(t).name,"onUpdate:modelValue":s[0]||(s[0]=m=>e(t).name=m),placeholder:e(o)("system-perms.role.nameInput"),ui:{root:"w-full"}},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),a(u,{label:e(o)("system-perms.role.describe"),name:"description"},{default:r(()=>[a(F,{modelValue:e(t).description,"onUpdate:modelValue":s[1]||(s[1]=m=>e(t).description=m),ui:{root:"w-full"},placeholder:e(o)("system-perms.role.descriptionInput")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),q("div",W,[a(_,{color:"neutral",variant:"soft",size:"lg",onClick:s[2]||(s[2]=m=>i("close",!1))},{default:r(()=>[$(b(e(o)("console-common.cancel")),1)]),_:1}),a(_,{color:"primary",size:"lg",type:"submit",loading:e(U)},{default:r(()=>[$(b(e(o)("console-common.confirm")),1)]),_:1},8,["loading"])])]),_:1},8,["state","schema","onSubmit"])]),_:1},8,["title","description"])}}});export{ye as default};
