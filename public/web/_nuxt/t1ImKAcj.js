import{aF as Q,d as X,b7 as Y,b6 as Z,at as ee,i as te,n as b,s as se,l as D,q as ae,p as oe,f as T,o as h,w as u,x as e,t as n,z as s,g as t,y,B as le,C,A as g,D as L,c as x,F as M,E as R}from"#entry";import{_ as re}from"./DBiaUVBh.js";import{_ as ne}from"./BPj_g5mx.js";import{_ as ie}from"./CvI6s-qz.js";import{_ as de}from"./DBaba_Ev.js";import{_ as ce}from"./DO9M7gn1.js";import{_ as he}from"./Cie-o9Wa.js";import{g as ue}from"./CVgfx1_c.js";import{f as V}from"./DUoaAyrs.js";import"./CtosDvS0.js";import"./CAQVAH0V.js";import"./DNSLGqNg.js";import"./BFo3vNrE.js";import"./DeCyaT7k.js";import"./D4e4FYoF.js";import"./Z7qkLoXK.js";import"./BstbYvQo.js";import"./CuVAPZQ8.js";import"./TrJvDfxI.js";import"./jsPNKUA0.js";import"./abPSHzII.js";import"./BCcN9pii.js";import"./CMKSl-Ng.js";import"./DBEJUH-Z.js";import"./o4ws_w_T.js";function me(A){return Q("/analyse/dashboard",A)}const _e={class:"flex h-[calc(100svh-5rem)] flex-col space-y-4 pb-6"},xe={class:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3"},fe={class:"mb-1 flex items-center justify-between"},pe={class:"flex flex-col gap-2"},ye={class:"flex items-center font-medium"},ge={class:"mb-1 flex items-center gap-1 text-gray-400"},ve={class:"flex flex-col items-center justify-end gap-1"},be={class:"text-xs text-gray-400"},Se={class:"space-y-1"},we={class:"flex items-center justify-between"},Ce={class:"text-xs text-gray-400"},ke={class:"text-lg font-bold"},De={class:"flex items-center justify-between"},Ue={class:"text-xs text-gray-400"},je={class:"text-lg font-bold"},Te={class:"flex items-center justify-between"},ze={class:"text-xs text-gray-400"},Ne={class:"text-lg font-bold"},Le={class:"mb-1 flex items-center justify-between"},Me={class:"flex flex-col gap-2"},Re={class:"font -medium flex items-center"},Ve={class:"mb-1 flex items-center gap-1 text-gray-400"},Ae={class:"flex flex-col items-center justify-end gap-1"},$e={class:"text-xs text-gray-400"},Be={class:"space-y-1"},Fe={class:"flex items-center justify-between"},Ie={class:"text-xs text-gray-400"},Ge={class:"text-lg font-bold"},Oe={class:"flex items-center justify-between"},Ee={class:"text-xs text-gray-400"},Pe={class:"text-lg font-bold"},We={class:"flex items-center justify-between"},qe={class:"text-xs text-gray-400"},He={class:"text-lg font-bold"},Je={class:"mb-1 flex items-center justify-between"},Ke={class:"flex flex-col gap-2"},Qe={class:"font -medium flex items-center"},Xe={class:"mb-1 flex items-center gap-1 text-gray-400"},Ye={class:"flex flex-col items-center justify-end gap-1"},Ze={class:"text-xs text-gray-400"},et={class:"space-y-1"},tt={class:"flex items-center justify-between"},st={class:"text-xs text-gray-400"},at={class:"text-lg font-bold"},ot={class:"flex items-center justify-between"},lt={class:"text-xs text-gray-400"},rt={class:"text-lg font-bold"},nt={class:"flex items-center justify-between"},it={class:"text-xs text-gray-400"},dt={class:"text-lg font-bold"},ct={class:"grid grid-cols-1 gap-4 pb-6 lg:grid-cols-3"},ht={class:"space-y-4 lg:col-span-2"},ut={class:"mb-1 flex items-center justify-between"},mt={class:"text-lg font-medium"},_t={class:"mb-1 flex items-center gap-1 text-gray-400"},xt={class:"flex items-center gap-1 text-xs"},ft={class:"h-80"},pt={class:"mb-1 flex items-center justify-between"},yt={class:"text-lg font-medium"},gt={class:"mb-1 flex items-center gap-1 text-gray-400"},vt={class:"flex items-center gap-1 text-xs"},bt={class:"h-80"},St={class:"flex flex-col gap-4"},wt={class:"flex items-center justify-between"},Ct={class:"text-lg font-medium"},kt={class:"h-full min-h-0 flex-1"},Dt={key:0,class:"space-y-2"},Ut={class:"flex items-center gap-2"},jt={class:"text-xs text-gray-400"},Tt=["src","alt"],zt={class:"text-sm font-medium"},Nt={class:"text-xs text-gray-400"},Lt={class:"text-right"},Mt={class:"text-sm font-medium"},Rt={class:"text-xs text-gray-400"},Vt={key:0,class:"py-8 text-center text-gray-400"},At={key:1,class:"space-y-2"},$t={class:"flex items-center gap-2"},Bt={class:"text-xs text-gray-400"},Ft=["src","alt"],It={class:"text-sm font-medium"},Gt={class:"text-xs text-gray-400"},Ot={class:"text-right"},Et={class:"text-sm font-medium"},Pt={class:"text-xs text-gray-400"},Wt={key:0,class:"py-8 text-center text-gray-400"},qt={class:"flex items-center justify-between"},Ht={class:"text-lg font-medium"},Jt={class:"h-full min-h-0 flex-1"},Kt={class:"space-y-2"},Qt={class:"mb-2 flex items-center justify-between px-2 text-sm"},Xt={class:"text-gray-400"},Yt={class:"text-gray-400"},Zt={class:"flex items-center gap-2"},es={class:"text-xs text-gray-400"},ts={class:"text-sm font-medium"},ss={class:"text-right"},as={class:"text-sm font-medium"},os={class:"text-xs text-gray-400"},ls={key:0,class:"py-8 text-center text-gray-400"},Ns=X({__name:"dashboard",setup(A){const W=Y(),$=Z(),q=ee(),{t:a}=te(),m=b(()=>ue(W.ui.colors.primary,500)),_=b(()=>"#ffb433"),o=se(null),v=D(null),B=async()=>{try{const c=await me({userDays:S.value,revenueDays:w.value,tokenDays:F.value});o.value=c,v.value=new Date}catch(c){console.error(a("dashboard.errors.fetchFailed"),c),q.error(a("dashboard.errors.fetchFailedMessage"))}},S=D(15),w=D(15),F=D(15),U=D("model");ae(()=>{B()}),oe([S,w,F],()=>{B()});const I=b(()=>[{label:a("dashboard.timeRange.last7Days"),value:7},{label:a("dashboard.timeRange.last15Days"),value:15},{label:a("dashboard.timeRange.last30Days"),value:30}]),G=c=>{const l=new Date;l.setHours(0,0,0,0);const i=new Date(l);return i.setDate(i.getDate()-(c-1)),{startDate:i,endDate:l}},O=b(()=>G(S.value)),E=b(()=>G(w.value)),d=c=>{const l=Number(c);return Number.isFinite(l)?l:0},z=(c,l)=>{const i=d(c),f=d(l);if(f===0)return 0;const p=i/(1+f/100),j=i-p;return d(j)},H=b(()=>{const c=o.value?.userDetail?.chartData||[];return{tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:[a("dashboard.chart.visit"),a("dashboard.chart.register")]},grid:{top:10,left:18,right:18,bottom:10,containLabel:!0},xAxis:[{type:"category",data:c.map(l=>{const i=new Date(l.date);return`${i.getMonth()+1}-${i.getDate()}`}),boundaryGap:!1,axisLine:{lineStyle:{color:"#999"}},axisLabel:{interval:3,align:"center",formatter:function(l){return l},boundaryGap:!1}}],yAxis:[{type:"value",splitNumber:4,splitLine:{lineStyle:{color:$.value==="dark"?"#1e1e1e":"#f7f7f7"}},axisLine:{show:!1},axisLabel:{show:!1},splitArea:{show:!1}}],series:[{name:a("dashboard.chart.visit"),type:"line",data:c.map(l=>l.visit),emphasis:{itemStyle:{color:m.value},lineStyle:{color:m.value},areaStyle:{color:m.value}},lineStyle:{width:4,color:{type:"linear",colorStops:[{offset:0,color:m.value},{offset:1,color:m.value}],globalCoord:!0}},symbol:"circle",symbolSize:8,itemStyle:{color:m.value,borderWidth:2,borderColor:"#fff"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:m.value},{offset:1,color:m.value}]},opacity:.1},smooth:!0},{name:a("dashboard.chart.register"),type:"line",data:c.map(l=>l.register),emphasis:{itemStyle:{color:_.value},lineStyle:{color:_.value},areaStyle:{color:_.value}},lineStyle:{width:4,color:_.value},symbol:"circle",symbolSize:8,itemStyle:{color:_.value,borderWidth:2,borderColor:"#fff"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:_.value},{offset:1,color:_.value}]},opacity:.1},smooth:!0}]}}),J=b(()=>{const c=o.value?.revenueDetail?.chartData||[];return{tooltip:{trigger:"axis",axisPointer:{type:"cross"}},legend:{data:[a("dashboard.chart.revenue"),a("dashboard.chart.order")]},grid:{top:10,left:18,right:18,bottom:10,containLabel:!0},xAxis:[{type:"category",data:c.map(l=>{const i=new Date(l.date);return`${i.getMonth()+1}-${i.getDate()}`}),boundaryGap:!1,axisLine:{lineStyle:{color:"#999"}},axisLabel:{interval:3,align:"center",formatter:function(l){return l},boundaryGap:!1}}],yAxis:[{type:"value",name:a("dashboard.chart.revenue"),position:"left",splitNumber:4,splitLine:{lineStyle:{color:$.value==="dark"?"#1e1e1e":"#f7f7f7"}},axisLine:{show:!1},axisLabel:{show:!1},splitArea:{show:!1}},{type:"value",name:a("dashboard.chart.order"),position:"right",splitNumber:4,splitLine:{show:!1},axisLine:{show:!1},axisLabel:{show:!1},splitArea:{show:!1}}],series:[{name:a("dashboard.chart.revenue"),type:"line",yAxisIndex:0,data:c.map(l=>l.revenue),emphasis:{itemStyle:{color:m.value},lineStyle:{color:m.value},areaStyle:{color:m.value}},lineStyle:{width:4,color:{type:"linear",colorStops:[{offset:0,color:m.value},{offset:1,color:m.value}],globalCoord:!0}},symbol:"circle",symbolSize:8,itemStyle:{color:m.value,borderWidth:2,borderColor:"#fff"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:m.value},{offset:1,color:m.value}]},opacity:.1},smooth:!0},{name:a("dashboard.chart.order"),type:"line",yAxisIndex:1,data:c.map(l=>l.orders),emphasis:{itemStyle:{color:_.value},lineStyle:{color:_.value},areaStyle:{color:_.value}},lineStyle:{width:4,color:_.value},symbol:"circle",symbolSize:8,itemStyle:{color:_.value,borderWidth:2,borderColor:"#fff"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:_.value},{offset:1,color:_.value}]},opacity:.1},smooth:!0}]}});return(c,l)=>{const i=le,f=re,p=ne,j=ie,P=de,K=ce,N=he;return h(),T(N,{shadow:!1,class:"h-[calc(100svh-5rem)]"},{default:u(()=>[e("div",_e,[e("div",xe,[n(p,null,{header:u(()=>[e("div",fe,[e("div",pe,[e("div",ye,s(t(a)("dashboard.userStats.title")),1),e("div",ge,[n(i,{name:"i-lucide-info",class:"size-3"}),t(v)?(h(),T(f,{key:0,datetime:t(v),mode:"datetime",class:"text-xs"},null,8,["datetime"])):y("",!0)])]),e("div",ve,[n(i,{name:d(t(o)?.user.userChange)>=0?"i-lucide-trending-up":"i-lucide-trending-down",class:C(d(t(o)?.user.userChange)>=0?"text-primary size-7":"size-7 text-red-500")},null,8,["name","class"]),e("span",be,[g(s(d(t(o)?.user.userChange)>=0?t(a)("dashboard.userStats.increase"):t(a)("dashboard.userStats.decrease"))+" ",1),e("span",{class:C([d(t(o)?.user.userChange)>=0?"text-primary":"text-red-500","text-base font-medium"])},s(Math.round(Math.abs(z(t(o)?.user.newUsersToday??0,d(t(o)?.user.userChange))))),3),g(" "+s(t(a)("dashboard.userStats.unit")),1)])])])]),default:u(()=>[e("div",Se,[e("div",we,[e("span",Ce,s(t(a)("dashboard.userStats.todayNew")),1),e("span",ke,s(t(o)?.user.newUsersToday||0),1)]),e("div",De,[e("span",Ue,s(t(a)("dashboard.userStats.activeUsers")),1),e("span",je,s(t(o)?.user.activeUsers||0),1)]),e("div",Te,[e("span",ze,s(t(a)("dashboard.userStats.totalUsers")),1),e("span",Ne,s(t(o)?.user.totalUsers||0),1)])])]),_:1}),n(p,null,{header:u(()=>[e("div",Le,[e("div",Me,[e("div",Re,s(t(a)("dashboard.orderStats.title")),1),e("div",Ve,[n(i,{name:"i-lucide-info",class:"size-3"}),t(v)?(h(),T(f,{key:0,datetime:t(v),mode:"datetime",class:"text-xs"},null,8,["datetime"])):y("",!0)])]),e("div",Ae,[n(i,{name:d(t(o)?.order.orderChange)>=0?"i-lucide-trending-up":"i-lucide-trending-down",class:C(d(t(o)?.order.orderChange)>=0?"text-primary size-7":"size-7 text-red-500")},null,8,["name","class"]),e("span",$e,[g(s(d(t(o)?.order.orderChange)>=0?t(a)("dashboard.orderStats.increase"):t(a)("dashboard.orderStats.decrease"))+" ",1),e("span",{class:C([d(t(o)?.order.orderChange)>=0?"text-primary":"text-red-500","text-base font-medium"])},s(Math.round(Math.abs(z(t(o)?.order.ordersToday??0,d(t(o)?.order.orderChange))))),3),g(" "+s(t(a)("dashboard.orderStats.unit")),1)])])])]),default:u(()=>[e("div",Be,[e("div",Fe,[e("span",Ie,s(t(a)("dashboard.orderStats.todayOrders")),1),e("span",Ge,s(t(o)?.order.ordersToday||0),1)]),e("div",Oe,[e("span",Ee,s(t(a)("dashboard.orderStats.totalOrders")),1),e("span",Pe,s(t(o)?.order.totalOrders||0),1)]),e("div",We,[e("span",qe,s(t(a)("dashboard.orderStats.totalAmount")),1),e("span",He,s(t(o)?.order.totalAmount||0),1)])])]),_:1}),n(p,null,{header:u(()=>[e("div",Je,[e("div",Ke,[e("div",Qe,s(t(a)("dashboard.chatStats.title")),1),e("div",Xe,[n(i,{name:"i-lucide-info",class:"size-3"}),t(v)?(h(),T(f,{key:0,datetime:t(v),mode:"datetime",class:"text-xs"},null,8,["datetime"])):y("",!0)])]),e("div",Ye,[n(i,{name:d(t(o)?.chat.chatChange)>=0?"i-lucide-trending-up":"i-lucide-trending-down",class:C(d(t(o)?.chat.chatChange)>=0?"text-primary size-7":"size-7 text-red-500")},null,8,["name","class"]),e("span",Ze,[g(s(d(t(o)?.chat.chatChange)>=0?t(a)("dashboard.chatStats.increase"):t(a)("dashboard.chatStats.decrease"))+" ",1),e("span",{class:C([d(t(o)?.chat.chatChange)>=0?"text-primary":"text-red-500","text-base font-medium"])},s(Math.round(Math.abs(z(t(o)?.chat.conversationsToday??0,d(t(o)?.chat.chatChange))))),3),g(" "+s(t(a)("dashboard.chatStats.unit")),1)])])])]),default:u(()=>[e("div",et,[e("div",tt,[e("span",st,s(t(a)("dashboard.chatStats.todayConversations")),1),e("span",at,s(t(o)?.chat.conversationsToday||0),1)]),e("div",ot,[e("span",lt,s(t(a)("dashboard.chatStats.totalConversations")),1),e("span",rt,s(t(o)?.chat.totalConversations||0),1)]),e("div",nt,[e("span",it,s(t(a)("dashboard.chatStats.totalTokens")),1),e("span",dt,s(t(V)(t(o)?.chat.totalTokens||0)),1)])])]),_:1})]),e("div",ct,[e("div",ht,[n(p,null,{header:u(()=>[e("div",ut,[e("h3",mt,s(t(a)("dashboard.chartTitles.userTrend")),1),n(j,{modelValue:t(S),"onUpdate:modelValue":l[0]||(l[0]=r=>L(S)?S.value=r:null),items:t(I)},null,8,["modelValue","items"])]),e("div",_t,[n(i,{name:"i-lucide-info",class:"size-3"}),e("span",xt,[n(f,{datetime:t(O).startDate,mode:"date",class:"text-xs"},null,8,["datetime"]),l[3]||(l[3]=g(" - ",-1)),n(f,{datetime:t(O).endDate,mode:"date",class:"text-xs"},null,8,["datetime"])])])]),default:u(()=>[e("div",ft,[n(P,{options:t(H),height:"100%"},null,8,["options"])])]),_:1}),n(p,null,{header:u(()=>[e("div",pt,[e("h3",yt,s(t(a)("dashboard.chartTitles.revenueTrend")),1),n(j,{modelValue:t(w),"onUpdate:modelValue":l[1]||(l[1]=r=>L(w)?w.value=r:null),items:t(I)},null,8,["modelValue","items"])]),e("div",gt,[n(i,{name:"i-lucide-info",class:"size-3"}),e("span",vt,[n(f,{datetime:t(E).startDate,mode:"date",class:"text-xs"},null,8,["datetime"]),l[4]||(l[4]=g(" - ",-1)),n(f,{datetime:t(E).endDate,mode:"date",class:"text-xs"},null,8,["datetime"])])])]),default:u(()=>[e("div",bt,[n(P,{options:t(J),height:"100%"},null,8,["options"])])]),_:1})]),e("div",St,[n(p,{class:"flex flex-1 flex-col overflow-hidden",ui:{body:"h-full"}},{header:u(()=>[e("div",wt,[e("h3",Ct,s(t(a)("dashboard.ranking.tokenUsage")),1),n(K,{modelValue:t(U),"onUpdate:modelValue":l[2]||(l[2]=r=>L(U)?U.value=r:null),items:[{label:t(a)("dashboard.ranking.model"),value:"model"},{label:t(a)("dashboard.ranking.provider"),value:"provider"}],size:"sm"},null,8,["modelValue","items"])])]),default:u(()=>[e("div",kt,[n(N,{class:"h-full"},{default:u(()=>[t(U)==="model"?(h(),x("div",Dt,[(h(!0),x(M,null,R(t(o)?.tokenUsage?.byModel.slice(0,10),(r,k)=>(h(),x("div",{key:r.modelId,class:"hover:bg-muted flex items-center justify-between rounded-lg px-1 py-2"},[e("div",Ut,[e("span",jt,"#"+s(k+1),1),r.iconUrl?(h(),x("img",{key:0,src:r.iconUrl,alt:r.providerName,class:"size-8 rounded"},null,8,Tt)):y("",!0),e("div",null,[e("div",zt,s(r.modelName),1),e("div",Nt,s(r.providerName),1)])]),e("div",Lt,[e("div",Mt,s(t(V)(r.tokens)),1),e("div",Rt,s(r.conversations)+" "+s(t(a)("dashboard.ranking.conversations")),1)])]))),128)),!t(o)?.tokenUsage?.byModel||t(o).tokenUsage.byModel.length===0?(h(),x("div",Vt,s(t(a)("dashboard.ranking.noData")),1)):y("",!0)])):(h(),x("div",At,[(h(!0),x(M,null,R(t(o)?.tokenUsage?.byProvider.slice(0,10),(r,k)=>(h(),x("div",{key:r.providerId,class:"hover:bg-muted flex items-center justify-between rounded-lg px-1 py-2"},[e("div",$t,[e("span",Bt,"#"+s(k+1),1),r.iconUrl?(h(),x("img",{key:0,src:r.iconUrl,alt:r.providerName,class:"size-8 rounded"},null,8,Ft)):y("",!0),e("div",null,[e("div",It,s(r.providerName),1),e("div",Gt,s(r.provider),1)])]),e("div",Ot,[e("div",Et,s(t(V)(r.tokens)),1),e("div",Pt,s(r.conversations)+" "+s(t(a)("dashboard.ranking.conversations")),1)])]))),128)),!t(o)?.tokenUsage?.byProvider||t(o).tokenUsage.byProvider.length===0?(h(),x("div",Wt,s(t(a)("dashboard.ranking.noData")),1)):y("",!0)]))]),_:1})])]),_:1}),n(p,{class:"flex flex-1 flex-col overflow-hidden",ui:{body:"h-full"}},{header:u(()=>[e("div",qt,[e("h3",Ht,s(t(a)("dashboard.ranking.extensionUsage")),1)])]),default:u(()=>[e("div",Jt,[n(N,{class:"h-full"},{default:u(()=>[e("div",Kt,[e("div",Qt,[e("span",Xt,s(t(a)("dashboard.ranking.totalExtensions"))+s(t(o)?.extension?.totalCount||0),1),e("span",Yt,s(t(a)("dashboard.ranking.enabledExtensions"))+s(t(o)?.extension?.enabledCount||0),1)]),(h(!0),x(M,null,R(t(o)?.extension?.usageRanking,(r,k)=>(h(),x("div",{key:r.extensionId,class:"flex items-center justify-between rounded-lg p-2 hover:bg-gray-100 dark:hover:bg-gray-800"},[e("div",Zt,[e("span",es,"#"+s(k+1),1),e("div",ts,s(r.extensionName),1)]),e("div",ss,[e("div",as,s(r.usageCount),1),e("div",os,s(t(a)("dashboard.ranking.usageCount")),1)])]))),128)),!t(o)?.extension?.usageRanking||t(o).extension.usageRanking.length===0?(h(),x("div",ls,s(t(a)("dashboard.ranking.noData")),1)):y("",!0)])]),_:1})])]),_:1})])])])]),_:1})}}});export{Ns as default};
